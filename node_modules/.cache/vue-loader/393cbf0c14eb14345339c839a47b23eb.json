{"remainingRequest":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\work\\竞猜可换色板\\src\\views\\club\\MemberManagement.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\work\\竞猜可换色板\\src\\views\\club\\MemberManagement.vue","mtime":1599553660513},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport back from \"@/components/Botton/back.vue\";\r\nimport model from \"@/components/model\";\r\nimport { apiGetMyClubManagement, apiAuditClubMem, apiGetClubRole, apiModifyClubRole } from \"@/api/Club.js\";\r\nexport default {\r\n  name: \"memberManagement\",\r\n  components: {\r\n    back,\r\n    model,\r\n  },\r\n  data() {\r\n    return {\r\n      totalMembers: 0,\r\n      yesterdayAdd: 0,\r\n      btnChoice: 0,\r\n      closedIndex: undefined,\r\n      isOpen: false,\r\n      clubId: undefined,\r\n      UName: \"\",\r\n      underReviewNum: undefined,\r\n      type: 0,\r\n      memberList: [],\r\n      unMemberList: [],\r\n      pkId: undefined,\r\n      callBackMsg: \"\",\r\n      clubRoleList: [],\r\n      clubRole: \"\",\r\n      isOpenChat: false,\r\n    };\r\n  },\r\n  created() {\r\n    // 獲取clubId\r\n    this.clubId = localStorage.getItem(\"ClubId\");\r\n\r\n    // 獲取成員管理數據\r\n    this.getMyClubManagement();\r\n  },\r\n  methods: {\r\n    allMember() {\r\n      this.btnChoice = 0;\r\n      this.getMyClubManagement();\r\n    },\r\n    underReview() {\r\n      this.btnChoice = 1;\r\n      this.getMyClubManagement();\r\n    },\r\n\r\n    // 開啟彈窗\r\n    openFancyBox(type) {\r\n      this.isOpen = true;\r\n      this.type = type;\r\n\r\n      // type = 1 ， 點選會員進階跳出彈窗時，需跑API撈取升級資訊列表\r\n      if (type == 1) {\r\n        apiGetClubRole(\"\", true).then(res => {\r\n          this.clubRoleList = res.Data;\r\n      });\r\n      }\r\n    },\r\n\r\n    // type : 1 = 升級修改會員; 2 = 移除會員; 3 = 通過審核; 4 = 拒絕審核\r\n    async confirmBtnEvent(type) {\r\n      if (type === 1) {\r\n        let data = {\r\n          UName: this.UName,\r\n          RoleId: this.clubRole\r\n        }\r\n        apiModifyClubRole(data, true).then(res => {\r\n          if (res.Data) {\r\n            this.type = 5;\r\n            this.callBackMsg = this.$t(\"SuccessfulOperation\");\r\n          }\r\n      });\r\n      }\r\n      if (type === 2) {\r\n        let data = {\r\n          MemClubChangeId: this.pkId,\r\n          ClubId: this.clubId,\r\n          UName: this.UName,\r\n          Type: 2, // 2 踢人\r\n          Status: 1 // status = 1是同意  2是不同意\r\n        };\r\n        await apiAuditClubMem(data, true)\r\n          .then(res => {\r\n            if (res.Success) {\r\n              this.type = 5;\r\n              this.callBackMsg = this.$t(\"SuccessfulOperation\");\r\n            } else {\r\n              this.type = 5;\r\n              this.callBackMsg = res.Message;\r\n            }\r\n          })\r\n          .then(() => {\r\n            this.getMyClubManagement();\r\n          });\r\n      }\r\n      if (type === 3) {\r\n        let data = {\r\n          MemClubChangeId: this.pkId,\r\n          ClubId: this.clubId,\r\n          UName: this.UName,\r\n          Type: 0, // 0 審核\r\n          Status: 1 // status = 1是同意  2是不同意\r\n        };\r\n        await apiAuditClubMem(data, true)\r\n          .then(res => {\r\n            if (res.Success) {\r\n              this.type = 5;\r\n              this.callBackMsg = this.$t(\"SuccessfulOperation\");\r\n            } else {\r\n              this.type = 5;\r\n              this.callBackMsg = res.Message;\r\n            }\r\n          })\r\n          .then(() => {\r\n            this.getMyClubManagement();\r\n          });\r\n      }\r\n      if (type === 4) {\r\n          let data = {\r\n          MemClubChangeId: this.pkId,\r\n          ClubId: this.clubId,\r\n          UName: this.UName,\r\n          Type: 0, // 0 審核\r\n          Status: 2 // status = 1是同意  2是不同意\r\n        };\r\n        await apiAuditClubMem(data, true)\r\n          .then(res => {\r\n            if (res.Success) {\r\n              this.type = 5;\r\n              this.callBackMsg = this.$t(\"SuccessfulOperation\");\r\n            } else {\r\n              this.type = 5;\r\n              this.callBackMsg = res.Message;\r\n            }\r\n          })\r\n          .then(() => {\r\n            this.getMyClubManagement();\r\n          });\r\n      }\r\n      // 回傳訊息\r\n      if (type === 5) {\r\n        this.isOpen = false;\r\n      }\r\n\r\n      // 無會員錯誤訊息\r\n      if (type === 6) {\r\n        this.$router.push(\"/CreateClub\");\r\n      }\r\n    },\r\n\r\n    // 獲取成員管理數據\r\n    getMyClubManagement() {\r\n      let data = {\r\n        ClubId: this.clubId\r\n      };\r\n      apiGetMyClubManagement(data, true).then(res => {\r\n        // 無會員時跳出彈窗錯誤訊息\r\n        if(res.Code) {\r\n          this.isOpen = true;\r\n          this.type = 6;\r\n          this.callBackMsg = res.Message;\r\n          return;\r\n        }\r\n        this.memberList = res.Data.Members;\r\n        this.unMemberList = res.Data.UnMembers;\r\n        this.totalMembers = res.Data.PeoNum;\r\n        this.yesterdayAdd = res.Data.YesterdayPeoNum;\r\n\r\n        this.underReviewNum = this.unMemberList.length;\r\n      })\r\n    },\r\n\r\n    // 發送訊息\r\n    openChat() {\r\n      this.isOpenChat = true\r\n    }\r\n  }\r\n};\r\n",{"version":3,"sources":["MemberManagement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"MemberManagement.vue","sourceRoot":"src/views/club","sourcesContent":["<template>\r\n  <div class=\"member-management\">\r\n    <div class=\"member-management-header\">\r\n      <div class=\"member-management-header-wrap\">\r\n        <back class=\"back-icon img-he\"></back>\r\n        <h3>{{ $t(\"MemberManagement\") }}</h3>\r\n        <!--成员管理-->\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"member-info\">\r\n      <div class=\"totalMembers\">\r\n        {{ $t(\"TotalNumberOfClubs\") }}:{{ totalMembers }}\r\n      </div>\r\n      <!--俱乐部总人数-->\r\n      <div class=\"yesterdayAdd\">\r\n        {{ $t(\"ClubAddedYesterday\") }}:{{ yesterdayAdd }}\r\n      </div>\r\n      <!--俱乐部昨日新增-->\r\n    </div>\r\n\r\n    <div class=\"member-management-content\">\r\n      <div class=\"managementBtn\">\r\n        <!--所有成员-->\r\n        <div\r\n          :class=\"[btnChoice == 0 ? 'onFocus' : 'notFocus']\"\r\n          @click=\"allMember()\"\r\n        >\r\n          {{ $t(\"AllMembers\") }}\r\n        </div>\r\n\r\n        <!--待审核-->\r\n        <div\r\n          class=\"under-review\"\r\n          :class=\"[btnChoice == 1 ? 'onFocus' : 'notFocus']\"\r\n          @click=\"underReview()\"\r\n        >\r\n          {{ $t(\"UnderReview\") }}\r\n          <span v-if=\"underReviewNum > 0\">{{ underReviewNum }}</span>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 所有成员 -->\r\n      <div class=\"member-list-wrap\" v-if=\"btnChoice === 0\">\r\n        <div class=\"member-list\" v-for=\"(list, index) in memberList\">\r\n          <img :src=\"list.UImg\" alt=\"\" />\r\n          <div class=\"member-list-info\">\r\n            <p class=\"member-list-info-name\">{{ list.UName }}</p>\r\n            <!--发送消息-->\r\n            <div class=\"member-list-send-message\" @click=\"openChat()\">{{ $t(\"SendMessage\") }}</div>\r\n          </div>\r\n          <div class=\"member-list-btn-wrap\">\r\n            <div class=\"drop\" @click=\"openFancyBox(1); UName = list.UName;\"></div>\r\n            <!-- 踢人 -->\r\n            <div class=\"closed\" @click=\"openFancyBox(2); pkId = list.PkId; UName = list.UName;\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 待审核 -->\r\n      <div class=\"member-list-wrap\" v-if=\"btnChoice === 1\">\r\n        <div class=\"member-list\" v-for=\"list in unMemberList\">\r\n          <img :src=\"list.UImg\" alt=\"\" />\r\n          <div class=\"member-list-info\">\r\n            <p class=\"member-list-info-name\">{{ list.UName }}</p>\r\n            <div class=\"member-list-info-detail\">\r\n              <p>\r\n                {{ $t(\"NumberOfBets\") }}: {{ list.BetCount }}{{ $t(\"Times\") }}\r\n              </p>\r\n              <!--投注数-->\r\n              <p>{{ $t(\"VIPLevel\") }}: {{ list.Vip }}</p>\r\n              <!--VIP等级-->\r\n            </div>\r\n          </div>\r\n          <div class=\"member-list-btn-wrap\">\r\n            <!--通过-->\r\n            <div class=\"member-list-btn pass\" @click=\" openFancyBox(3); pkId = list.PkId; UName = list.UName;\">\r\n              {{ $t(\"Pass\") }}\r\n            </div>\r\n            <!--拒绝-->\r\n            <div class=\"member-list-btn reject\" @click=\"openFancyBox(4); pkId = list.PkId; UName = list.UName;\">\r\n              {{ $t(\"Reject\") }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 發送訊息 -->\r\n    <div class=\"chat\" v-if=\"isOpenChat\">\r\n      \r\n    </div>\r\n\r\n    <!-- 彈窗 -->\r\n    <transition name=\"fade\">\r\n      <model v-if=\"isOpen\"></model>\r\n    </transition>\r\n    <transition name=\"fade\">\r\n      <div class=\"fancyBox\" v-if=\"isOpen\">\r\n        <!--是否將此會員升級-->\r\n        <div class=\"upgrade\" v-if=\"type == 1\">\r\n          <p>调整角色</p>\r\n          <!-- <select v-model=\"clubRole\">\r\n            <option value=\"\" disabled selected>--請選擇--</option>\r\n            <option class=\"upgrade-option\" v-for=\"role in clubRoleList\" :value=\"role.Id\">{{ role.Name }}</option>\r\n          </select> -->\r\n          <el-select v-model=\"clubRole\" placeholder=\"请选择\">\r\n            <el-option\r\n              v-for=\"item in clubRoleList\"\r\n              :key=\"item.value\"\r\n              :label=\"item.Name\"\r\n              :value=\"item.Id\">\r\n            </el-option>\r\n          </el-select>\r\n        </div>\r\n        <span v-if=\"type == 2\">{{ $t(\"RemoveMember\") }}?</span><!--是否將此會員汰除-->\r\n        <span v-if=\"type == 3\">{{ $t(\"JoinMember\") }}?</span><!--是否加入此會員-->\r\n        <span v-if=\"type == 4\">{{ $t(\"RejectMember\") }}?</span><!--是否拒絕此會員-->\r\n        <span v-if=\"type == 5\">{{ callBackMsg }}</span><!--錯誤訊息-->\r\n        <span v-if=\"type == 6\">{{ callBackMsg }}</span><!--無會員訊息-->\r\n        <div class=\"fancy-box-btn-wrap\">\r\n          <p\r\n            class=\"commit cancelBtn\"\r\n            @click=\"isOpen = !isOpen\"\r\n            v-if=\"type !== 5 && type !== 6\"\r\n          >\r\n            {{ $t(\"Cancel\") }}\r\n          </p>\r\n          <div class=\"commit confirmBtn\" @click=\"confirmBtnEvent(type)\">\r\n            {{ $t(\"Confirm\") }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </transition>\r\n  </div>\r\n</template>\r\n<script>\r\nimport back from \"@/components/Botton/back.vue\";\r\nimport model from \"@/components/model\";\r\nimport { apiGetMyClubManagement, apiAuditClubMem, apiGetClubRole, apiModifyClubRole } from \"@/api/Club.js\";\r\nexport default {\r\n  name: \"memberManagement\",\r\n  components: {\r\n    back,\r\n    model,\r\n  },\r\n  data() {\r\n    return {\r\n      totalMembers: 0,\r\n      yesterdayAdd: 0,\r\n      btnChoice: 0,\r\n      closedIndex: undefined,\r\n      isOpen: false,\r\n      clubId: undefined,\r\n      UName: \"\",\r\n      underReviewNum: undefined,\r\n      type: 0,\r\n      memberList: [],\r\n      unMemberList: [],\r\n      pkId: undefined,\r\n      callBackMsg: \"\",\r\n      clubRoleList: [],\r\n      clubRole: \"\",\r\n      isOpenChat: false,\r\n    };\r\n  },\r\n  created() {\r\n    // 獲取clubId\r\n    this.clubId = localStorage.getItem(\"ClubId\");\r\n\r\n    // 獲取成員管理數據\r\n    this.getMyClubManagement();\r\n  },\r\n  methods: {\r\n    allMember() {\r\n      this.btnChoice = 0;\r\n      this.getMyClubManagement();\r\n    },\r\n    underReview() {\r\n      this.btnChoice = 1;\r\n      this.getMyClubManagement();\r\n    },\r\n\r\n    // 開啟彈窗\r\n    openFancyBox(type) {\r\n      this.isOpen = true;\r\n      this.type = type;\r\n\r\n      // type = 1 ， 點選會員進階跳出彈窗時，需跑API撈取升級資訊列表\r\n      if (type == 1) {\r\n        apiGetClubRole(\"\", true).then(res => {\r\n          this.clubRoleList = res.Data;\r\n      });\r\n      }\r\n    },\r\n\r\n    // type : 1 = 升級修改會員; 2 = 移除會員; 3 = 通過審核; 4 = 拒絕審核\r\n    async confirmBtnEvent(type) {\r\n      if (type === 1) {\r\n        let data = {\r\n          UName: this.UName,\r\n          RoleId: this.clubRole\r\n        }\r\n        apiModifyClubRole(data, true).then(res => {\r\n          if (res.Data) {\r\n            this.type = 5;\r\n            this.callBackMsg = this.$t(\"SuccessfulOperation\");\r\n          }\r\n      });\r\n      }\r\n      if (type === 2) {\r\n        let data = {\r\n          MemClubChangeId: this.pkId,\r\n          ClubId: this.clubId,\r\n          UName: this.UName,\r\n          Type: 2, // 2 踢人\r\n          Status: 1 // status = 1是同意  2是不同意\r\n        };\r\n        await apiAuditClubMem(data, true)\r\n          .then(res => {\r\n            if (res.Success) {\r\n              this.type = 5;\r\n              this.callBackMsg = this.$t(\"SuccessfulOperation\");\r\n            } else {\r\n              this.type = 5;\r\n              this.callBackMsg = res.Message;\r\n            }\r\n          })\r\n          .then(() => {\r\n            this.getMyClubManagement();\r\n          });\r\n      }\r\n      if (type === 3) {\r\n        let data = {\r\n          MemClubChangeId: this.pkId,\r\n          ClubId: this.clubId,\r\n          UName: this.UName,\r\n          Type: 0, // 0 審核\r\n          Status: 1 // status = 1是同意  2是不同意\r\n        };\r\n        await apiAuditClubMem(data, true)\r\n          .then(res => {\r\n            if (res.Success) {\r\n              this.type = 5;\r\n              this.callBackMsg = this.$t(\"SuccessfulOperation\");\r\n            } else {\r\n              this.type = 5;\r\n              this.callBackMsg = res.Message;\r\n            }\r\n          })\r\n          .then(() => {\r\n            this.getMyClubManagement();\r\n          });\r\n      }\r\n      if (type === 4) {\r\n          let data = {\r\n          MemClubChangeId: this.pkId,\r\n          ClubId: this.clubId,\r\n          UName: this.UName,\r\n          Type: 0, // 0 審核\r\n          Status: 2 // status = 1是同意  2是不同意\r\n        };\r\n        await apiAuditClubMem(data, true)\r\n          .then(res => {\r\n            if (res.Success) {\r\n              this.type = 5;\r\n              this.callBackMsg = this.$t(\"SuccessfulOperation\");\r\n            } else {\r\n              this.type = 5;\r\n              this.callBackMsg = res.Message;\r\n            }\r\n          })\r\n          .then(() => {\r\n            this.getMyClubManagement();\r\n          });\r\n      }\r\n      // 回傳訊息\r\n      if (type === 5) {\r\n        this.isOpen = false;\r\n      }\r\n\r\n      // 無會員錯誤訊息\r\n      if (type === 6) {\r\n        this.$router.push(\"/CreateClub\");\r\n      }\r\n    },\r\n\r\n    // 獲取成員管理數據\r\n    getMyClubManagement() {\r\n      let data = {\r\n        ClubId: this.clubId\r\n      };\r\n      apiGetMyClubManagement(data, true).then(res => {\r\n        // 無會員時跳出彈窗錯誤訊息\r\n        if(res.Code) {\r\n          this.isOpen = true;\r\n          this.type = 6;\r\n          this.callBackMsg = res.Message;\r\n          return;\r\n        }\r\n        this.memberList = res.Data.Members;\r\n        this.unMemberList = res.Data.UnMembers;\r\n        this.totalMembers = res.Data.PeoNum;\r\n        this.yesterdayAdd = res.Data.YesterdayPeoNum;\r\n\r\n        this.underReviewNum = this.unMemberList.length;\r\n      })\r\n    },\r\n\r\n    // 發送訊息\r\n    openChat() {\r\n      this.isOpenChat = true\r\n    }\r\n  }\r\n};\r\n</script>\r\n"]}]}