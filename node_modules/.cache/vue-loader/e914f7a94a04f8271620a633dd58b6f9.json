{"remainingRequest":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\work\\竞猜可换色板\\src\\views\\club\\MyClub.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\work\\竞猜可换色板\\src\\views\\club\\MyClub.vue","mtime":1600942128715},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport back from \"@/components/Botton/back.vue\";\r\nimport { apiGetMyClub, apiGetClubAnnouncement, apiAddOrUpClubAnnouncement } from \"@/api/Club.js\";\r\nimport { apiBuyClubActivityTicket } from \"@/api/ClubActivitys.js\";\r\nimport model from \"@/components/model\";\r\nexport default {\r\n  name: \"myClub\",\r\n  components: {\r\n    back,\r\n    model,\r\n  },\r\n  data() {\r\n    return {\r\n      lang: \"\",\r\n      // 俱乐部信息; 俱乐部活动; 俱乐部公告; 俱樂部列表(首頁)\r\n      category: [\r\n        this.$t(\"ClubInformation\"),\r\n        this.$t(\"ClubActivities\"),\r\n        this.$t(\"ClubNotice\"),\r\n        this.$t(\"ClubList\")\r\n      ],\r\n      categoryIndex: 0,\r\n      growValue: 0,\r\n      growMinValue: 0,\r\n      growMaxValue: 0,\r\n      restCalue: 0,\r\n      tipCssLeft: 190,\r\n      clubId: undefined,\r\n      userName: \"\",\r\n      isOpen: false,\r\n      situationObj: [\r\n        {\r\n          UImg: \"\",\r\n          UName: \"\",\r\n          BetSumNum: 0,\r\n          Contribution: 0\r\n        }\r\n      ],\r\n      promoteCode: \"XDF5454581\",\r\n      type: 0, // 1 = 俱樂部活動訊息(目前沒訊息所以先用彈窗通知), 2 = 無會員時回傳訊息\r\n      callBackMsg: \"\",\r\n      isManagement: 0,\r\n      isRelease: false,\r\n      clubMsgList: [],\r\n      detailIndex: undefined,\r\n      isOpenDetail: true,\r\n      indexNum: 1,\r\n      inputTitle: \"\",\r\n      inputTextarea: \"\",\r\n      releaseStatus: undefined,\r\n      releaseId: undefined,\r\n\r\n      // 俱樂部活動\r\n      newActivitiesObj: {},\r\n      historyActivitiesObj: [],\r\n      isTicketTipOpen: false,\r\n      ticketTipText: \"活动规则：<br />1、胜负的判断：<br />①根据最终比赛结果来判定对应的竞猜胜负<br />②根据本次活动竞猜正确的胜率来判断第一名<br />2、参与规则<br />①参与需缴纳一定金额的门票<br />②购买门票的用户，视作愿意参与活动，门票不予退还<br />3、奖励规则<br />①胜利最高的为第一名，胜率想同的用户并列第一<br />②第一名的用户获得本次活动门票收益,如有多个用户并列第一，则均分本次活动的奖励<br />③奖励的发放在活动结束后的2个工作日内，由系统自动发放奖励<br />活动最终解释权归本APP所有\",\r\n      avtiveId: \"\",\r\n      activeNodata: false,\r\n      matchName: \"\",\r\n      // v-infinite-scroll 套件\r\n      busy: false,\r\n      immediate: false,\r\n      vIndex: 1,\r\n    };\r\n  },\r\n  async created() {\r\n    // 讀取目前語系，有翻譯需要\r\n    this.lang = JSON.parse(localStorage.getItem(\"lang\")).name;\r\n    // 讀取是否為管理階\r\n    this.isManagement = localStorage.getItem(\"isManagement\");\r\n\r\n    this.userName = localStorage.getItem(\"uname\");\r\n    this.clubId = localStorage.getItem(\"ClubId\");\r\n    // 讀取會員資訊\r\n    await this.getMyClub().then(() => {\r\n      if (localStorage.getItem(\"categoryIndex\") == undefined || localStorage.getItem(\"categoryIndex\") == null) {\r\n        this.categoryIndex = 0;\r\n        this.getCategory(0);\r\n      } else {\r\n        this.categoryIndex = localStorage.getItem(\"categoryIndex\")\r\n        this.getCategory(this.categoryIndex);\r\n      }\r\n      // }\r\n    })\r\n  },\r\n  methods: {\r\n    getCategory(index) {\r\n      this.categoryIndex = index;\r\n      localStorage.setItem(\"categoryIndex\", index);\r\n      if (index == 0) {\r\n        this.getMyClub().then(() => {\r\n            this.changeRangeVal();\r\n        });\r\n      }\r\n      // 俱樂部活動\r\n      if (index == 1) {\r\n        // 讀取活動發布頁面聯賽\r\n        // this.getMyClub()\r\n        if (this.newActivitiesObj == null || this.newActivitiesObj.length <= 0) {\r\n          this.newActivitiesObj = [];\r\n          this.activeNodata = true;\r\n        } else if (this.historyActivitiesObj == null || this.historyActivitiesObj.length <= 0) {\r\n          this.historyActivitiesObj = [];\r\n          this.activeNodata = true;\r\n        }\r\n      }\r\n      // 跳轉俱樂部公告\r\n      if (index == 2) {\r\n        this.isRelease = false;\r\n        this.releaseStatus = undefined;\r\n        this.getNoticeList();\r\n      }\r\n      // 跳轉俱樂部列表\r\n      if (index == 3) {\r\n        this.$router.push(\"/CreateClub\");\r\n      }\r\n    },\r\n\r\n    // tooltip跟著拉趕跑\r\n    async changeRangeVal() {\r\n      let tooltip = document.querySelector(\".grow-bar-tooltip\");\r\n      let rangeBtn = document.querySelector(\".el-slider__bar\");\r\n      let tooltipWidth = tooltip.getBoundingClientRect().width; // 提示框最正確的寬度\r\n      let rangeBtnOffset = rangeBtn.offsetWidth; // 拖動拉桿時拉桿條的偏移量\r\n      let tolerance = rangeBtnOffset - tooltipWidth / 2;\r\n      this.tipCssLeft = tolerance;\r\n    },\r\n\r\n    copy() {\r\n      let TextRange = document.createRange();\r\n      TextRange.selectNode(document.getElementById(\"promoteCode\"));\r\n      let sel = window.getSelection();\r\n      sel.removeAllRanges();\r\n      sel.addRange(TextRange);\r\n      document.execCommand(\"copy\");\r\n    },\r\n\r\n    // 獲取會員俱樂部資訊\r\n    async getMyClub() {\r\n      await apiGetMyClub(\"\", true).then(res => {\r\n        if (res.Code) {\r\n          this.type = 2;\r\n          this.isOpen = true;\r\n          this.callBackMsg = res.Message;\r\n        }\r\n        this.growMaxValue = res.Data.NextLvContribution;\r\n        this.growValue = res.Data.Contribution;\r\n        this.situationObj = res.Data.ClubMemLogs;\r\n        \r\n        // 俱樂部活動頁的資料\r\n        this.newActivitiesObj = res.Data.ClubActivityList.LatestClubActivity;\r\n        this.historyActivitiesObj = res.Data.ClubActivityList.ClubActivitys;\r\n      })\r\n    },\r\n\r\n    // 活動開啟發佈頁面\r\n    activesRelease() {\r\n      this.$router.push('/ClubActivitiesRelease');\r\n    },\r\n\r\n    // 購買活動門票\r\n    getTicket() {\r\n      let data = {\r\n        ClubId: this.clubId,\r\n        ClubActivityId: this.avtiveId\r\n      };\r\n      apiBuyClubActivityTicket(data, true).then(res => {\r\n        localStorage.setItem(\"AcvtiveId\", this.avtiveId);\r\n        let vm = this;\r\n        const m = vm.$message({\r\n          message: this.$t('SuccessfulPurchase'),\r\n          duration: 3000,\r\n          type: \"success\",\r\n          center: true\r\n        });\r\n        setTimeout(() => m.close(), 2000);\r\n        setTimeout(() => {\r\n          this.isTicketTipOpen = false;\r\n          this.getMyClub();\r\n        }, 3000);\r\n      });\r\n    },\r\n\r\n    // 繼續下注\r\n    continueBet(avtiveId) {\r\n      localStorage.setItem(\"AcvtiveId\", avtiveId);\r\n      this.$router.push(\"/ClubActivityMatch\");\r\n    },\r\n\r\n    // 參加成功\r\n    goResultDetail(avtiveId){\r\n      localStorage.setItem(\"AcvtiveId\", avtiveId);\r\n      this.$router.push(\"/ActivityMatchResultDetail\");\r\n    },\r\n    // 獲取公告列表\r\n    getNoticeList() {\r\n      let data = {\r\n        ndex: this.indexNum,\r\n        count: 10\r\n      };\r\n      apiGetClubAnnouncement(data, true).then(res => {\r\n        this.clubMsgList = res.Data.Data;\r\n      });\r\n    },\r\n\r\n    // 公告信息下拉\r\n    isDetailOpen(index) {\r\n      if (this.detailIndex == index && this.isOpenDetail == true) {\r\n        this.isOpenDetail = false;\r\n        return;\r\n      }\r\n      this.detailIndex = index;\r\n      this.isOpenDetail = true;\r\n    },\r\n\r\n    // 公告開啟發佈頁面\r\n    openRelease() {\r\n      this.isRelease = true;\r\n      this.inputTitle = \"\";\r\n      this.inputTextarea = \"\";\r\n      this.releaseStatus = 1\r\n    },\r\n\r\n    // 點擊編輯按鈕 開啟發佈頁面編輯\r\n    edit(title, content, id) {\r\n      this.isRelease = true;\r\n      this.inputTitle = title;\r\n      this.inputTextarea = content;\r\n      this.releaseStatus = 2;\r\n      this.releaseId = id;\r\n    },\r\n\r\n    // 新增、編輯公告\r\n    addOrEditNotice(id) {\r\n      if(this.inputTitle == \"\" || this.inputTextarea == \"\") {\r\n        this.type = 4;\r\n        this.isOpen = true;\r\n        this.callBackMsg = this.$t('ValueIsNull');\r\n        return;\r\n      }\r\n      //新增\r\n      if(this.releaseStatus == 1) {\r\n        let data = {\r\n          Title: this.inputTitle,\r\n          Content: this.inputTextarea,\r\n          Status: 1,\r\n        }\r\n        apiAddOrUpClubAnnouncement(data, true).then(res => {\r\n          this.type = 3;\r\n          this.isOpen = true;\r\n          this.callBackMsg = res.Message;\r\n        });\r\n        return;\r\n      }\r\n      // 編輯\r\n      if(this.releaseStatus == 2) {\r\n        let data = {\r\n          Title: this.inputTitle,\r\n          Content: this.inputTextarea,\r\n          Status: 1,\r\n          Id: id\r\n        }\r\n        apiAddOrUpClubAnnouncement(data, true).then(res => {\r\n          this.type = 3;\r\n          this.isOpen = true;\r\n          this.callBackMsg = res.Message;\r\n        });\r\n      }\r\n    },\r\n    // 刪除公告\r\n    del(id) {\r\n      let data = {\r\n        Status: 0,\r\n        Id: id\r\n      }\r\n      apiAddOrUpClubAnnouncement(data, true).then(res => {\r\n        this.type = 3;\r\n        this.isOpen = true;\r\n        this.callBackMsg = res.Message;\r\n      });\r\n    },\r\n    // 彈窗確認按鈕事件\r\n    confirmBtnEvent(type) {\r\n      if (type == 1) {\r\n        this.isOpen = false;\r\n      }\r\n      if (type == 2) {\r\n        this.$router.push(\"/CreateClub\");\r\n      }\r\n      // 公告彈窗事件\r\n      if (type == 3) {\r\n        this.isOpen = false;\r\n        this.getCategory(2);\r\n      }\r\n      \r\n      // 公告為空值時\r\n      if (type == 4) {\r\n        this.isOpen = false;\r\n      }\r\n    },\r\n\r\n    // 無限加載\r\n    load() {\r\n      this.vIndex++; \r\n      this.busy = false;\r\n      let data = {\r\n        index: this.vIndex,\r\n        count: 10\r\n      };\r\n      apiGetClubAnnouncement(data, true).then(res => {\r\n        // this.clubMsgList = res.Data.Data;\r\n        if (res.Data.Data.length == 0) {\r\n          this.busy = true;\r\n        } else if(res.Data.Data.length > 0){\r\n          res.Data.Data.forEach(el => {\r\n            this.clubMsgList.push(el);\r\n            this.busy = false;\r\n          })\r\n        }\r\n      });\r\n    }\r\n  },\r\n  // 前往別頁面時，把分頁index調整為0\r\n  beforeDestroy() {\r\n    if (this.categoryIndex == 3) {\r\n      localStorage.setItem(\"categoryIndex\", 0);\r\n      return;\r\n    }\r\n    localStorage.setItem(\"categoryIndex\", 0);\r\n  },\r\n};\r\n",{"version":3,"sources":["MyClub.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MyClub.vue","sourceRoot":"src/views/club","sourcesContent":["<template>\r\n  <div class=\"myclub\">\r\n    <div class=\"myclub-header\">\r\n      <div class=\"myclub-header-wrap\">\r\n        <back class=\"back-icon img-he\"></back>\r\n        <h3>{{ $t(\"MyClub\") }}</h3>\r\n        <!--我的俱乐部-->\r\n      </div>\r\n      <div class=\"my-authority\" @click=\"$router.push('/myAuthority')\">\r\n        <span>{{ $t(\"MyAuthority\") }}</span\r\n        ><!--我的权限-->\r\n        <img src=\"../../assets/club/arrow.png\" />\r\n      </div>\r\n    </div>\r\n\r\n    <ul class=\"category-wrap\">\r\n      <li class=\"category\" :class=\"{ 'category-active': categoryIndex == index }\" v-for=\"(item, index) in category\" @click=\"getCategory(index)\">\r\n        <div class=\"category-text\">{{ item }}</div>\r\n      </li>\r\n    </ul>\r\n\r\n    <!-- 俱乐部信息 -->\r\n    <div class=\"myclub-content-wrap\" v-show=\"categoryIndex == 0\">\r\n      <div class=\"club-grow\">\r\n        <div class=\"club-grow-text\">\r\n          <div class=\"club-grow-text-title\">{{ $t(\"ClubGrowthValue\") }}</div>\r\n          <!--俱乐部成长值-->\r\n          <div class=\"club-grow-text-tip\" v-if=\"lang == '简体中文'\">\r\n            {{$t(\"ToNextLevel\")}} {{ growMaxValue }}，{{ $t('Go') }}\r\n          </div>\r\n          <div class=\"club-grow-text-tip\" v-else>\r\n            {{ growMaxValue }} {{ $t(\"ToNextLevel\") }}，{{\r\n              $t(\"Go\")\r\n            }}！\r\n          </div>\r\n        </div>\r\n        <div class=\"scale\"></div>\r\n        <div class=\"club-grow-bar\">\r\n          <!-- 進度條 -->\r\n          <div class=\"grow-bar-tooltip\" :style=\"{ left: tipCssLeft + 'px' }\">\r\n            <span class=\"grow-bar-tooltip-text\">{{ growValue }}</span>\r\n          </div>\r\n          <el-slider\r\n            v-show=\"true\"\r\n            v-model=\"growValue\"\r\n            :show-tooltip=\"false\"\r\n            :min=\"growMinValue\"\r\n            :max=\"growMaxValue\"\r\n            disabled=\"disabled\"\r\n          ></el-slider>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"banner\">\r\n        <img src=\"@/assets/club/banner.png\" alt=\"\" />\r\n      </div>\r\n\r\n      <div class=\"block\">\r\n        <div class=\"block-title\">{{ $t(\"MemberDynamics\") }}</div>\r\n        <!--成员动态-->\r\n        <div class=\"block-content\">\r\n          <div class=\"members\" v-for=\"item in situationObj\">\r\n            <img class=\"members-head-shot\" :src=\"item.UImg\" alt=\"\" />\r\n            <div class=\"members-data\">\r\n              <div class=\"members-name\">{{ item.UName }}</div>\r\n              <div class=\"members-bet\">\r\n                <div class=\"bet-times\">\r\n                  <span>{{ $t(\"NumberOfBets\") }}:</span\r\n                  ><!--成员动态-->\r\n                  <span class=\"blue-text\">{{ item.BetSumNum }}</span>\r\n                </div>\r\n                <div class=\"contribution\">\r\n                  <span>{{ $t(\"Contribution\") }}:</span\r\n                  ><!--贡献值-->\r\n                  <span class=\"green-text\">+{{ item.Contribution }}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!--成员信息-->\r\n      <!-- <div class=\"block\">\r\n        <div class=\"block-title\">{{ $t('MemberInfo') }}</div>\r\n        <div class=\"block-content\">\r\n          <div class=\"members\" v-for=\"item in infoObj\">\r\n            <img :src=\"item.UImg\" alt=\"\" />\r\n            <div class=\"members-data\">\r\n              <div class=\"members-name\">{{ item.name }}</div>\r\n              <div class=\"members-bet\">\r\n                <div class=\"bet-times\">\r\n                  <span>{{ item.info }}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div> -->\r\n    </div>\r\n\r\n    <!-- 俱乐部活动 -->\r\n    <div class=\"myclub-activities\" v-if=\"categoryIndex == 1\">\r\n      <div class=\"myclub-activities-wrap\" >\r\n        <!-- 最新活動 -->\r\n        <div class=\"activities activities-new\">\r\n          <div class=\"activities-title\">\r\n            <p class=\"activities-title-new\">{{ $t('latestActivity') }}</p> <!-- 最新活動 -->\r\n            <div class=\"activities-title-check\" @click=\"$router.push('/ClubActivityMatchResult')\">\r\n              <p class=\"activities-title-check-text\">{{ $t('ViewResults') }}</p><!-- 查看赛果 -->\r\n              <div class=\"activities-title-check-arrow\"></div>\r\n            </div>\r\n          </div>\r\n          <div class=\"activities-content\" v-if=\"activeNodata == false\">\r\n            <div class=\"block\">\r\n              <img :src=\"newActivitiesObj.ClubActivity.ActivityImg\" alt=\"\">\r\n              <p class=\"date\">{{ newActivitiesObj.ClubActivity.CreateTime }}</p>\r\n              <div class=\"abridge-content\">{{ newActivitiesObj.ClubActivity.ActivityContent }}</div>\r\n              <div class=\"activities-btn-wrap\">\r\n                <div class=\"join\" v-if=\"newActivitiesObj.Status == 1\" @click=\"isTicketTipOpen = !isTicketTipOpen; avtiveId = newActivitiesObj.ClubActivity.Id; matchName = newActivitiesObj.MatchName\">{{ $t('JoinNow') }}</div><!-- 立即参与 -->\r\n                <div class=\"join\" v-if=\"newActivitiesObj.Status == 2\" @click=\"avtiveId = newActivitiesObj.ClubActivity.Id; continueBet(avtiveId)\">{{ $t('KeepBetting') }}</div> <!-- 繼續下注 -->\r\n                <div class=\"notJoin\"v-if=\"newActivitiesObj.Status == 0\">{{ $t(CanNotBet) }}</div><!-- 無法參加 -->\r\n                <div class=\"joinSuccess\" v-if=\"newActivitiesObj.Status == 3\" @click=\"avtiveId = newActivitiesObj.ClubActivity.Id; goResultDetail(avtiveId)\">{{ $t('BetSuccessful') }}</div> <!-- 參加成功 -->\r\n                <div class=\"delete\" v-if=\"isManagement == 1\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!-- 俱乐部活动無資料 -->\r\n          <div class=\"no-data\" v-else>\r\n            <p>{{ $t(\"NoData\") }}</p>\r\n            <!-- 【 暂无数据 】 -->\r\n          </div>\r\n        </div>\r\n        <!-- 歷史活動 -->\r\n        <div class=\"activities-title\">\r\n          <p class=\"activities-title-new\">{{ $t('HistoricalActivity') }}</p><!-- 历史活动 -->\r\n        </div>\r\n        <div class=\"activities activities-history\">\r\n          <div class=\"activities-content\" v-if=\"activeNodata == false\">\r\n            <div class=\"block\" v-for=\"(item, index) in historyActivitiesObj\">\r\n              <img :src=\"item.ClubActivity.ActivityImg\" alt=\"\">\r\n              <p class=\"date\">{{ item.ClubActivity.CreateTime }}</p>\r\n              <div class=\"abridge-content\">{{ item.ClubActivity.ActivityContent }}</div>\r\n              <div class=\"activities-btn-wrap\">\r\n                <div class=\"join\" v-if=\"item.Status == 1\" @click=\"isTicketTipOpen = !isTicketTipOpen; avtiveId = item.ClubActivity.Id;  matchName = item.MatchName\">{{ $t('JoinNow') }}</div><!-- 立即参与 -->\r\n                <div class=\"join\" v-if=\"item.Status == 2\" @click=\"avtiveId = item.ClubActivity.Id; continueBet(avtiveId)\">{{ $t('KeepBetting') }}</div> <!-- 繼續下注 -->\r\n                <div class=\"notJoin\" v-if=\"item.Status == 0\">{{ $t('CanNotBet') }}</div><!-- 無法參加 -->\r\n                <div class=\"joinSuccess\" v-if=\"item.Status == 3\" @click=\"avtiveId = item.ClubActivity.Id; goResultDetail(avtiveId)\">{{ $t('BetSuccessful') }}</div> <!-- 參加成功 -->\r\n                <div class=\"delete\" v-if=\"isManagement == 1\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!-- 俱乐部活动無資料 -->\r\n          <div class=\"no-data\" v-else>\r\n            <p>{{ $t(\"NoData\") }}</p>\r\n            <!-- 【 暂无数据 】 -->\r\n          </div>\r\n        </div>\r\n        <div class=\"release-btn-wrap\" v-if=\"isManagement == 1\">\r\n          <div class=\"release-btn\" @click=\"activesRelease()\">{{ $t(\"Release\") }}</div> <!--發布-->\r\n        </div>\r\n      </div>\r\n      \r\n    </div>\r\n\r\n    <!-- 俱乐部公告 -->\r\n    <div class=\"myclub-notice-wrap\" v-if=\"categoryIndex === 2\">\r\n      <div class=\"club-message\" v-if=\"clubMsgList.length > 0 && isRelease == false\" v-infinite-scroll=\"load\" infinite-scroll-immediate=\"immediate\" infinite-scroll-disabled=\"busy\">\r\n        <!-- 會長 -->\r\n        <div class=\"club-message-list\" v-for=\"(item, index) in clubMsgList\" :key=\"index\" v-if=\"isManagement == 1\">\r\n          <div class=\"club-message-list-left\">\r\n            <div class=\"club-message-list-left-up\">\r\n              <div class=\"club-message-list-left-up-title\">\r\n                {{ item.Title }}\r\n              </div>\r\n              <div class=\"club-message-list-left-up-date\">\r\n                {{ item.CreateTime }}\r\n              </div>\r\n            </div>\r\n            <div class=\"club-message-list-left-down\">\r\n              <div class=\"club-message-list-detail\">{{ item.Content }}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"club-message-list-right\">\r\n            <div class=\"edit\" @click=\"edit(item.Title, item.Content, item.Id)\"></div>\r\n            <div class=\"del\" @click=\"del(item.Id)\"></div>\r\n          </div>\r\n        </div>\r\n        <!-- 會員 -->\r\n        <div class=\"M-message-list\" v-for=\"(item, index) in clubMsgList\" :key=\"index\" v-if=\"isManagement == 2\" @click=\"isDetailOpen(index)\">\r\n          <div class=\"M-message-list-up\">\r\n            <img src=\"@/assets/club/message.png\" />\r\n            <div class=\"M-message-list-up-right\">\r\n              <div class=\"M-message-list-wrap\">\r\n                <div class=\"M-message-list-title\">{{ item.Title }}</div>\r\n                <div class=\"M-message-list-date\">{{ item.CreateTime }}</div>\r\n              </div>\r\n              <div\r\n                class=\"M-message-list-detail\"\r\n                :class=\"{ 'open-msg': detailIndex == index && isOpenDetail }\"\r\n              >\r\n                {{ item.Content }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"M-message-list-down\">{{ $t('DisplayMore') }}</div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 發佈頁面 -->\r\n      <div class=\"release\" v-if=\"isRelease == true\">\r\n        <input class=\"input-title\" type=\"text\" placeholder=\"请输入文章标题(5-30个汉字)\" v-model=\"inputTitle\">\r\n        <textarea class=\"input-textarea\" cols=\"30\" rows=\"10\" placeholder=\"请输入正文\" v-model=\"inputTextarea\"></textarea>\r\n        <div class=\"release-Btn2\" @click=\"addOrEditNotice(releaseId)\">{{ $t('Release') }}</div> <!--發布-->\r\n      </div>\r\n      <!-- 無資料時 -->\r\n      <div class=\"noData\" v-if=\"clubMsgList.length == 0\">\r\n        <p>{{ $t(\"NoData\") }}</p>\r\n        <!-- 【 暂无数据 】 -->\r\n      </div>\r\n      <div  class=\"release-btn-wrap\"  v-if=\"isManagement == 1 && isRelease == false\">\r\n        <div class=\"release-btn\" @click=\"openRelease()\">{{ $t(\"Release\") }}</div> <!--發布-->\r\n        <!-- 发布 -->\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 彈窗 -->\r\n    <transition name=\"fade\">\r\n      <model v-if=\"isOpen\"></model>\r\n    </transition>\r\n    <transition name=\"fade\">\r\n      <div class=\"fancyBox\" v-if=\"isOpen\">\r\n        <span v-if=\"type == 1\">{{ $t(\"ComingSoon\") }}!</span><!--敬請期待-->\r\n        <span v-if=\"type == 2\">{{ callBackMsg }}!</span>\r\n        <span v-if=\"type == 3\">{{ callBackMsg }}!</span>\r\n        <span v-if=\"type == 4\">{{ callBackMsg }}!</span>\r\n        <div class=\"fancy-box-btn-wrap\">\r\n          <p class=\"confirmBtn\" @click=\"confirmBtnEvent(type)\">\r\n            {{ $t(\"Confirm\") }}\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </transition>\r\n\r\n    <!-- 購買門票彈窗 -->\r\n    <transition name=\"fade\">\r\n      <model v-if=\"isTicketTipOpen\"></model>\r\n    </transition>\r\n    <transition name=\"fade\">\r\n      <div class=\"ticketTip\" v-if=\"isTicketTipOpen\">\r\n        <img src=\"../../assets/club/ticket-header.png\" alt=\"\">\r\n        <p class=\"ticketTip-title\">\r\n          {{ $t('LeagueGame') }}<!-- 本次联赛的竞赛活动为 -->\r\n          <span>{{ matchName }}</span>\r\n        </p>\r\n        <p class=\"ticketTip-content\" v-html=\"ticketTipText\"></p>\r\n        <div class=\"ticketTip-btn\">\r\n          <p>{{ $t('ActiveTicket') }}</p><!-- 门票需消耗100金币 -->\r\n          <div class=\"ticketTip-btn-buy\" @click=\"getTicket()\">{{ $t('BuyNow') }}</div><!-- 立即购买 -->\r\n          <div class=\"ticketTip-btn-cancel\" @click=\"isTicketTipOpen = !isTicketTipOpen\">{{ $t('Cancel') }}</div>\r\n        </div>\r\n      </div>\r\n    </transition>\r\n    <!-- 推廣碼 -->\r\n    <!-- <div class=\"myclub-promote\">\r\n      <div class=\"myclub-promote-content\">\r\n        <span>{{ $t('ClubReferralCode') }}:</span>\r\n        <span id=\"promoteCode\" class=\"promoteCode\">{{ promoteCode }}</span>\r\n        <div class=\"copy-text\" @click=\"copy()\">{{ $t('Copy') }}</div>\r\n      </div>\r\n    </div> -->\r\n  </div>\r\n</template>\r\n<script>\r\nimport back from \"@/components/Botton/back.vue\";\r\nimport { apiGetMyClub, apiGetClubAnnouncement, apiAddOrUpClubAnnouncement } from \"@/api/Club.js\";\r\nimport { apiBuyClubActivityTicket } from \"@/api/ClubActivitys.js\";\r\nimport model from \"@/components/model\";\r\nexport default {\r\n  name: \"myClub\",\r\n  components: {\r\n    back,\r\n    model,\r\n  },\r\n  data() {\r\n    return {\r\n      lang: \"\",\r\n      // 俱乐部信息; 俱乐部活动; 俱乐部公告; 俱樂部列表(首頁)\r\n      category: [\r\n        this.$t(\"ClubInformation\"),\r\n        this.$t(\"ClubActivities\"),\r\n        this.$t(\"ClubNotice\"),\r\n        this.$t(\"ClubList\")\r\n      ],\r\n      categoryIndex: 0,\r\n      growValue: 0,\r\n      growMinValue: 0,\r\n      growMaxValue: 0,\r\n      restCalue: 0,\r\n      tipCssLeft: 190,\r\n      clubId: undefined,\r\n      userName: \"\",\r\n      isOpen: false,\r\n      situationObj: [\r\n        {\r\n          UImg: \"\",\r\n          UName: \"\",\r\n          BetSumNum: 0,\r\n          Contribution: 0\r\n        }\r\n      ],\r\n      promoteCode: \"XDF5454581\",\r\n      type: 0, // 1 = 俱樂部活動訊息(目前沒訊息所以先用彈窗通知), 2 = 無會員時回傳訊息\r\n      callBackMsg: \"\",\r\n      isManagement: 0,\r\n      isRelease: false,\r\n      clubMsgList: [],\r\n      detailIndex: undefined,\r\n      isOpenDetail: true,\r\n      indexNum: 1,\r\n      inputTitle: \"\",\r\n      inputTextarea: \"\",\r\n      releaseStatus: undefined,\r\n      releaseId: undefined,\r\n\r\n      // 俱樂部活動\r\n      newActivitiesObj: {},\r\n      historyActivitiesObj: [],\r\n      isTicketTipOpen: false,\r\n      ticketTipText: \"活动规则：<br />1、胜负的判断：<br />①根据最终比赛结果来判定对应的竞猜胜负<br />②根据本次活动竞猜正确的胜率来判断第一名<br />2、参与规则<br />①参与需缴纳一定金额的门票<br />②购买门票的用户，视作愿意参与活动，门票不予退还<br />3、奖励规则<br />①胜利最高的为第一名，胜率想同的用户并列第一<br />②第一名的用户获得本次活动门票收益,如有多个用户并列第一，则均分本次活动的奖励<br />③奖励的发放在活动结束后的2个工作日内，由系统自动发放奖励<br />活动最终解释权归本APP所有\",\r\n      avtiveId: \"\",\r\n      activeNodata: false,\r\n      matchName: \"\",\r\n      // v-infinite-scroll 套件\r\n      busy: false,\r\n      immediate: false,\r\n      vIndex: 1,\r\n    };\r\n  },\r\n  async created() {\r\n    // 讀取目前語系，有翻譯需要\r\n    this.lang = JSON.parse(localStorage.getItem(\"lang\")).name;\r\n    // 讀取是否為管理階\r\n    this.isManagement = localStorage.getItem(\"isManagement\");\r\n\r\n    this.userName = localStorage.getItem(\"uname\");\r\n    this.clubId = localStorage.getItem(\"ClubId\");\r\n    // 讀取會員資訊\r\n    await this.getMyClub().then(() => {\r\n      if (localStorage.getItem(\"categoryIndex\") == undefined || localStorage.getItem(\"categoryIndex\") == null) {\r\n        this.categoryIndex = 0;\r\n        this.getCategory(0);\r\n      } else {\r\n        this.categoryIndex = localStorage.getItem(\"categoryIndex\")\r\n        this.getCategory(this.categoryIndex);\r\n      }\r\n      // }\r\n    })\r\n  },\r\n  methods: {\r\n    getCategory(index) {\r\n      this.categoryIndex = index;\r\n      localStorage.setItem(\"categoryIndex\", index);\r\n      if (index == 0) {\r\n        this.getMyClub().then(() => {\r\n            this.changeRangeVal();\r\n        });\r\n      }\r\n      // 俱樂部活動\r\n      if (index == 1) {\r\n        // 讀取活動發布頁面聯賽\r\n        // this.getMyClub()\r\n        if (this.newActivitiesObj == null || this.newActivitiesObj.length <= 0) {\r\n          this.newActivitiesObj = [];\r\n          this.activeNodata = true;\r\n        } else if (this.historyActivitiesObj == null || this.historyActivitiesObj.length <= 0) {\r\n          this.historyActivitiesObj = [];\r\n          this.activeNodata = true;\r\n        }\r\n      }\r\n      // 跳轉俱樂部公告\r\n      if (index == 2) {\r\n        this.isRelease = false;\r\n        this.releaseStatus = undefined;\r\n        this.getNoticeList();\r\n      }\r\n      // 跳轉俱樂部列表\r\n      if (index == 3) {\r\n        this.$router.push(\"/CreateClub\");\r\n      }\r\n    },\r\n\r\n    // tooltip跟著拉趕跑\r\n    async changeRangeVal() {\r\n      let tooltip = document.querySelector(\".grow-bar-tooltip\");\r\n      let rangeBtn = document.querySelector(\".el-slider__bar\");\r\n      let tooltipWidth = tooltip.getBoundingClientRect().width; // 提示框最正確的寬度\r\n      let rangeBtnOffset = rangeBtn.offsetWidth; // 拖動拉桿時拉桿條的偏移量\r\n      let tolerance = rangeBtnOffset - tooltipWidth / 2;\r\n      this.tipCssLeft = tolerance;\r\n    },\r\n\r\n    copy() {\r\n      let TextRange = document.createRange();\r\n      TextRange.selectNode(document.getElementById(\"promoteCode\"));\r\n      let sel = window.getSelection();\r\n      sel.removeAllRanges();\r\n      sel.addRange(TextRange);\r\n      document.execCommand(\"copy\");\r\n    },\r\n\r\n    // 獲取會員俱樂部資訊\r\n    async getMyClub() {\r\n      await apiGetMyClub(\"\", true).then(res => {\r\n        if (res.Code) {\r\n          this.type = 2;\r\n          this.isOpen = true;\r\n          this.callBackMsg = res.Message;\r\n        }\r\n        this.growMaxValue = res.Data.NextLvContribution;\r\n        this.growValue = res.Data.Contribution;\r\n        this.situationObj = res.Data.ClubMemLogs;\r\n        \r\n        // 俱樂部活動頁的資料\r\n        this.newActivitiesObj = res.Data.ClubActivityList.LatestClubActivity;\r\n        this.historyActivitiesObj = res.Data.ClubActivityList.ClubActivitys;\r\n      })\r\n    },\r\n\r\n    // 活動開啟發佈頁面\r\n    activesRelease() {\r\n      this.$router.push('/ClubActivitiesRelease');\r\n    },\r\n\r\n    // 購買活動門票\r\n    getTicket() {\r\n      let data = {\r\n        ClubId: this.clubId,\r\n        ClubActivityId: this.avtiveId\r\n      };\r\n      apiBuyClubActivityTicket(data, true).then(res => {\r\n        localStorage.setItem(\"AcvtiveId\", this.avtiveId);\r\n        let vm = this;\r\n        const m = vm.$message({\r\n          message: this.$t('SuccessfulPurchase'),\r\n          duration: 3000,\r\n          type: \"success\",\r\n          center: true\r\n        });\r\n        setTimeout(() => m.close(), 2000);\r\n        setTimeout(() => {\r\n          this.isTicketTipOpen = false;\r\n          this.getMyClub();\r\n        }, 3000);\r\n      });\r\n    },\r\n\r\n    // 繼續下注\r\n    continueBet(avtiveId) {\r\n      localStorage.setItem(\"AcvtiveId\", avtiveId);\r\n      this.$router.push(\"/ClubActivityMatch\");\r\n    },\r\n\r\n    // 參加成功\r\n    goResultDetail(avtiveId){\r\n      localStorage.setItem(\"AcvtiveId\", avtiveId);\r\n      this.$router.push(\"/ActivityMatchResultDetail\");\r\n    },\r\n    // 獲取公告列表\r\n    getNoticeList() {\r\n      let data = {\r\n        ndex: this.indexNum,\r\n        count: 10\r\n      };\r\n      apiGetClubAnnouncement(data, true).then(res => {\r\n        this.clubMsgList = res.Data.Data;\r\n      });\r\n    },\r\n\r\n    // 公告信息下拉\r\n    isDetailOpen(index) {\r\n      if (this.detailIndex == index && this.isOpenDetail == true) {\r\n        this.isOpenDetail = false;\r\n        return;\r\n      }\r\n      this.detailIndex = index;\r\n      this.isOpenDetail = true;\r\n    },\r\n\r\n    // 公告開啟發佈頁面\r\n    openRelease() {\r\n      this.isRelease = true;\r\n      this.inputTitle = \"\";\r\n      this.inputTextarea = \"\";\r\n      this.releaseStatus = 1\r\n    },\r\n\r\n    // 點擊編輯按鈕 開啟發佈頁面編輯\r\n    edit(title, content, id) {\r\n      this.isRelease = true;\r\n      this.inputTitle = title;\r\n      this.inputTextarea = content;\r\n      this.releaseStatus = 2;\r\n      this.releaseId = id;\r\n    },\r\n\r\n    // 新增、編輯公告\r\n    addOrEditNotice(id) {\r\n      if(this.inputTitle == \"\" || this.inputTextarea == \"\") {\r\n        this.type = 4;\r\n        this.isOpen = true;\r\n        this.callBackMsg = this.$t('ValueIsNull');\r\n        return;\r\n      }\r\n      //新增\r\n      if(this.releaseStatus == 1) {\r\n        let data = {\r\n          Title: this.inputTitle,\r\n          Content: this.inputTextarea,\r\n          Status: 1,\r\n        }\r\n        apiAddOrUpClubAnnouncement(data, true).then(res => {\r\n          this.type = 3;\r\n          this.isOpen = true;\r\n          this.callBackMsg = res.Message;\r\n        });\r\n        return;\r\n      }\r\n      // 編輯\r\n      if(this.releaseStatus == 2) {\r\n        let data = {\r\n          Title: this.inputTitle,\r\n          Content: this.inputTextarea,\r\n          Status: 1,\r\n          Id: id\r\n        }\r\n        apiAddOrUpClubAnnouncement(data, true).then(res => {\r\n          this.type = 3;\r\n          this.isOpen = true;\r\n          this.callBackMsg = res.Message;\r\n        });\r\n      }\r\n    },\r\n    // 刪除公告\r\n    del(id) {\r\n      let data = {\r\n        Status: 0,\r\n        Id: id\r\n      }\r\n      apiAddOrUpClubAnnouncement(data, true).then(res => {\r\n        this.type = 3;\r\n        this.isOpen = true;\r\n        this.callBackMsg = res.Message;\r\n      });\r\n    },\r\n    // 彈窗確認按鈕事件\r\n    confirmBtnEvent(type) {\r\n      if (type == 1) {\r\n        this.isOpen = false;\r\n      }\r\n      if (type == 2) {\r\n        this.$router.push(\"/CreateClub\");\r\n      }\r\n      // 公告彈窗事件\r\n      if (type == 3) {\r\n        this.isOpen = false;\r\n        this.getCategory(2);\r\n      }\r\n      \r\n      // 公告為空值時\r\n      if (type == 4) {\r\n        this.isOpen = false;\r\n      }\r\n    },\r\n\r\n    // 無限加載\r\n    load() {\r\n      this.vIndex++; \r\n      this.busy = false;\r\n      let data = {\r\n        index: this.vIndex,\r\n        count: 10\r\n      };\r\n      apiGetClubAnnouncement(data, true).then(res => {\r\n        // this.clubMsgList = res.Data.Data;\r\n        if (res.Data.Data.length == 0) {\r\n          this.busy = true;\r\n        } else if(res.Data.Data.length > 0){\r\n          res.Data.Data.forEach(el => {\r\n            this.clubMsgList.push(el);\r\n            this.busy = false;\r\n          })\r\n        }\r\n      });\r\n    }\r\n  },\r\n  // 前往別頁面時，把分頁index調整為0\r\n  beforeDestroy() {\r\n    if (this.categoryIndex == 3) {\r\n      localStorage.setItem(\"categoryIndex\", 0);\r\n      return;\r\n    }\r\n    localStorage.setItem(\"categoryIndex\", 0);\r\n  },\r\n};\r\n</script>\r\n"]}]}