{"remainingRequest":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\work\\竞猜可换色板\\src\\views\\personalCenter\\Questionnaire.vue?vue&type=style&index=0&id=27447c43&lang=scss&scoped=true&","dependencies":[{"path":"C:\\work\\竞猜可换色板\\src\\views\\personalCenter\\Questionnaire.vue","mtime":1594782860827},{"path":"C:\\work\\竞猜可换色板\\node_modules\\@vue\\cli-service\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.el-checkbox__input.is-checked .el-checkbox__inner, .el-checkbox__input.is-indeterminate .el-checkbox__inner{\n   background-color:rgba(47, 84, 201, 1);\n   border-color: rgba(47, 84, 201, 1);\n }\n .el-checkbox__input.is-checked + .el-checkbox__label {\n   color: rgba(47, 84, 201, 1);\n }\n .el-checkbox.is-bordered.is-checked{\n   border-color: rgba(47, 84, 201, 1);\n }\n .el-checkbox__input.is-focus .el-checkbox__inner{\n   border-color:  rgba(47, 84, 201, 1);\n }\n",{"version":3,"sources":["Questionnaire.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Questionnaire.vue","sourceRoot":"src/views/personalCenter","sourcesContent":["<template>\r\n  <main class=\"questionnaire\" ref=\"cont\" style=\"-webkit-overflow-scrolling: touch;\">\r\n    <div class=\"questionnaire-header\">\r\n      <back class=\"back-icon img-he\"></back>\r\n      <h3>{{ $t(\"Questionnaire\") }}</h3>\r\n    </div>\r\n    <div class=\"title\">\r\n      <p class=\"title-big\" style=\"text-align: center;\">{{questionList.Questionnaire}}</p>\r\n    </div>\r\n    <div class=\"questionnaire-content\">\r\n      <div class=\"questionnaire-wrap\" v-for=\"(node, i) in questionList.questionnaires\">\r\n        <div v-if=\"node.IsChooseMore === 0 && node.Type === 0\">\r\n          <div class=\"questionnaire-topic\">\r\n            {{ (i+1) + \".\" + node.Title}} (\r\n            <span class=\"questionnaire-style\">{{ $t(\"Radio\") }}</span> )\r\n          </div>\r\n          <el-checkbox-group v-model=\"newQuestionList[i]\">\r\n            <el-checkbox\r\n              :label=\"answer.Id\"\r\n              @change=\"bindCheckBox(i,index,$event)\"\r\n              v-for=\"(answer, index) in node.questionnaireAnswers\"\r\n            >{{ answer.AnswerTxt}}</el-checkbox>\r\n          </el-checkbox-group>\r\n        </div>\r\n\r\n        <div v-if=\"node.IsChooseMore === 1 && node.Type === 0\">\r\n          <div class=\"questionnaire-topic\">\r\n            {{ (i+1) + \".\" + node.Title}}(\r\n            <span class=\"questionnaire-style\">{{ $t(\"MultipleChoice\") }}</span> )\r\n          </div>\r\n          <el-checkbox-group v-model=\"newQuestionList[i]\">\r\n            <el-checkbox\r\n              :label=\"answer.Id\"\r\n              @change=\"bindCheckBox(i,index,$event)\"\r\n              v-for=\"(answer, index) in node.questionnaireAnswers\"\r\n            >{{ answer.AnswerTxt }}</el-checkbox>\r\n          </el-checkbox-group>\r\n        </div>\r\n\r\n        <!-- 您的建議 -->\r\n        <div class=\"suggestion-wrap\" v-if=\"node.Type === 1\">\r\n          <div class=\"questionnaire-topic\">{{ (i + 1) + \".\" +$t(\"YourSuggestion\")}}</div>\r\n          <textarea\r\n            class=\"textarea\"\r\n            cols=\"50\"\r\n            rows=\"5\"\r\n            v-model=\"textContent\"\r\n            maxlength=\"50\"\r\n            @input=\"textcontrol()\"\r\n            :placeholder=\"$t('PleaseEnter')\"\r\n          ></textarea>\r\n          <span class=\"text-len\">{{ textLen + \"/50\"}}</span>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 提交按鈕 -->\r\n      <input type=\"submit\" class=\"submit\" @click=\"submit()\" />\r\n    </div>\r\n  </main>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  apiGetQuestionnaireAndQAList,\r\n  apiAddQuestionnaireFeedback\r\n} from \"@/api/Questionnaire.js\";\r\nimport back from \"@/components/Botton/back.vue\";\r\nexport default {\r\n  components: {\r\n    back\r\n  },\r\n  data() {\r\n    return {\r\n      questionListData: {\r\n        id: 0,\r\n        index: 1,\r\n        count: 10\r\n      },\r\n      questionList: [],\r\n      newQuestionList: [],\r\n      textContent: \"\",\r\n      textLen: 0,\r\n      questionIndex: 0,\r\n      uid: \"\",\r\n      submitData: [],\r\n      answerIdList: [],\r\n      contentStrList: []\r\n    };\r\n  },\r\n  async created() {\r\n    this.uid = localStorage.getItem(\"UId\");\r\n    await apiGetQuestionnaireAndQAList(this.questionListData, true).then(\r\n      res => {\r\n        this.questionList = res;\r\n        this.newQuestionListAry();\r\n      }\r\n    );\r\n  },\r\n  methods: {\r\n    // 判斷API資料有幾道題目，生成幾個空陣列\r\n    newQuestionListAry() {\r\n      for (let i = 0; i < this.questionList.questionnaires.length; i++) {\r\n        this.newQuestionList.push([]);\r\n      }\r\n    },\r\n\r\n    // 判斷多選或單選\r\n    bindCheckBox(i, index, e) {\r\n      this.questionIndex = i;\r\n      if (this.questionList.questionnaires[i].IsChooseMore === 0) {\r\n        if (e === true) {\r\n          this.submitData[i] = {\r\n            Id: 0,\r\n            Uid: this.uid,\r\n            QuestionnaireId: this.questionList.Id,\r\n            QuestionId: this.questionList.questionnaires[i].Id,\r\n            AnswerId: this.questionList.questionnaires[i].questionnaireAnswers[\r\n              index\r\n            ].Id,\r\n            ContentStr: this.questionList.questionnaires[i]\r\n              .questionnaireAnswers[index].AnswerTxt\r\n          };\r\n          if (this.newQuestionList[i].length > 1) {\r\n            this.newQuestionList[i].splice(0, 1);\r\n          }\r\n        } else {\r\n          this.submitData[i] = \"\";\r\n        }\r\n      }\r\n      if (this.questionList.questionnaires[i].IsChooseMore === 1) {\r\n        let answerId = \"\";\r\n        let contentStr = \"\";\r\n        answerId = String(\r\n          this.questionList.questionnaires[i].questionnaireAnswers[index].Id\r\n        );\r\n        contentStr = this.questionList.questionnaires[i].questionnaireAnswers[\r\n          index\r\n        ].AnswerTxt;\r\n        if (e === true) {\r\n          if (typeof this.contentStrList === \"string\") {\r\n            this.contentStrList = this.contentStrList.split(\",\");\r\n            this.contentStrList.push(contentStr);\r\n            this.contentStrList = this.contentStrList.join(\",\");\r\n          } else {\r\n            this.contentStrList.push(contentStr);\r\n            this.contentStrList = this.contentStrList.join(\",\");\r\n          }\r\n\r\n          if (typeof this.answerIdList === \"string\") {\r\n            this.answerIdList = this.answerIdList.split(\",\");\r\n            this.answerIdList.push(answerId);\r\n            this.answerIdList = this.answerIdList.join(\",\");\r\n          } else {\r\n            this.answerIdList.push(answerId);\r\n            this.answerIdList = this.answerIdList.join(\",\");\r\n          }\r\n        } else {\r\n          if (typeof this.contentStrList === \"string\") {\r\n            this.contentStrList = this.contentStrList.split(\",\");\r\n\r\n            if (this.contentStrList.indexOf(contentStr) >= 0) {\r\n              this.contentStrList.splice(\r\n                this.contentStrList.indexOf(contentStr),\r\n                1\r\n              );\r\n              if (this.contentStrList.length > 0)\r\n                this.contentStrList = this.contentStrList.join(\",\");\r\n            }\r\n          }\r\n          if (typeof this.answerIdList === \"string\") {\r\n            this.answerIdList = this.answerIdList.split(\",\");\r\n\r\n            if (this.answerIdList.indexOf(answerId) >= 0) {\r\n              this.answerIdList.splice(this.answerIdList.indexOf(answerId), 1);\r\n              if (this.answerIdList.length > 0)\r\n                this.answerIdList = this.answerIdList.join(\",\");\r\n            }\r\n          }\r\n        }\r\n\r\n        this.submitData[i] = {\r\n          Id: 0,\r\n          Uid: this.uid,\r\n          QuestionnaireId: this.questionList.Id,\r\n          QuestionId: this.questionList.questionnaires[i].Id,\r\n          AnswerId: this.answerIdList,\r\n          ContentStr: this.contentStrList\r\n        };\r\n\r\n        if (this.submitData[i].AnswerId == \"\") {\r\n          this.submitData[i] = \"\";\r\n        }\r\n      }\r\n    },\r\n\r\n    // 字數限制\r\n    textcontrol() {\r\n      let len = this.textContent.length;\r\n      this.textLen = len;\r\n    },\r\n\r\n    // 送出\r\n    submit() {\r\n      // this.questionList.questionnaires.length\r\n      let submitDataJSON;\r\n      var promise = new Promise((resolve, reject) => {\r\n        for (let i = 0; i < this.newQuestionList.length - 1; i++) {\r\n          if (this.newQuestionList[i].length < 1) {\r\n            // alert(\"請填選答案\");\r\n            this.$message({\r\n              message: this.$t(\"FillAnswer\"),\r\n              type: \"error\",\r\n              center: true,\r\n              duration: 1200\r\n            });\r\n            return;\r\n          }\r\n        }\r\n\r\n        if (this.textContent != \"\") {\r\n          this.submitData[this.submitData.length] = {\r\n            Id: 0,\r\n            Uid: this.uid,\r\n            QuestionnaireId: this.questionList.Id,\r\n            QuestionId: this.questionList.questionnaires[\r\n              this.questionList.questionnaires.length - 1\r\n            ].Id,\r\n            AnswerId: \"\",\r\n            ContentStr: this.textContent\r\n          };\r\n        }\r\n        resolve();\r\n      });\r\n\r\n      promise.then(() => {\r\n        submitDataJSON = this.submitData;\r\n        apiAddQuestionnaireFeedback(submitDataJSON, true).then(res => {\r\n          var messagePromise = new Promise((resolve, reject) => {\r\n            if (res.Code == \"600\") {\r\n              this.$message({\r\n                message: res.Message,\r\n                type: \"warning\",\r\n                center: true,\r\n                duration: 1800\r\n              });\r\n            } else {\r\n              this.$message({\r\n                message: this.$t(\"SubmittedSuccessfully\"),\r\n                type: \"success\",\r\n                center: true,\r\n                duration: 1800\r\n              });\r\n            }\r\n             resolve();\r\n          });\r\n          messagePromise.then(() => {\r\n            history.back();\r\n          });\r\n        });\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n .el-checkbox__input.is-checked .el-checkbox__inner, .el-checkbox__input.is-indeterminate .el-checkbox__inner{\r\n    background-color:rgba(47, 84, 201, 1);\r\n    border-color: rgba(47, 84, 201, 1);\r\n  }\r\n  .el-checkbox__input.is-checked + .el-checkbox__label {\r\n    color: rgba(47, 84, 201, 1);\r\n  }\r\n  .el-checkbox.is-bordered.is-checked{\r\n    border-color: rgba(47, 84, 201, 1);\r\n  }\r\n  .el-checkbox__input.is-focus .el-checkbox__inner{\r\n    border-color:  rgba(47, 84, 201, 1);\r\n  }\r\n</style>"]}]}