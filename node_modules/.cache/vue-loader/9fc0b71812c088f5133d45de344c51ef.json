{"remainingRequest":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\work\\竞猜可换色板\\src\\views\\club\\ClubActivities.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\work\\竞猜可换色板\\src\\views\\club\\ClubActivities.vue","mtime":1603895644636},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport back from \"@/components/Botton/back.vue\";\r\nimport model from \"@/components/model\";\r\nimport { apiBuyClubActivityTicket, apiUpdateClubActivityStatus, apiGetClubActivityList} from \"@/api/ClubActivitys.js\";\r\nimport { apiGetClubGamblingList, apiUpdateClubGamblingsStatus} from \"@/api/ClubGamblings.js\";\r\nexport default {\r\n  components: {\r\n    back,\r\n    model\r\n  },\r\n  data() {\r\n    return {\r\n      isManagement: 0,\r\n      clubId: undefined,\r\n      isOpen: false,\r\n\r\n      activeCategoryIndex: 0,\r\n      tabIndex: 0,\r\n      betTabIndex: 0,\r\n      latestActivitiesObj: [],\r\n      historyActivitiesObj: [],\r\n      isTicketTipOpen: false,\r\n      ticketTipText:\r\n        \"活动规则：<br />1、胜负的判断：<br />①根据最终比赛结果来判定对应的竞猜胜负<br />②根据本次活动竞猜正确的胜率来判断第一名<br />2、参与规则<br />①参与需缴纳一定金额的门票<br />②购买门票的用户，视作愿意参与活动，门票不予退还<br />3、奖励规则<br />①胜利最高的为第一名，胜率想同的用户并列第一<br />②第一名的用户获得本次活动门票收益,如有多个用户并列第一，则均分本次活动的奖励<br />③奖励的发放在活动结束后的2个工作日内，由系统自动发放奖励<br />活动最终解释权归本APP所有\",\r\n      avtiveId: \"\",\r\n      activeNodata: false,\r\n      historyNoData: false,\r\n      matchName: \"\",\r\n      // 投注活動\r\n      betMyList: [],\r\n      betOtherList: [],\r\n      betMyListNoData: false,\r\n      betOtherListNoData: false,\r\n\r\n      wipeLoading: false,\r\n      callBackMsg: \"\",\r\n    };\r\n  },\r\n  created() {\r\n    // 讀取是否為管理階\r\n    this.isManagement = localStorage.getItem(\"isManagement\");\r\n    // 取得clubId\r\n    this.clubId = localStorage.getItem(\"ClubId\");\r\n\r\n    if (localStorage.getItem(\"activeCategoryIndex\") == null || localStorage.getItem(\"activeCategoryIndex\") == undefined) {\r\n      this.activeCategoryIndex = 0;\r\n      this.tabIndex = 0;\r\n      this.betTabIndex = 0;\r\n      this.getMyClub();\r\n    } else {\r\n      if (localStorage.getItem(\"activeCategoryIndex\") == \"0\") {\r\n        this.getMyClub();\r\n        this.activeCategoryIndex = 0;\r\n        this.tabIndex = localStorage.getItem(\"tabIndex\");\r\n      } else if (localStorage.getItem(\"activeCategoryIndex\") == \"1\") {\r\n        this.activeCategoryIndex = 1;\r\n        this.getActiveBetList();\r\n        this.betTabIndex = localStorage.getItem(\"betTabIndex\");\r\n      }\r\n    }\r\n\r\n  },\r\n  methods: {\r\n    // 獲取會員俱樂部資訊\r\n    getMyClub() {\r\n      let data = {\r\n        ClubId: this.clubId\r\n      }\r\n      apiGetClubActivityList(data, true).then(res => {\r\n        if (res.Code == \"600\") {\r\n          this.isOpen = true;\r\n          this.callBackMsg = res.Message;\r\n          return;\r\n        }\r\n        // 俱樂部活動頁的資料\r\n        this.latestActivitiesObj = res.Success.LatestClubActivity.ClubActivity;\r\n        this.historyActivitiesObj = res.Success.ClubActivitys;\r\n      })\r\n      this.tabIndex = 0;\r\n      localStorage.setItem(\"activeCategoryIndex\", this.activeCategoryIndex);\r\n    },\r\n\r\n    // 取得俱樂部投注列表\r\n    getActiveBetList() {\r\n      let data = {\r\n        ClubId: this.clubId\r\n      };\r\n      apiGetClubGamblingList(data, true).then(res => {\r\n        this.betMyList = res.Data.MyGamblings;\r\n        this.betOtherList = res.Data.OtherGamblings;\r\n        if (this.betMyList == null || this.betMyList.length == 0) {\r\n          this.betMyListNoData = true;\r\n        }\r\n        if (this.betOtherList == null || this.betOtherList.length == 0) {\r\n          this.betOtherListNoData = true;\r\n        }\r\n      });\r\n       this.betTabIndex = 0;\r\n      localStorage.setItem(\"activeCategoryIndex\", this.activeCategoryIndex);\r\n    },\r\n\r\n    // 切換俱樂部挑戰分頁\r\n    changeTabIndex(index) {\r\n      this.tabIndex = index;\r\n      localStorage.setItem(\"tabIndex\", index);\r\n    },\r\n    // 切換俱樂部投注分頁\r\n    changeBetTabIndex(index) {\r\n      this.betTabIndex = index;\r\n      localStorage.setItem(\"betTabIndex\", index);\r\n    },\r\n\r\n    // 活動開啟發佈頁面\r\n    activesRelease() {\r\n      this.$router.push('/ClubActivitiesRelease');\r\n    },\r\n\r\n    // 購買活動門票\r\n    getTicket() {\r\n      let data = {\r\n        ClubId: this.clubId,\r\n        ClubActivityId: this.avtiveId\r\n      };\r\n      apiBuyClubActivityTicket(data, true).then(res => {\r\n        if (res.Code == 600) {\r\n          let vm = this;\r\n          const m = vm.$message({\r\n            message: res.Message,\r\n            duration: 3000,\r\n            type: \"error\",\r\n            center: true\r\n          });\r\n          setTimeout(() => m.close(), 2000);\r\n          return;\r\n        }\r\n        localStorage.setItem(\"AcvtiveId\", this.avtiveId);\r\n        let vm = this;\r\n        const m = vm.$message({\r\n          message: this.$t('SuccessfulPurchase'),\r\n          duration: 3000,\r\n          type: \"success\",\r\n          center: true\r\n        });\r\n        setTimeout(() => m.close(), 2000);\r\n        setTimeout(() => {\r\n          this.isTicketTipOpen = false;\r\n          this.$router.push(\"/ClubActivityMatch\");\r\n        }, 3000);\r\n      });\r\n    },\r\n\r\n    // 繼續下注\r\n    continueBet(avtiveId) {\r\n      localStorage.setItem(\"AcvtiveId\", avtiveId);\r\n      this.$router.push(\"/ClubActivityMatch\");\r\n    },\r\n\r\n    // 參加成功\r\n    goResultDetail(avtiveId){\r\n      localStorage.setItem(\"AcvtiveId\", avtiveId);\r\n      this.$router.push(\"/ActivityMatchResultDetail\");\r\n    },\r\n\r\n    // 刪除最新活動\r\n    deleteActive(item){\r\n      let data = {\r\n          Id: item.Id,\r\n          ClubId: item.ClubId,\r\n          SelectLeague: item.SelectLeague,\r\n          MatchIds: item.MatchIds,\r\n          PlayIds: item.PlayIds,\r\n          ActivityContent: item.ActivityContent,\r\n          NumGames: item.NumGames,\r\n          ActivityImg: item.ActivityImg,\r\n          SumBonus: item.SumBonus,\r\n          Status: -1,\r\n          Stime: item.Stime,\r\n          Etime: item.Etime,\r\n          CreateTime: item.CreateTime,\r\n          Creator: item.Creator,\r\n      };\r\n      apiUpdateClubActivityStatus(data, true).then(res => {\r\n        if (res.Success) {\r\n          let vm = this;\r\n          const m = vm.$message({\r\n            message: this.$t('successfullyDeleted'),\r\n            duration: 3000,\r\n            type: \"success\",\r\n            center: true\r\n          });\r\n          setTimeout(() => m.close(), 2000);\r\n          this.getMyClub();\r\n        } else {\r\n          let vm = this;\r\n          const x = vm.$message({\r\n            message: res.Message,\r\n            duration: 3000,\r\n            type: \"warning\",\r\n            center: true\r\n          });\r\n          setTimeout(() => x.close(), 2000);\r\n        }\r\n      });\r\n    },\r\n\r\n    // 查看單一賽果 type:  1 = 發起人賽果;  2 = 其他人賽果\r\n    goBetResult(type, id) {\r\n      localStorage.setItem(\"betId\", id);\r\n      localStorage.setItem(\"singleResult\", true)\r\n      if (type == 1) {\r\n        setTimeout(() => {\r\n          this.$router.push(\"/InitiatorBetResult\");\r\n        }, 250);\r\n      } else {\r\n        setTimeout(() => {\r\n          this.$router.push(\"/BetResult\");\r\n        }, 250);\r\n      }\r\n    },\r\n\r\n    // 俱樂部投注刪除\r\n    betDelete(item) {\r\n      let data = {\r\n        Id: item.Id,\r\n        ClubId: item.ClubId,\r\n        MatchId: item.MatchId,\r\n        MatchItemId: item.MatchItemId,\r\n        PlayId: item.PlayId,\r\n        BetPosition: item.BetPosition,\r\n        OddsValue: item.OddsValue,\r\n        GamblingTitle: item.GamblingTitle,\r\n        GamblingContent: item.GamblingContent,\r\n        GamblingImg: item.GamblingImg,\r\n        Deposit: item.Deposit,\r\n        OpenBetAmount: item.OpenBetAmount,\r\n        BettedAmount: item.BettedAmount,\r\n        HandlingCharge: item.HandlingCharge,\r\n        Status: -1,\r\n        Stime: item.Stime,\r\n        Etime: item.Etime,\r\n        CreateTime: item.CreateTime,\r\n        Creator: item.Creator\r\n      }\r\n      apiUpdateClubGamblingsStatus(data, true).then(res => {\r\n        if(res.Success) {\r\n          let vm = this;\r\n          const m = vm.$message({\r\n            message: this.$t('successfullyDeleted'),\r\n            duration: 3000,\r\n            type: \"success\",\r\n            center: true\r\n          });\r\n          setTimeout(() => m.close(), 2000);\r\n          // 再獲取一次列表\r\n          this.getActiveBetList();\r\n          return;\r\n        } \r\n        if (res.Code == 600) {\r\n          let vm = this;\r\n          const m = vm.$message({\r\n            message: res.Message,\r\n            duration: 3000,\r\n            type: \"warning\",\r\n            center: true\r\n          });\r\n          setTimeout(() => m.close(), 2000);\r\n          return;\r\n        }\r\n        if (res.Data.Item1 == false) {\r\n          let vm = this;\r\n          const m = vm.$message({\r\n            message: this.$t(\"DataError\"),\r\n            duration: 3000,\r\n            type: \"warning\",\r\n            center: true\r\n          });\r\n          setTimeout(() => m.close(), 2000);\r\n          return;\r\n        }\r\n\r\n      });\r\n    },\r\n\r\n    // 彈窗確認按鈕事件\r\n    confirmBtnEvent() {\r\n      this.$router.push(\"/CreateClub\");\r\n    },\r\n  }\r\n};\r\n",{"version":3,"sources":["ClubActivities.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"ClubActivities.vue","sourceRoot":"src/views/club","sourcesContent":["<template>\r\n  <!-- 俱乐部活动 -->\r\n  <div class=\"myclub-activities\">\r\n\t<div class=\"myclub-activities-header\">\r\n\t\t<div class=\"myclub-activities-header-wrap\">\r\n\t\t\t<back class=\"back-icon img-he\"></back>\r\n\t\t\t<h3>{{ $t(\"ClubActivities\") }}</h3>\r\n\t\t\t<!--俱乐部活动-->\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=\"activities-type\">\r\n\t\t<div class=\"activities-type-btn\" :class=\"{ 'activities-type-btn-active': activeCategoryIndex == 0 }\" @click=\"activeCategoryIndex = 0; getMyClub();\">俱樂部挑戰</div>\r\n\t\t<div class=\"activities-type-btn\" :class=\"{ 'activities-type-btn-active': activeCategoryIndex == 1 }\" @click=\"activeCategoryIndex = 1; getActiveBetList();\">俱樂部投注</div>\r\n\t</div>\r\n\t<!-- 俱樂部挑戰 -->\r\n\t<div class=\"activities-challenge-wrap\" v-show=\"activeCategoryIndex == 0\">\r\n\t\t<!-- 挑戰最新活動 -->\r\n\t\t<div class=\"activities-challenge-tab\">\r\n\t\t\t<div class=\"activities-challenge-tab-wrap\">\r\n\t\t\t\t<p class=\"activities-challenge-title\" :class=\"{ 'titile-focus': tabIndex == 0 }\" @click=\"changeTabIndex(0)\">{{ $t(\"latestActivity\") }}</p>\r\n\t\t\t\t<!-- 最新活動 -->\r\n\t\t\t\t<div class=\"divider\"></div>\r\n\t\t\t\t<!-- 分隔線 -->\r\n\t\t\t\t<p class=\"activities-challenge-title\" :class=\"{ 'titile-focus': tabIndex == 1 }\" @click=\"changeTabIndex(1)\">{{ $t(\"HistoricalActivity\") }}</p>\r\n\t\t\t\t<!-- 历史活动 -->\r\n\t\t\t</div>\r\n\t\t\t<div class=\"check-result\" @click=\"$router.push('/ClubActivityMatchResult')\">\r\n\t\t\t\t<p class=\"check-result-text\">{{ $t(\"ViewResults\") }}</p>\r\n\t\t\t\t<!-- 查看赛果 -->\r\n\t\t\t\t<div class=\"check-result-arrow\"></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"activities-challenge activities-challenge-new\" v-show=\"tabIndex == 0\">\r\n\t\t\t<div v-if=\"activeNodata == false\">\r\n\t\t\t\t<div v-if=\"latestActivitiesObj.length <= 0\" style=\"font-size: .24rem;text-align:center;line-height: .48rem;margin-top: 0.3rem\">{{ $t(\"WipeLoading\") }}</div>\r\n\t\t\t\t<div class=\"activities-challenge-content\">\r\n\t\t\t\t\t<div class=\"block\">\r\n\t\t\t\t\t\t<img :src=\"latestActivitiesObj.ActivityImg\" alt=\"\" />\r\n\t\t\t\t\t\t<p class=\"date\">{{ latestActivitiesObj.CreateTime }}</p>\r\n\t\t\t\t\t\t<div class=\"abridge-content\">{{ latestActivitiesObj.ActivityContent }}</div>\r\n\t\t\t\t\t\t<div class=\"activities-challenge-btn-wrap\">\r\n\t\t\t\t\t\t\t<div class=\"join\" v-if=\"latestActivitiesObj.Status == 1\" @click=\" isTicketTipOpen = !isTicketTipOpen; avtiveId = latestActivitiesObj.Id; matchName = latestActivitiesObj.MatchName;\">{{ $t(\"JoinNow\") }}</div>\r\n\t\t\t\t\t\t\t<!-- 立即参与 -->\r\n\t\t\t\t\t\t\t<div class=\"join\" v-if=\"latestActivitiesObj.Status == 2\" @click=\" avtiveId = latestActivitiesObj.Id; continueBet(avtiveId);\">{{ $t(\"KeepBetting\") }}</div>\r\n\t\t\t\t\t\t\t<!-- 繼續下注 -->\r\n\t\t\t\t\t\t\t<div class=\"notJoin\" v-if=\"latestActivitiesObj.Status == 0\">{{ $t(\"CanNotBet\") }}</div>\r\n\t\t\t\t\t\t\t<!--  活動結束 -->\r\n\t\t\t\t\t\t\t<div class=\"joinSuccess\" v-if=\"latestActivitiesObj.Status == 3\" @click=\" avtiveId = latestActivitiesObj.Id; goResultDetail(avtiveId);\">{{ $t(\"BetSuccessful\") }}</div>\r\n\t\t\t\t\t\t\t<!-- 參加成功 -->\r\n\t\t\t\t\t\t\t<div class=\"delete\" v-if=\"isManagement == 1\" @click=\"deleteActive(latestActivitiesObj)\"></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<!-- 俱乐部活动無資料 -->\r\n\t\t\t<div class=\"no-data\" v-else>\r\n\t\t\t\t<p>{{ $t(\"NoData\") }}</p>\r\n\t\t\t\t<!-- 【 暂无数据 】 -->\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<!-- 歷史活動 -->\r\n\t\t<div class=\"activities-challenge activities-challenge-history\" v-show=\"tabIndex == 1\">\r\n\t\t\t<div v-if=\"historyNoData == false\">\r\n\t\t\t\t<div v-if=\"historyActivitiesObj.length <= 0\" style=\"font-size: .24rem;text-align:center;line-height: .48rem;margin-top: 0.3rem\">{{ $t(\"WipeLoading\") }}</div>\r\n\t\t\t\t<div class=\"activities-challenge-content\">\r\n\t\t\t\t\t<div class=\"block\" v-for=\"(item, index) in historyActivitiesObj\">\r\n\t\t\t\t\t\t<img :src=\"item.ClubActivity.ActivityImg\" alt=\"\" />\r\n\t\t\t\t\t\t<p class=\"date\">{{ item.ClubActivity.CreateTime }}</p>\r\n\t\t\t\t\t\t<div class=\"abridge-content\">{{ item.ClubActivity.ActivityContent }}</div>\r\n\t\t\t\t\t\t<div class=\"activities-challenge-btn-wrap\">\r\n\t\t\t\t\t\t\t<div class=\"join\" v-if=\"item.Status == 1\" @click=\" isTicketTipOpen = !isTicketTipOpen; avtiveId = item.ClubActivity.Id; matchName = item.MatchName;\">{{ $t(\"JoinNow\") }}</div>\r\n\t\t\t\t\t\t\t<!-- 立即参与 -->\r\n\t\t\t\t\t\t\t<div class=\"join\" v-if=\"item.Status == 2\" @click=\" avtiveId = item.ClubActivity.Id; continueBet(avtiveId);\">{{ $t(\"KeepBetting\") }}</div>\r\n\t\t\t\t\t\t\t<!-- 繼續下注 -->\r\n\t\t\t\t\t\t\t<div class=\"notJoin\" v-if=\"item.Status == 0\">{{ $t(\"CanNotBet\") }}</div>\r\n\t\t\t\t\t\t\t<!--  活動結束 -->\r\n\t\t\t\t\t\t\t<div class=\"joinSuccess\" v-if=\"item.Status == 3\" @click=\" avtiveId = item.ClubActivity.Id; goResultDetail(avtiveId);\">{{ $t(\"BetSuccessful\") }}</div>\r\n\t\t\t\t\t\t\t<!-- 參加成功 -->\r\n\t\t\t\t\t\t\t<div class=\"delete\" v-if=\"isManagement == 1\" @click=\"deleteActive(item.ClubActivity)\"></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<!-- 俱乐部活动無資料 -->\r\n\t\t\t<div class=\"no-data\" v-else>\r\n\t\t\t\t<p>{{ $t(\"NoData\") }}</p>\r\n\t\t\t\t<!-- 【 暂无数据 】 -->\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"release-btn-wrap\" v-if=\"isManagement == 1\">\r\n\t\t\t<div class=\"release-btn\" @click=\"activesRelease()\">{{ $t(\"Release\") }}</div>\r\n\t\t\t<!--發布-->\r\n\t\t</div>\r\n\t</div>\r\n\t<!-- 俱樂部投注 -->\r\n\t<div class=\"activities-bet-wrap\" v-show=\"activeCategoryIndex == 1\">\r\n\t\t<!-- 我的活动 -->\r\n\t\t<div class=\"activities-bet-tab\">\r\n\t\t\t<div class=\"activities-bet-tab-wrap\">\r\n\t\t\t\t<p class=\"activities-bet-tab-title\" :class=\"{ 'titile-focus': betTabIndex == 0 }\" @click=\"changeBetTabIndex(0)\">{{ $t(\"MyActivities\") }}</p>\r\n\t\t\t\t<!-- 我的活动 -->\r\n\t\t\t\t<div class=\"divider\"></div>\r\n\t\t\t\t<p class=\"activities-bet-tab-title\" :class=\"{ 'titile-focus': betTabIndex == 1 }\" @click=\"changeBetTabIndex(1)\">{{ $t(\"ClubActivities\") }}</p>\r\n\t\t\t\t<!-- 俱樂部活動 -->\r\n\t\t\t</div>\r\n\t\t\t<div class=\"check-result\" v-if=\"betTabIndex == 0\" @click=\"$router.push('/InitiatorBetResult')\">\r\n\t\t\t\t<p class=\"check-result-text\">{{ $t(\"ViewResults\") }}</p>\r\n\t\t\t\t<!-- 查看赛果 -->\r\n\t\t\t\t<div class=\"check-result-arrow\"></div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"check-result\" v-if=\"betTabIndex == 1\" @click=\"$router.push('/BetResult')\">\r\n\t\t\t\t<p class=\"check-result-text\">{{ $t(\"ViewResults\") }}</p>\r\n\t\t\t\t<!-- 查看赛果 -->\r\n\t\t\t\t<div class=\"check-result-arrow\"></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"activities-bet\" v-show=\"betTabIndex == 0\">\r\n\t\t\t<div v-if=\"betMyListNoData == false\">\r\n\t\t\t\t<div v-if=\"betMyList.length <= 0\" style=\"font-size: .24rem;text-align:center;line-height: .48rem;margin-top: 0.3rem\">{{ $t(\"WipeLoading\") }}</div>\r\n\t\t\t\t<div class=\"activities-bet-content\">\r\n\t\t\t\t\t<div class=\"activities-bet-content-list\" v-for=\"item in betMyList\">\r\n\t\t\t\t\t\t<img :src=\"item.ClubGambling.GamblingImg\" />\r\n\t\t\t\t\t\t<div class=\"activities-bet-content-list-left\">\r\n\t\t\t\t\t\t\t<div class=\"activities-bet-content-list-left-up\">\r\n\t\t\t\t\t\t\t\t<div class=\"activities-bet-content-list-left-up-title\">{{ item.ClubGambling.GamblingTitle }}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"activities-bet-content-list-left-up-date\">{{ item.ClubGambling.CreateTime.slice( 0, item.ClubGambling.CreateTime.indexOf(\"T\") ) }}</div>\r\n\t\t\t\t\t\t\t<div class=\"activities-bet-content-list-left-down\">\r\n\t\t\t\t\t\t\t\t<div class=\"activities-bet-content-list-detail\">{{ item.ClubGambling.GamblingContent }}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"activities-bet-content-list-right\">\r\n\t\t\t\t\t\t\t<div class=\"bet-status-btn\" @click=\"goBetResult(1, item.ClubGambling.Id)\">{{ $t(\"ViewResults\") }}</div>\r\n\t\t\t\t\t\t\t<div class=\"del\" @click=\"betDelete(item.ClubGambling)\"></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<!-- 我的投注無資料 -->\r\n\t\t\t<div class=\"no-data\" v-else>\r\n\t\t\t\t<p>{{ $t(\"NoData\") }}</p>\r\n\t\t\t\t<!-- 【 暂无数据 】 -->\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<!-- 投注俱樂部活動 -->\r\n\t\t<div class=\"activities-bet\" v-show=\"betTabIndex == 1\">\r\n\t\t\t<div v-if=\"betOtherListNoData == false\">\r\n\t\t\t\t<div v-if=\"betOtherList.length <= 0\" style=\"font-size: .24rem;text-align:center;line-height: .48rem;margin-top: 0.3rem\">{{ $t(\"WipeLoading\") }}</div>\r\n\t\t\t\t<div class=\"activities-bet-content\">\r\n\t\t\t\t\t<div class=\"activities-bet-content-list\" v-for=\"item in betOtherList\">\r\n\t\t\t\t\t\t<img :src=\"item.ClubGambling.GamblingImg\" />\r\n\t\t\t\t\t\t<div class=\"activities-bet-content-list-left\">\r\n\t\t\t\t\t\t\t<div class=\"activities-bet-content-list-left-up\">\r\n\t\t\t\t\t\t\t\t<div class=\"activities-bet-content-list-left-up-title\">{{ item.ClubGambling.GamblingTitle }}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"activities-bet-content-list-left-up-date\">{{ item.ClubGambling.CreateTime.slice( 0, item.ClubGambling.CreateTime.indexOf(\"T\") ) }}</div>\r\n\t\t\t\t\t\t\t<div class=\"activities-bet-content-list-left-down\">\r\n\t\t\t\t\t\t\t\t<div class=\"activities-bet-content-list-detail\">{{ item.ClubGambling.GamblingContent }}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"activities-bet-content-list-right\">\r\n\t\t\t\t\t\t\t<div class=\"bet-status-btn\" v-if=\"item.JoinStatus == '观看赛果'\" @click=\"goBetResult(2, item.ClubGambling.Id)\">{{ $t(\"ViewResults\") }}</div>\r\n\t\t\t\t\t\t\t<!-- 查看賽果 -->\r\n\t\t\t\t\t\t\t<div class=\"bet-status-btn\" v-if=\"item.JoinStatus == '参与活动'\" @click=\"goBet(item.ClubGambling.Id)\">{{ $t(\"JoinNow\") }}</div>\r\n\t\t\t\t\t\t\t<!-- 立即参与 -->\r\n\t\t\t\t\t\t\t<div class=\"bet-status-btn-disable\" v-if=\"item.JoinStatus == '无法参加'\">{{ $t(\"CanNotBet\") }}</div>\r\n\t\t\t\t\t\t\t<!--  活動結束 -->\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<!-- 其他投注無資料 -->\r\n\t\t\t<div class=\"no-data\" v-else>\r\n\t\t\t\t<p>{{ $t(\"NoData\") }}</p>\r\n\t\t\t\t<!-- 【 暂无数据 】 -->\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"release-btn-wrap\">\r\n\t\t\t<div class=\"release-btn\" @click=\"$router.push('/gameSport')\">{{ $t(\"Release\") }}</div>\r\n\t\t\t<!--發布-->\r\n\t\t</div>\r\n\t</div>\r\n\t<!-- 購買門票彈窗 -->\r\n\t<transition name=\"fade\">\r\n\t\t<model v-if=\"isTicketTipOpen\"></model>\r\n\t</transition>\r\n\t<transition name=\"fade\">\r\n\t\t<div class=\"ticketTip\" v-if=\"isTicketTipOpen\">\r\n\t\t\t<img src=\"../../assets/club/ticket-header.png\" alt=\"\">\r\n\t\t\t<p class=\"ticketTip-title\">{{ $t('LeagueGame') }}\r\n\t\t\t\t<!-- 本次联赛的竞赛活动为 --> <span>{{ matchName }}</span>\r\n\t\t\t</p>\r\n\t\t\t<p class=\"ticketTip-content\" v-html=\"ticketTipText\"></p>\r\n\t\t\t<div class=\"ticketTip-btn\">\r\n\t\t\t\t<p>{{ $t('ActiveTicket') }}</p>\r\n\t\t\t\t<!-- 门票需消耗100金币 -->\r\n\t\t\t\t<div class=\"ticketTip-btn-buy\" @click=\"getTicket()\">{{ $t('BuyNow') }}</div>\r\n\t\t\t\t<!-- 立即购买 -->\r\n\t\t\t\t<div class=\"ticketTip-btn-cancel\" @click=\"isTicketTipOpen = !isTicketTipOpen\">{{ $t('Cancel') }}</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</transition>\r\n\r\n    <!-- 彈窗 -->\r\n    <transition name=\"fade\">\r\n      <model v-if=\"isOpen\"></model>\r\n    </transition>\r\n    <transition name=\"fade\">\r\n      <div class=\"fancyBox\" v-if=\"isOpen\">\r\n        <span>{{ callBackMsg }}!</span>\r\n        <div class=\"fancy-box-btn-wrap\">\r\n          <p class=\"confirmBtn\" @click=\"confirmBtnEvent()\">\r\n            {{ $t(\"Confirm\") }}\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </transition>\r\n</div>\r\n</template>\r\n<script>\r\nimport back from \"@/components/Botton/back.vue\";\r\nimport model from \"@/components/model\";\r\nimport { apiBuyClubActivityTicket, apiUpdateClubActivityStatus, apiGetClubActivityList} from \"@/api/ClubActivitys.js\";\r\nimport { apiGetClubGamblingList, apiUpdateClubGamblingsStatus} from \"@/api/ClubGamblings.js\";\r\nexport default {\r\n  components: {\r\n    back,\r\n    model\r\n  },\r\n  data() {\r\n    return {\r\n      isManagement: 0,\r\n      clubId: undefined,\r\n      isOpen: false,\r\n\r\n      activeCategoryIndex: 0,\r\n      tabIndex: 0,\r\n      betTabIndex: 0,\r\n      latestActivitiesObj: [],\r\n      historyActivitiesObj: [],\r\n      isTicketTipOpen: false,\r\n      ticketTipText:\r\n        \"活动规则：<br />1、胜负的判断：<br />①根据最终比赛结果来判定对应的竞猜胜负<br />②根据本次活动竞猜正确的胜率来判断第一名<br />2、参与规则<br />①参与需缴纳一定金额的门票<br />②购买门票的用户，视作愿意参与活动，门票不予退还<br />3、奖励规则<br />①胜利最高的为第一名，胜率想同的用户并列第一<br />②第一名的用户获得本次活动门票收益,如有多个用户并列第一，则均分本次活动的奖励<br />③奖励的发放在活动结束后的2个工作日内，由系统自动发放奖励<br />活动最终解释权归本APP所有\",\r\n      avtiveId: \"\",\r\n      activeNodata: false,\r\n      historyNoData: false,\r\n      matchName: \"\",\r\n      // 投注活動\r\n      betMyList: [],\r\n      betOtherList: [],\r\n      betMyListNoData: false,\r\n      betOtherListNoData: false,\r\n\r\n      wipeLoading: false,\r\n      callBackMsg: \"\",\r\n    };\r\n  },\r\n  created() {\r\n    // 讀取是否為管理階\r\n    this.isManagement = localStorage.getItem(\"isManagement\");\r\n    // 取得clubId\r\n    this.clubId = localStorage.getItem(\"ClubId\");\r\n\r\n    if (localStorage.getItem(\"activeCategoryIndex\") == null || localStorage.getItem(\"activeCategoryIndex\") == undefined) {\r\n      this.activeCategoryIndex = 0;\r\n      this.tabIndex = 0;\r\n      this.betTabIndex = 0;\r\n      this.getMyClub();\r\n    } else {\r\n      if (localStorage.getItem(\"activeCategoryIndex\") == \"0\") {\r\n        this.getMyClub();\r\n        this.activeCategoryIndex = 0;\r\n        this.tabIndex = localStorage.getItem(\"tabIndex\");\r\n      } else if (localStorage.getItem(\"activeCategoryIndex\") == \"1\") {\r\n        this.activeCategoryIndex = 1;\r\n        this.getActiveBetList();\r\n        this.betTabIndex = localStorage.getItem(\"betTabIndex\");\r\n      }\r\n    }\r\n\r\n  },\r\n  methods: {\r\n    // 獲取會員俱樂部資訊\r\n    getMyClub() {\r\n      let data = {\r\n        ClubId: this.clubId\r\n      }\r\n      apiGetClubActivityList(data, true).then(res => {\r\n        if (res.Code == \"600\") {\r\n          this.isOpen = true;\r\n          this.callBackMsg = res.Message;\r\n          return;\r\n        }\r\n        // 俱樂部活動頁的資料\r\n        this.latestActivitiesObj = res.Success.LatestClubActivity.ClubActivity;\r\n        this.historyActivitiesObj = res.Success.ClubActivitys;\r\n      })\r\n      this.tabIndex = 0;\r\n      localStorage.setItem(\"activeCategoryIndex\", this.activeCategoryIndex);\r\n    },\r\n\r\n    // 取得俱樂部投注列表\r\n    getActiveBetList() {\r\n      let data = {\r\n        ClubId: this.clubId\r\n      };\r\n      apiGetClubGamblingList(data, true).then(res => {\r\n        this.betMyList = res.Data.MyGamblings;\r\n        this.betOtherList = res.Data.OtherGamblings;\r\n        if (this.betMyList == null || this.betMyList.length == 0) {\r\n          this.betMyListNoData = true;\r\n        }\r\n        if (this.betOtherList == null || this.betOtherList.length == 0) {\r\n          this.betOtherListNoData = true;\r\n        }\r\n      });\r\n       this.betTabIndex = 0;\r\n      localStorage.setItem(\"activeCategoryIndex\", this.activeCategoryIndex);\r\n    },\r\n\r\n    // 切換俱樂部挑戰分頁\r\n    changeTabIndex(index) {\r\n      this.tabIndex = index;\r\n      localStorage.setItem(\"tabIndex\", index);\r\n    },\r\n    // 切換俱樂部投注分頁\r\n    changeBetTabIndex(index) {\r\n      this.betTabIndex = index;\r\n      localStorage.setItem(\"betTabIndex\", index);\r\n    },\r\n\r\n    // 活動開啟發佈頁面\r\n    activesRelease() {\r\n      this.$router.push('/ClubActivitiesRelease');\r\n    },\r\n\r\n    // 購買活動門票\r\n    getTicket() {\r\n      let data = {\r\n        ClubId: this.clubId,\r\n        ClubActivityId: this.avtiveId\r\n      };\r\n      apiBuyClubActivityTicket(data, true).then(res => {\r\n        if (res.Code == 600) {\r\n          let vm = this;\r\n          const m = vm.$message({\r\n            message: res.Message,\r\n            duration: 3000,\r\n            type: \"error\",\r\n            center: true\r\n          });\r\n          setTimeout(() => m.close(), 2000);\r\n          return;\r\n        }\r\n        localStorage.setItem(\"AcvtiveId\", this.avtiveId);\r\n        let vm = this;\r\n        const m = vm.$message({\r\n          message: this.$t('SuccessfulPurchase'),\r\n          duration: 3000,\r\n          type: \"success\",\r\n          center: true\r\n        });\r\n        setTimeout(() => m.close(), 2000);\r\n        setTimeout(() => {\r\n          this.isTicketTipOpen = false;\r\n          this.$router.push(\"/ClubActivityMatch\");\r\n        }, 3000);\r\n      });\r\n    },\r\n\r\n    // 繼續下注\r\n    continueBet(avtiveId) {\r\n      localStorage.setItem(\"AcvtiveId\", avtiveId);\r\n      this.$router.push(\"/ClubActivityMatch\");\r\n    },\r\n\r\n    // 參加成功\r\n    goResultDetail(avtiveId){\r\n      localStorage.setItem(\"AcvtiveId\", avtiveId);\r\n      this.$router.push(\"/ActivityMatchResultDetail\");\r\n    },\r\n\r\n    // 刪除最新活動\r\n    deleteActive(item){\r\n      let data = {\r\n          Id: item.Id,\r\n          ClubId: item.ClubId,\r\n          SelectLeague: item.SelectLeague,\r\n          MatchIds: item.MatchIds,\r\n          PlayIds: item.PlayIds,\r\n          ActivityContent: item.ActivityContent,\r\n          NumGames: item.NumGames,\r\n          ActivityImg: item.ActivityImg,\r\n          SumBonus: item.SumBonus,\r\n          Status: -1,\r\n          Stime: item.Stime,\r\n          Etime: item.Etime,\r\n          CreateTime: item.CreateTime,\r\n          Creator: item.Creator,\r\n      };\r\n      apiUpdateClubActivityStatus(data, true).then(res => {\r\n        if (res.Success) {\r\n          let vm = this;\r\n          const m = vm.$message({\r\n            message: this.$t('successfullyDeleted'),\r\n            duration: 3000,\r\n            type: \"success\",\r\n            center: true\r\n          });\r\n          setTimeout(() => m.close(), 2000);\r\n          this.getMyClub();\r\n        } else {\r\n          let vm = this;\r\n          const x = vm.$message({\r\n            message: res.Message,\r\n            duration: 3000,\r\n            type: \"warning\",\r\n            center: true\r\n          });\r\n          setTimeout(() => x.close(), 2000);\r\n        }\r\n      });\r\n    },\r\n\r\n    // 查看單一賽果 type:  1 = 發起人賽果;  2 = 其他人賽果\r\n    goBetResult(type, id) {\r\n      localStorage.setItem(\"betId\", id);\r\n      localStorage.setItem(\"singleResult\", true)\r\n      if (type == 1) {\r\n        setTimeout(() => {\r\n          this.$router.push(\"/InitiatorBetResult\");\r\n        }, 250);\r\n      } else {\r\n        setTimeout(() => {\r\n          this.$router.push(\"/BetResult\");\r\n        }, 250);\r\n      }\r\n    },\r\n\r\n    // 俱樂部投注刪除\r\n    betDelete(item) {\r\n      let data = {\r\n        Id: item.Id,\r\n        ClubId: item.ClubId,\r\n        MatchId: item.MatchId,\r\n        MatchItemId: item.MatchItemId,\r\n        PlayId: item.PlayId,\r\n        BetPosition: item.BetPosition,\r\n        OddsValue: item.OddsValue,\r\n        GamblingTitle: item.GamblingTitle,\r\n        GamblingContent: item.GamblingContent,\r\n        GamblingImg: item.GamblingImg,\r\n        Deposit: item.Deposit,\r\n        OpenBetAmount: item.OpenBetAmount,\r\n        BettedAmount: item.BettedAmount,\r\n        HandlingCharge: item.HandlingCharge,\r\n        Status: -1,\r\n        Stime: item.Stime,\r\n        Etime: item.Etime,\r\n        CreateTime: item.CreateTime,\r\n        Creator: item.Creator\r\n      }\r\n      apiUpdateClubGamblingsStatus(data, true).then(res => {\r\n        if(res.Success) {\r\n          let vm = this;\r\n          const m = vm.$message({\r\n            message: this.$t('successfullyDeleted'),\r\n            duration: 3000,\r\n            type: \"success\",\r\n            center: true\r\n          });\r\n          setTimeout(() => m.close(), 2000);\r\n          // 再獲取一次列表\r\n          this.getActiveBetList();\r\n          return;\r\n        } \r\n        if (res.Code == 600) {\r\n          let vm = this;\r\n          const m = vm.$message({\r\n            message: res.Message,\r\n            duration: 3000,\r\n            type: \"warning\",\r\n            center: true\r\n          });\r\n          setTimeout(() => m.close(), 2000);\r\n          return;\r\n        }\r\n        if (res.Data.Item1 == false) {\r\n          let vm = this;\r\n          const m = vm.$message({\r\n            message: this.$t(\"DataError\"),\r\n            duration: 3000,\r\n            type: \"warning\",\r\n            center: true\r\n          });\r\n          setTimeout(() => m.close(), 2000);\r\n          return;\r\n        }\r\n\r\n      });\r\n    },\r\n\r\n    // 彈窗確認按鈕事件\r\n    confirmBtnEvent() {\r\n      this.$router.push(\"/CreateClub\");\r\n    },\r\n  }\r\n};\r\n</script>\r\n"]}]}