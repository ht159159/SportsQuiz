{"remainingRequest":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\work\\竞猜可换色板\\src\\views\\Home.vue?vue&type=style&index=0&id=fae5bece&scoped=true&lang=css&","dependencies":[{"path":"C:\\work\\竞猜可换色板\\src\\views\\Home.vue","mtime":1605074743468},{"path":"C:\\work\\竞猜可换色板\\node_modules\\@vue\\cli-service\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.mask{\n  position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    background: #080808c4;\n    z-index: 9998;\n}\n.d1 {\n      text-align: center;\n    position: absolute;\n    top: 40%;\n    left: 50%;\n    -webkit-transform: translate(-50%, -50%);\n    transform: translate(-50%, -50%);\n    z-index: 99999;\n    width: 80%;\n    height: 110px;\n    color: #3f4b50;\n    background: #ffffff;\n    padding: 55px;\n    border-radius: 15px;\n}\n.d2 {\n    text-align: center;\n    position: absolute;\n    top: 20%;\n    left: 50%;\n    font-size: .3rem;\n    color: #3f4b50;\n    -webkit-transform: translate(-50%, -50%);\n    transform: translate(-50%, -50%);\n    z-index: 99999;\n\n}\nprogress {\n  height: 8px;\n    border-radius: 0.25rem;\n    width: 100%;\n}\nprogress::-webkit-progress-bar {\n  background-color: #f2f2f2;\n  border-radius: 0.25rem;\n}\nprogress::-webkit-progress-value {\n  height: 8px;\n    border-radius: 0.25rem;\n    width: 100%;\n  background: linear-gradient(to right, #632891, #00ffcb);\n}\n",{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <main class=\"main mainHome\">\n    <card-comp></card-comp>\n    <modal-sign-in :showModal.sync=\"isSignIn\"></modal-sign-in>\n    <!-- <card-foot></card-foot> -->\n    <!-- 下面的组件 -->\n    <div class=\"mask\" id=\"dMask\" style=\"display: none;\"></div>\n    <div id=\"d1\" class=\"d1\" style=\"display: none;\">\n      <div class=\"d2\">APP更新中</div>\n      <p id=\"pgv\">进度：0%</p>\n      <progress id=\"pg\" max=\"100\" value=\"0\"></progress>\n    </div>\n  </main>\n</template>\n\n<script>\nimport CardComp from \"@/components/MainGame.vue\";\nimport CardFoot from \"@/components/MoreGame.vue\";\nimport \"../style/addtohomescreen.css\";\n\nimport ModalSignIn from \"@/components/Modal/SignIn.vue\";\nexport default {\n  name: \"mainHome\",\n  components: {\n    ModalSignIn,\n    CardComp,\n    CardFoot\n  },\n  created() {\n    if (window.plus) {\n      this.checkUpdate();\n    } else {\n      document.addEventListener(\"plusready\", this.checkUpdate, false);\n    }\n  },\n  data() {\n    return {\n      isSignIn: false,\n      isLogin: false\n    };\n  },\n  methods: {\n    checkUpdate() {\n      var vm = this;\n      // 检查当前版本，与从后台获取的版本作比较，以此判断是否更新\n      plus.runtime.getProperty(plus.runtime.appid, function(inf) {\n        // 当前版本\n        var wgtVersion = inf.version;\n        var xhr = new plus.net.XMLHttpRequest();\n        xhr.onreadystatechange = function() {\n          switch (xhr.readyState) {\n            case 0:\n              //alert( \"xhr请求已初始化\" );\n              break;\n            case 1:\n              //alert( \"xhr请求已打开\" );\n              break;\n            case 2:\n              //alert( \"xhr请求已发送\" );\n              break;\n            case 3:\n              //alert( \"xhr请求已响应\");\n              break;\n            case 4:\n              if (xhr.status == 200) {\n                //alert( \"xhr请求成功：\"+xhr.responseText );\n                //alert(\"服务器端版本：\" + JSON.parse(xhr.responseText).version);\n                var data = JSON.parse(xhr.responseText);\n                // 如果有新版本，则提示需要更新\n                if (data.version > wgtVersion) {\n                  //alert(\"本地版本：\" + wgtVersion);\n                  plus.nativeUI.confirm(\n                    \"发现新版本，是否更新？\\r\\n更新说明：\" + data.comment,\n                    function(e) {\n                      if (e.index == 0) {\n                        vm.downloadWgt(data.url, data.version); // 下载wgt方法\n                      } else {\n                        return;\n                      }\n                    },\n                    [\"确定\", \"取消\"]\n                  );\n                } else {\n                  return;\n                }\n              } else {\n                alert(\"xhr请求失败：\" + xhr.readyState);\n              }\n              break;\n            default:\n              break;\n          }\n        };\n        xhr.open(\n          \"GET\",\n          \"https://guess-color.linsio.cn/app/check.json?t=\" +\n            new Date().getTime()\n        );\n        xhr.send();\n      });\n    },\n    closeMask(){\n          document.getElementById(\"d1\").style.display = \"none\";\n          document.getElementById(\"dMask\").style.display = \"none\";\n    },\n\n    // 下载wgt方法\n    downloadWgt(url, version) {\n      var vm = this;\n      // 更新文件 wgt 文件地址\n      var wgtUrl = url + \"?v=\" + version;\n      //plus.nativeUI.showWaiting(\"正在更新...\");\n      var downTask = plus.downloader.createDownload(\n        wgtUrl,\n        { filename: \"_doc/update/\" },\n        function(d, status) {\n          if (status == 200) {\n            //console.log(\"下载更新包成功：\" + d.filename);\n            vm.installWgt(d.filename); // 安装wgt方法\n          } else {\n            //console.log(\"下载更新包失败！\");\n            plus.nativeUI.alert(\"下载更新包失败！\", function(){\n                vm.closeMask();\n            });\n          }\n          //plus.nativeUI.closeWaiting();\n        }\n      );\n\n      downTask.start(); // 开启下载的任务\n\n      var prg = 0;\n      //var showLoading = plus.nativeUI.showWaiting(\"正在下载\");  //创建一个showWaiting对象\n      downTask.addEventListener(\"statechanged\", function(task, status) {\n        //给下载任务设置一个监听 并根据状态  做操作\n        switch (task.state) {\n          case 1:\n            //showLoading.setTitle(\"正在连接到服务器\");\n            break;\n          case 2:\n            //showLoading.setTitle(\"已连接到服务器\");\n            break;\n          case 3:\n            prg = parseInt(\n              (parseFloat(task.downloadedSize) / parseFloat(task.totalSize)) *\n                100\n            );\n            //if(prg % 10 == 0) {  // 让百分比 10% 增长，如果这里不这么处理  出现 堆栈内存溢出的问题，有知道原因的大神指导一下哈\n            //\tshowLoading.setTitle(\"更新文件已下载\" + prg + \"%\");\n            //}\n\n            document.getElementById(\"d1\").style.display = \"block\";\n            document.getElementById(\"dMask\").style.display = \"block\";\n            var pg = document.getElementById(\"pg\");\n            var pgv = document.getElementById(\"pgv\");\n            var timer = setInterval(function() {\n              if (prg !== 100) {\n                pg.value = prg;\n                pgv.innerHTML = \"进度：\" + prg + \"%\";\n              } else {\n                pgv.innerHTML = \"APP更新包下载完成\";\n                clearInterval(timer);\n              }\n            }, 100);\n            break;\n          case 4:\n            //plus.nativeUI.closeWaiting();\n            break;\n        }\n      });\n    },\n\n    // 安装wgt方法\n    installWgt(path) {\n      //plus.nativeUI.showWaiting(\"安装更新包文件...\");\n      plus.runtime.install(\n        path,\n        {},\n        function() {\n          //plus.nativeUI.closeWaiting();\n          //console.log(\"安装更新包文件成功！\");\n          plus.nativeUI.alert(\"APP资源更新完成！\", function() {\n            plus.runtime.restart();\n          });\n        },\n        function(e) {\n          //plus.nativeUI.closeWaiting();\n          //console.log(\"安装更新包文件失败[\" + e.code + \"]：\" + e.message);\n          plus.nativeUI.alert(\n            \"安装更新包文件失败[\" + e.code + \"]：\" + e.message,function(){\n              plus.runtime.restart();\n            }\n          );\n        }\n      );\n    },\n\n    clearcaches() {\n      plus.cache.calculate(function(size) {\n        //console.log(\"您目前的系统缓存为\" + parseFloat(size / (1024 * 1024)).toFixed(2) + \"M？\")\n        sizeCache = size;\n        plus.nativeUI.confirm(\n          \"您目前的系统缓存为\" +\n            parseFloat(sizeCache / (1024 * 1024)).toFixed(2) +\n            \"M？\",\n          function(e) {\n            if (e.index == 1) {\n            } else {\n              plus.cache.clear(function() {\n                alert(\"缓存清除完毕\");\n                plus.runtime.restart();\n              });\n            }\n          },\n          \"清除缓存\",\n          [\"确认\", \"取消\"]\n        );\n      });\n    }\n  }\n};\n</script>\n\n<style scoped>\n.mask{\n  position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    background: #080808c4;\n    z-index: 9998;\n}\n.d1 {\n      text-align: center;\n    position: absolute;\n    top: 40%;\n    left: 50%;\n    -webkit-transform: translate(-50%, -50%);\n    transform: translate(-50%, -50%);\n    z-index: 99999;\n    width: 80%;\n    height: 110px;\n    color: #3f4b50;\n    background: #ffffff;\n    padding: 55px;\n    border-radius: 15px;\n}\n.d2 {\n    text-align: center;\n    position: absolute;\n    top: 20%;\n    left: 50%;\n    font-size: .3rem;\n    color: #3f4b50;\n    -webkit-transform: translate(-50%, -50%);\n    transform: translate(-50%, -50%);\n    z-index: 99999;\n\n}\nprogress {\n  height: 8px;\n    border-radius: 0.25rem;\n    width: 100%;\n}\nprogress::-webkit-progress-bar {\n  background-color: #f2f2f2;\n  border-radius: 0.25rem;\n}\nprogress::-webkit-progress-value {\n  height: 8px;\n    border-radius: 0.25rem;\n    width: 100%;\n  background: linear-gradient(to right, #632891, #00ffcb);\n}\n</style>"]}]}