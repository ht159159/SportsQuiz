{"remainingRequest":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\work\\竞猜可换色板\\src\\views\\club\\InitiateActivities.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\work\\竞猜可换色板\\src\\views\\club\\InitiateActivities.vue","mtime":1603887193021},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport back from \"@/components/Botton/back.vue\";\r\nimport { apiGetClubGamblingMatchInfo, apiAddClubGambling } from \"@/api/ClubGamblings.js\";\r\nexport default {\r\n  components: {\r\n    back\r\n  },\r\n  data() {\r\n    return {\r\n      betObj: [],\r\n      oddsIndex: undefined,\r\n      // 發起賠率文字\r\n      betInfo: 0,\r\n      // 賠率\r\n      betNum: 0,\r\n      // 押金\r\n      deposit: \"\",\r\n      // 預計盈利\r\n      expectedProfit: 0,\r\n      // 手續費\r\n      handlingCharge: 0,\r\n      chargeThreshold: undefined, // 手續費判斷標準\r\n      uName: \"\",\r\n      clubId: undefined,\r\n      matchItemId: undefined,\r\n      playId: undefined,\r\n      betPosition: \"\",\r\n      isBetNum: false,\r\n      isDeposit: false,\r\n      isClickTwice: false,\r\n    };\r\n  },\r\n    watch: {\r\n    betNum: function() {\r\n      this.validateBetNum();\r\n    },\r\n    betInfo: function() {\r\n      this.expectedProfit = (this.deposit * this.betNum).toFixed(2);\r\n    },\r\n    deposit: function() {\r\n      this.expectedProfit = (this.deposit * this.betNum).toFixed(2);\r\n    },\r\n  },\r\n  created() {\r\n    this.getMatchItemId().then(() => {\r\n      this.getMatchInfo();\r\n    })\r\n  },\r\n  methods: {\r\n    // 讀取matchItemId\r\n    async getMatchItemId() {\r\n      this.uName = localStorage.getItem(\"uname\");\r\n      this.clubId = localStorage.getItem(\"ClubId\");\r\n      this.matchItemId = localStorage.getItem(\"matchItemId\");\r\n    },\r\n\r\n    // 取得發起活動的賽事資訊\r\n    async getMatchInfo() {\r\n      let data = {\r\n        MatchItemId: this.matchItemId\r\n      };\r\n      await apiGetClubGamblingMatchInfo(data, true).then(res => {\r\n        this.betObj = res.Data;\r\n      });\r\n    },\r\n    // 選擇勝平負\r\n    clickOdds(num, item) {\r\n      this.oddsIndex = num;\r\n      this.betNum = item.OddsValue;\r\n      this.betInfo = item.Position + item.OddsValue; // 發起賠率input值\r\n      \r\n      this.playId = item.PlayId;\r\n      this.betPosition = item.Position;\r\n      if(this.deposit == 0) {\r\n        this.isDeposit = true;\r\n      }\r\n    },\r\n\r\n    // 驗證發起賠率\r\n    validateBetNum() {\r\n      if (this.betNum <= this.betObj.MaxOddsValue && this.betNum >= this.betObj.MinOddsValue) {\r\n        this.expectedProfit = (this.deposit / this.betNum).toFixed(2);\r\n        this.isBetNum = false;\r\n      } else {\r\n        this.betNum = 0;\r\n        this.isBetNum = true;\r\n      }\r\n    },\r\n\r\n    // 驗證押金\r\n    validateDeposit() {\r\n      console.log('das')\r\n      if (this.deposit <= this.betObj.MaxDeposit && this.deposit >= this.betObj.MinDeposit) {\r\n        this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2);\r\n        // 計算手續費\r\n        this.getHandlingCharge();\r\n        this.isDeposit = false;\r\n      } else {\r\n        this.deposit = 0;\r\n        this.handlingCharge = 0;\r\n        this.isDeposit = true;\r\n      }\r\n    },\r\n\r\n    // 手續費\r\n    getHandlingCharge() {\r\n      if (this.deposit >= this.betObj.ChargeThreshold) {\r\n        this.handlingCharge = this.deposit * this.betObj.HandlingCharge;\r\n      } else {\r\n        this.handlingCharge = this.betObj.FixedHandlingCharge;\r\n      }\r\n    },\r\n\r\n    // 發起\r\n    initiate() {\r\n      if (this.isBetNum == true || this.isDeposit == true || this.betNum == 0 || this.deposit == 0) {\r\n        let vm = this;\r\n        const m = vm.$message({\r\n          message: this.$t('EnterCorrectValue'),\r\n          duration: 3000,\r\n          type: \"error\",\r\n          center: true\r\n        });\r\n        setTimeout(() => m.close(), 2000);\r\n        return;\r\n      } else {\r\n        if (this.isClickTwice == false) {\r\n          let data = {\r\n            ClubId: this.clubId,\r\n            MatchItemId: this.matchItemId,\r\n            PlayId: this.playId,\r\n            BetPosition: this.betPosition,\r\n            HandlingCharge: this.handlingCharge,\r\n            OddsValue: this.betNum,\r\n            Deposit: this.deposit,\r\n            UName: this.uName\r\n          };\r\n          apiAddClubGambling(data, true).then(res => {\r\n            if (res.Data) {\r\n              let vm = this;\r\n              const m = vm.$message({\r\n                message: res.Data.Item2,\r\n                duration: 3000,\r\n                type: \"success\",\r\n                center: true\r\n              });\r\n              setTimeout(() => {\r\n                m.close();\r\n                this.$router.go(-1);\r\n              }, 2000);\r\n            } else {\r\n              let vm = this;\r\n              const m = vm.$message({\r\n                message: res.Message,\r\n                duration: 3000,\r\n                type: \"error\",\r\n                center: true\r\n              });\r\n              setTimeout(() => m.close(), 2000);\r\n            }\r\n          });\r\n          this.isClickTwice = true;\r\n        }\r\n      }\r\n    }\r\n  },\r\n};\r\n",{"version":3,"sources":["InitiateActivities.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"InitiateActivities.vue","sourceRoot":"src/views/club","sourcesContent":["<template>\r\n  <div class=\"initiate-activities\">\r\n    <div class=\"initiate-activities-header\">\r\n      <div class=\"initiate-activities-header-wrap\">\r\n        <back class=\"back-icon img-he\"></back>\r\n        <h3>{{ $t(\"Initiateactivities\") }}</h3>\r\n        <!--发起活动-->\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"initiate-activities-content\">\r\n      <div class=\"initiate-activities-vsImg\">\r\n        <div class=\"initiate-activities-vsImg-top\">\r\n          <div class=\"initiate-activities-vsImg-box\">\r\n            <img :src=\"betObj.HomeTeamImg\" />\r\n            <p>{{ betObj.HomeTeam }}</p>\r\n          </div>\r\n          <div class=\"initiate-activities-vs\">VS</div>\r\n          <div class=\"initiate-activities-vsImg-box\">\r\n            <img :src=\"betObj.AwayTeamImg\" />\r\n            <p>{{ betObj.AwayTeam }}</p>\r\n          </div>\r\n        </div>\r\n        <div class=\"initiate-activities-vsImg-bottom-wrap\">\r\n          <div class=\"initiate-activities-odds-btn\" :class=\"{ 'odds-btn-focus': oddsIndex == index }\" @click=\"clickOdds(index, item)\" v-for=\"(item, index) in betObj.PlayList\">\r\n            {{ item.Position }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"bet-block\">\r\n        <div class=\"bet-block-box\">\r\n          <div class=\"bet-block-box-title\">{{ $t('RecommendedOdds') }}</div><!--推荐赔率-->\r\n          <div class=\"odds-wrap\">\r\n            <div class=\"odds\" v-for=\"(item, index) in betObj.PlayList\">\r\n              <p>{{ item.Position }}</p>\r\n              <p class=\"blue\">{{ item.OddsValue }}</p>\r\n            </div>\r\n            <!-- <div class=\"odds\">\r\n              <p>{{ betObj.tieOdds }}</p>\r\n              <p class=\"blue\">{{ betObj.awayOoddNum }}</p>\r\n            </div>\r\n            <div class=\"odds\">\r\n              <p>{{ betObj.awayOdds }}</p>\r\n              <p class=\"blue\">{{ betObj.tieOddNum }}</p>\r\n            </div> -->\r\n          </div>\r\n        </div>\r\n        <div class=\"bet-block-box\">\r\n          <div class=\"bet-block-box-title\">\r\n            <p>{{ $t('InitiationOdds') }}</p><!--发起赔率-->\r\n            <div class=\"alerts\" v-if=\"isBetNum\">( {{ $t('OddsRange') }}{{betObj.MinOddsValue}}~{{betObj.MaxOddsValue}} )</div><!--賠率範圍-->\r\n          </div>\r\n          <el-input type=\"number\" v-model=\"betNum\" @blur=\"validateBetNum\" :placeholder='$t(\"PleaseEnterTheOdds\")'></el-input>\r\n        </div>\r\n        <div class=\"bet-block-box\">\r\n          <div class=\"bet-block-box-title\">\r\n            <p>{{ $t('CashPledge') }}</p><!--押金-->\r\n            <div class=\"alerts\" v-if=\"isDeposit\">( {{ $t('DepositRange') }}{{betObj.MinDeposit}}~{{betObj.MaxDeposit}} )</div><!--押金範圍-->\r\n          </div>\r\n          <!-- <input type=\"text\" v-model=\"deposit\" /> -->\r\n          <el-input type=\"number\" v-model=\"deposit\" @change=\"validateDeposit\" :placeholder=\"$t('EnterDeposit')\"></el-input>\r\n        </div>\r\n        <div class=\"bet-block-box\">\r\n          <div class=\"bet-block-box-title\">{{ $t(\"ExpectedProfit\") }}</div><!--预计盈利-->\r\n          <input type=\"text\" v-model=\"expectedProfit\" disabled=\"disabled\"/>\r\n        </div>\r\n        <div class=\"bet-block-box\">\r\n          <div class=\"bet-block-box-title\">{{ $t('HandlingCharge') }}</div><!--手续费-->\r\n          <input type=\"text\" v-model=\"handlingCharge\" disabled=\"disabled\"/>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"initiate-activities-btn\" @click=\"initiate()\">{{ $t(\"Confirm\") }}</div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport back from \"@/components/Botton/back.vue\";\r\nimport { apiGetClubGamblingMatchInfo, apiAddClubGambling } from \"@/api/ClubGamblings.js\";\r\nexport default {\r\n  components: {\r\n    back\r\n  },\r\n  data() {\r\n    return {\r\n      betObj: [],\r\n      oddsIndex: undefined,\r\n      // 發起賠率文字\r\n      betInfo: 0,\r\n      // 賠率\r\n      betNum: 0,\r\n      // 押金\r\n      deposit: \"\",\r\n      // 預計盈利\r\n      expectedProfit: 0,\r\n      // 手續費\r\n      handlingCharge: 0,\r\n      chargeThreshold: undefined, // 手續費判斷標準\r\n      uName: \"\",\r\n      clubId: undefined,\r\n      matchItemId: undefined,\r\n      playId: undefined,\r\n      betPosition: \"\",\r\n      isBetNum: false,\r\n      isDeposit: false,\r\n      isClickTwice: false,\r\n    };\r\n  },\r\n    watch: {\r\n    betNum: function() {\r\n      this.validateBetNum();\r\n    },\r\n    betInfo: function() {\r\n      this.expectedProfit = (this.deposit * this.betNum).toFixed(2);\r\n    },\r\n    deposit: function() {\r\n      this.expectedProfit = (this.deposit * this.betNum).toFixed(2);\r\n    },\r\n  },\r\n  created() {\r\n    this.getMatchItemId().then(() => {\r\n      this.getMatchInfo();\r\n    })\r\n  },\r\n  methods: {\r\n    // 讀取matchItemId\r\n    async getMatchItemId() {\r\n      this.uName = localStorage.getItem(\"uname\");\r\n      this.clubId = localStorage.getItem(\"ClubId\");\r\n      this.matchItemId = localStorage.getItem(\"matchItemId\");\r\n    },\r\n\r\n    // 取得發起活動的賽事資訊\r\n    async getMatchInfo() {\r\n      let data = {\r\n        MatchItemId: this.matchItemId\r\n      };\r\n      await apiGetClubGamblingMatchInfo(data, true).then(res => {\r\n        this.betObj = res.Data;\r\n      });\r\n    },\r\n    // 選擇勝平負\r\n    clickOdds(num, item) {\r\n      this.oddsIndex = num;\r\n      this.betNum = item.OddsValue;\r\n      this.betInfo = item.Position + item.OddsValue; // 發起賠率input值\r\n      \r\n      this.playId = item.PlayId;\r\n      this.betPosition = item.Position;\r\n      if(this.deposit == 0) {\r\n        this.isDeposit = true;\r\n      }\r\n    },\r\n\r\n    // 驗證發起賠率\r\n    validateBetNum() {\r\n      if (this.betNum <= this.betObj.MaxOddsValue && this.betNum >= this.betObj.MinOddsValue) {\r\n        this.expectedProfit = (this.deposit / this.betNum).toFixed(2);\r\n        this.isBetNum = false;\r\n      } else {\r\n        this.betNum = 0;\r\n        this.isBetNum = true;\r\n      }\r\n    },\r\n\r\n    // 驗證押金\r\n    validateDeposit() {\r\n      console.log('das')\r\n      if (this.deposit <= this.betObj.MaxDeposit && this.deposit >= this.betObj.MinDeposit) {\r\n        this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2);\r\n        // 計算手續費\r\n        this.getHandlingCharge();\r\n        this.isDeposit = false;\r\n      } else {\r\n        this.deposit = 0;\r\n        this.handlingCharge = 0;\r\n        this.isDeposit = true;\r\n      }\r\n    },\r\n\r\n    // 手續費\r\n    getHandlingCharge() {\r\n      if (this.deposit >= this.betObj.ChargeThreshold) {\r\n        this.handlingCharge = this.deposit * this.betObj.HandlingCharge;\r\n      } else {\r\n        this.handlingCharge = this.betObj.FixedHandlingCharge;\r\n      }\r\n    },\r\n\r\n    // 發起\r\n    initiate() {\r\n      if (this.isBetNum == true || this.isDeposit == true || this.betNum == 0 || this.deposit == 0) {\r\n        let vm = this;\r\n        const m = vm.$message({\r\n          message: this.$t('EnterCorrectValue'),\r\n          duration: 3000,\r\n          type: \"error\",\r\n          center: true\r\n        });\r\n        setTimeout(() => m.close(), 2000);\r\n        return;\r\n      } else {\r\n        if (this.isClickTwice == false) {\r\n          let data = {\r\n            ClubId: this.clubId,\r\n            MatchItemId: this.matchItemId,\r\n            PlayId: this.playId,\r\n            BetPosition: this.betPosition,\r\n            HandlingCharge: this.handlingCharge,\r\n            OddsValue: this.betNum,\r\n            Deposit: this.deposit,\r\n            UName: this.uName\r\n          };\r\n          apiAddClubGambling(data, true).then(res => {\r\n            if (res.Data) {\r\n              let vm = this;\r\n              const m = vm.$message({\r\n                message: res.Data.Item2,\r\n                duration: 3000,\r\n                type: \"success\",\r\n                center: true\r\n              });\r\n              setTimeout(() => {\r\n                m.close();\r\n                this.$router.go(-1);\r\n              }, 2000);\r\n            } else {\r\n              let vm = this;\r\n              const m = vm.$message({\r\n                message: res.Message,\r\n                duration: 3000,\r\n                type: \"error\",\r\n                center: true\r\n              });\r\n              setTimeout(() => m.close(), 2000);\r\n            }\r\n          });\r\n          this.isClickTwice = true;\r\n        }\r\n      }\r\n    }\r\n  },\r\n};\r\n</script>\r\n"]}]}