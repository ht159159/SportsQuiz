{"remainingRequest":"C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\src\\api\\api.config.js","dependencies":[{"path":"C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\src\\api\\api.config.js","mtime":1606096431727},{"path":"C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import axios from \"axios\";\nimport { showFullScreenLoading, tryHideFullScreenLoading } from \"./loading\";\nimport router from \"../router\";\nimport { MessageBox } from \"element-ui\";\nimport { apiLogin, apiRefreshToken } from \"@/api/User\";\nimport i18n from \"@/lang\"; // 語言切換\n\nfunction debounce(fn, wait) {\n  var timerId = null;\n  var flag = true;\n  return function () {\n    clearTimeout(timerId);\n\n    if (flag) {\n      fn.apply(this, arguments);\n      flag = false;\n    }\n\n    timerId = setTimeout(function () {\n      flag = true;\n    }, wait);\n  };\n}\n\nvar authError = debounce(function (message) {\n  localStorage.removeItem(\"token\");\n  MessageBox.alert(i18n.t(\"LoginTimedOutPrompt\"), i18n.t(\"LoginTimeout\"), {\n    // center: true,\n    confirmButtonText: i18n.t(\"JumpToLoginPage\"),\n    callback: function callback(action) {\n      router.push(\"/\");\n    }\n  });\n}, 1000);\nvar service = axios.create({\n  baseURL: process.env.VUE_APP_API_BASE_URL,\n  timeout: 5000,\n  headers: {\n    \"content-type\": \"application/json\"\n  }\n}); // axios攔截器設定\n\nservice.interceptors.request.use(function (config) {\n  // if (!config.noLoading) {\n  //   // 不需要loading畫面\n  // }\n  // showFullScreenLoading()\n  // 語言\n  config.headers[\"Accept-Language\"] = JSON.parse(localStorage.getItem(\"lang\")).tag;\n  return config;\n}, function (error) {\n  return Promise.reject(error);\n}); // axios攔截器設定\n\nservice.interceptors.response.use(function (response) {\n  if (response.data.result === 0) {\n    Message.error(response.data.message);\n  } // tryHideFullScreenLoading()\n\n\n  return response.data;\n}, function (error) {\n  if (error.response.status === 401) {\n    // localStorage.removeItem(\"token\");\n    // MessageBox.alert(\"登录信息超时,请重新登录\", \"登录超时\", {\n    //   // center: true,\n    //   confirmButtonText: \"跳转到登录页\",\n    //   callback: action => {\n    //     router.push(\"/\");\n    //   }\n    // });\n    authError();\n  }\n\n  Promise.reject(error);\n});\n/**\r\n * @param url api網址\r\n * @param data 資料\r\n * @param needAuth 是否需要送token\r\n * @param noLoaging 是否需要loading\r\n */\n\nexport function post(url, data, needAuth) {\n  var noLoaging = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n\n  if (needAuth) {\n    return service.post(url, data, {\n      noLoaging: noLoaging,\n      headers: {\n        authorization: \"Bearer \" + localStorage.token\n      }\n    });\n  } else {\n    return service.post(url, data);\n  }\n}\n/**\r\n * @param url api網址\r\n * @param params 資料\r\n * @param needAuth 是否需要送token\r\n */\n\nexport function get(url, params, needAuth) {\n  if (needAuth) {\n    return service.get(url, {\n      params: params,\n      headers: {\n        authorization: \"Bearer \" + localStorage.token\n      }\n    });\n  } else {\n    return service.get(url, {\n      params: params\n    });\n  }\n}",{"version":3,"sources":["C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\src\\api\\api.config.js"],"names":["axios","showFullScreenLoading","tryHideFullScreenLoading","router","MessageBox","apiLogin","apiRefreshToken","i18n","debounce","fn","wait","timerId","flag","clearTimeout","apply","arguments","setTimeout","authError","message","localStorage","removeItem","alert","t","confirmButtonText","callback","action","push","service","create","baseURL","process","env","VUE_APP_API_BASE_URL","timeout","headers","interceptors","request","use","config","JSON","parse","getItem","tag","error","Promise","reject","response","data","result","Message","status","post","url","needAuth","noLoaging","authorization","token","get","params"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport { showFullScreenLoading, tryHideFullScreenLoading } from \"./loading\";\r\nimport router from \"../router\";\r\nimport { MessageBox } from \"element-ui\";\r\nimport { apiLogin, apiRefreshToken } from \"@/api/User\";\r\nimport i18n from \"@/lang\"; // 語言切換\r\n\r\nfunction debounce(fn, wait) {\r\n  let timerId = null;\r\n  let flag = true;\r\n  return function() {\r\n    clearTimeout(timerId);\r\n    if (flag) {\r\n      fn.apply(this, arguments);\r\n      flag = false;\r\n    }\r\n    timerId = setTimeout(() => {\r\n      flag = true;\r\n    }, wait);\r\n  };\r\n}\r\n\r\nconst authError = debounce(message => {\r\n  localStorage.removeItem(\"token\");\r\n\r\n  MessageBox.alert(i18n.t(\"LoginTimedOutPrompt\"), i18n.t(\"LoginTimeout\"), {\r\n    // center: true,\r\n\r\n    confirmButtonText: i18n.t(\"JumpToLoginPage\"),\r\n    callback: action => {\r\n      router.push(\"/\");\r\n    }\r\n  });\r\n}, 1000);\r\nlet service = axios.create({\r\n  baseURL: process.env.VUE_APP_API_BASE_URL,\r\n  timeout: 5000,\r\n  headers: {\r\n    \"content-type\": \"application/json\"\r\n  }\r\n});\r\n\r\n// axios攔截器設定\r\nservice.interceptors.request.use(\r\n  config => {\r\n    // if (!config.noLoading) {\r\n    //   // 不需要loading畫面\r\n    // }\r\n    // showFullScreenLoading()\r\n\r\n    // 語言\r\n    config.headers[\"Accept-Language\"] = JSON.parse(\r\n      localStorage.getItem(\"lang\")\r\n    ).tag;\r\n\r\n    return config;\r\n  },\r\n  error => Promise.reject(error)\r\n);\r\n// axios攔截器設定\r\nservice.interceptors.response.use(\r\n  response => {\r\n    if (response.data.result === 0) {\r\n      Message.error(response.data.message);\r\n    }\r\n    // tryHideFullScreenLoading()\r\n    return response.data;\r\n  },\r\n  error => {\r\n    if (error.response.status === 401) {\r\n      // localStorage.removeItem(\"token\");\r\n      // MessageBox.alert(\"登录信息超时,请重新登录\", \"登录超时\", {\r\n      //   // center: true,\r\n      //   confirmButtonText: \"跳转到登录页\",\r\n      //   callback: action => {\r\n      //     router.push(\"/\");\r\n      //   }\r\n      // });\r\n      authError();\r\n    }\r\n\r\n    Promise.reject(error);\r\n  }\r\n);\r\n\r\n/**\r\n * @param url api網址\r\n * @param data 資料\r\n * @param needAuth 是否需要送token\r\n * @param noLoaging 是否需要loading\r\n */\r\nexport function post(url, data, needAuth, noLoaging = true) {\r\n  if (needAuth) {\r\n    return service.post(url, data, {\r\n      noLoaging,\r\n      headers: {\r\n        authorization: \"Bearer \" + localStorage.token\r\n      }\r\n    });\r\n  } else {\r\n    return service.post(url, data);\r\n  }\r\n}\r\n\r\n/**\r\n * @param url api網址\r\n * @param params 資料\r\n * @param needAuth 是否需要送token\r\n */\r\nexport function get(url, params, needAuth) {\r\n  if (needAuth) {\r\n    return service.get(url, {\r\n      params,\r\n      headers: { authorization: \"Bearer \" + localStorage.token }\r\n    });\r\n  } else {\r\n    return service.get(url, { params });\r\n  }\r\n}\r\n"]}]}