{"remainingRequest":"C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\src\\views\\club\\InitiateActivities.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\src\\views\\club\\InitiateActivities.vue","mtime":1606980099218},{"path":"C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Yang\\Desktop\\新增資料夾\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Yang\\\\Desktop\\\\\\u65B0\\u589E\\u8CC7\\u6599\\u593E\\\\\\u7ADE\\u731C\\u53EF\\u6362\\u8272\\u677F\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport back from \"@/components/Botton/back.vue\";\nimport { apiGetClubGamblingMatchInfo, apiAddClubGambling } from \"@/api/ClubGamblings.js\";\nimport model from \"@/components/model\";\nexport default {\n  components: {\n    back: back,\n    model: model\n  },\n  data: function data() {\n    return {\n      betObj: [],\n      oddsIndex: undefined,\n      // 發起賠率文字\n      betInfo: 0,\n      // 賠率\n      betNum: \"\",\n      // 押金\n      deposit: \"\",\n      // 預計盈利\n      expectedProfit: 0,\n      // 手續費\n      handlingCharge: 0,\n      chargeThreshold: undefined,\n      // 手續費判斷標準\n      uName: \"\",\n      clubId: undefined,\n      matchItemId: undefined,\n      playId: undefined,\n      betPosition: \"\",\n      isBetNum: false,\n      isDeposit: false,\n      isClickTwice: false,\n      isFancyBoxOpen: false\n    };\n  },\n  watch: {\n    betNum: function betNum() {\n      this.betNum = this.betNum * 1;\n      this.deposit = this.deposit * 1;\n      this.validateBetNum();\n    },\n    betInfo: function betInfo() {\n      this.betNum = this.betNum * 1;\n      this.deposit = this.deposit * 1;\n      this.betNum - 1 <= 0 ? this.expectedProfit = 0 : this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2); // this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2);\n    },\n    deposit: function deposit() {\n      this.betNum = this.betNum * 1;\n      this.deposit = this.deposit * 1;\n      this.betNum - 1 <= 0 ? this.expectedProfit = 0 : this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2); // this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2);\n\n      this.getHandlingCharge();\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    this.getMatchItemId().then(function () {\n      _this.getMatchInfo();\n    });\n  },\n  methods: {\n    // 讀取matchItemId\n    getMatchItemId: function () {\n      var _getMatchItemId = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.uName = localStorage.getItem(\"uname\");\n                this.clubId = localStorage.getItem(\"ClubId\");\n                this.matchItemId = localStorage.getItem(\"matchItemId\");\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getMatchItemId() {\n        return _getMatchItemId.apply(this, arguments);\n      }\n\n      return getMatchItemId;\n    }(),\n    // 取得發起活動的賽事資訊\n    getMatchInfo: function () {\n      var _getMatchInfo = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var _this2 = this;\n\n        var data;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                data = {\n                  MatchItemId: this.matchItemId\n                };\n                _context2.next = 3;\n                return apiGetClubGamblingMatchInfo(data, true).then(function (res) {\n                  _this2.betObj = res.Data;\n                });\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getMatchInfo() {\n        return _getMatchInfo.apply(this, arguments);\n      }\n\n      return getMatchInfo;\n    }(),\n    // 選擇勝平負\n    clickOdds: function clickOdds(num, item) {\n      this.oddsIndex = num;\n      this.betNum = item.OddsValue;\n      this.betInfo = item.Position + item.OddsValue; // 發起賠率input值\n\n      this.playId = item.PlayId;\n      this.betPosition = item.Position;\n\n      if (this.deposit == 0) {\n        this.isDeposit = true;\n      }\n    },\n    // 驗證發起賠率\n    validateBetNum: function validateBetNum() {\n      this.betNum = this.betNum * 1;\n      this.deposit = this.deposit * 1;\n\n      if (this.betNum <= this.betObj.MaxOddsValue && this.betNum >= this.betObj.MinOddsValue) {\n        // this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2);\n        this.betNum - 1 <= 0 ? this.expectedProfit = 0 : this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2);\n        this.isBetNum = false;\n      } else {\n        this.betNum = 0;\n        this.isBetNum = true;\n      }\n    },\n    // 驗證押金\n    validateDeposit: function validateDeposit() {\n      if (this.deposit <= this.betObj.MaxDeposit && this.deposit >= this.betObj.MinDeposit) {\n        this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2); // 計算手續費\n\n        this.getHandlingCharge();\n        this.isDeposit = false;\n      } else {\n        this.deposit = 0;\n        this.handlingCharge = 0;\n        this.isDeposit = true;\n      }\n    },\n    // 手續費\n    getHandlingCharge: function getHandlingCharge() {\n      if (this.deposit >= this.betObj.ChargeThreshold) {\n        this.handlingCharge = (this.deposit * this.betObj.HandlingCharge).toFixed(2);\n      } else {\n        this.handlingCharge = this.betObj.FixedHandlingCharge;\n      }\n    },\n    // 發起\n    initiate: function initiate() {\n      var _this3 = this;\n\n      if (this.isBetNum == true || this.isDeposit == true || this.betNum == 0 || this.deposit == 0) {\n        var vm = this;\n        var m = vm.$message({\n          message: this.$t('EnterCorrectValue'),\n          duration: 3000,\n          type: \"error\",\n          center: true\n        });\n        this.isFancyBoxOpen = false;\n        setTimeout(function () {\n          return m.close();\n        }, 2000);\n        return;\n      } else {\n        if (this.isClickTwice == false) {\n          var data = {\n            MatchItemId: this.matchItemId,\n            PlayId: this.playId,\n            BetPosition: this.betPosition,\n            HandlingCharge: this.handlingCharge,\n            OddsValue: this.betNum,\n            Deposit: this.deposit,\n            UName: this.uName\n          };\n          apiAddClubGambling(data, true).then(function (res) {\n            if (Math.abs(res.Code) >= 600) {\n              var _vm = _this3;\n\n              var _m = _vm.$message({\n                message: res.Message,\n                duration: 3000,\n                type: \"error\",\n                center: true\n              });\n\n              setTimeout(function () {\n                return _m.close();\n              }, 2000);\n            } else {\n              var _vm2 = _this3;\n\n              var _m2 = _vm2.$message({\n                message: res.Message,\n                duration: 3000,\n                type: \"success\",\n                center: true\n              });\n\n              setTimeout(function () {\n                _m2.close();\n\n                _this3.$router.push(\"/ClubActivities\");\n              }, 2000);\n            }\n\n            _this3.isFancyBoxOpen = false;\n          });\n          this.isClickTwice = true;\n        }\n      }\n    }\n  }\n};",{"version":3,"sources":["InitiateActivities.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6FA,OAAA,IAAA,MAAA,8BAAA;AACA,SAAA,2BAAA,EAAA,kBAAA,QAAA,wBAAA;AACA,OAAA,KAAA,MAAA,oBAAA;AACA,eAAA;AACA,EAAA,UAAA,EAAA;AACA,IAAA,IAAA,EAAA,IADA;AAEA,IAAA,KAAA,EAAA;AAFA,GADA;AAKA,EAAA,IALA,kBAKA;AACA,WAAA;AACA,MAAA,MAAA,EAAA,EADA;AAEA,MAAA,SAAA,EAAA,SAFA;AAGA;AACA,MAAA,OAAA,EAAA,CAJA;AAKA;AACA,MAAA,MAAA,EAAA,EANA;AAOA;AACA,MAAA,OAAA,EAAA,EARA;AASA;AACA,MAAA,cAAA,EAAA,CAVA;AAWA;AACA,MAAA,cAAA,EAAA,CAZA;AAaA,MAAA,eAAA,EAAA,SAbA;AAaA;AACA,MAAA,KAAA,EAAA,EAdA;AAeA,MAAA,MAAA,EAAA,SAfA;AAgBA,MAAA,WAAA,EAAA,SAhBA;AAiBA,MAAA,MAAA,EAAA,SAjBA;AAkBA,MAAA,WAAA,EAAA,EAlBA;AAmBA,MAAA,QAAA,EAAA,KAnBA;AAoBA,MAAA,SAAA,EAAA,KApBA;AAqBA,MAAA,YAAA,EAAA,KArBA;AAsBA,MAAA,cAAA,EAAA;AAtBA,KAAA;AAwBA,GA9BA;AA+BA,EAAA,KAAA,EAAA;AACA,IAAA,MAAA,EAAA,kBAAA;AACA,WAAA,MAAA,GAAA,KAAA,MAAA,GAAA,CAAA;AACA,WAAA,OAAA,GAAA,KAAA,OAAA,GAAA,CAAA;AACA,WAAA,cAAA;AACA,KALA;AAMA,IAAA,OAAA,EAAA,mBAAA;AACA,WAAA,MAAA,GAAA,KAAA,MAAA,GAAA,CAAA;AACA,WAAA,OAAA,GAAA,KAAA,OAAA,GAAA,CAAA;AACA,WAAA,MAAA,GAAA,CAAA,IAAA,CAAA,GAAA,KAAA,cAAA,GAAA,CAAA,GAAA,KAAA,cAAA,GAAA,CAAA,KAAA,OAAA,IAAA,KAAA,MAAA,GAAA,CAAA,CAAA,EAAA,OAAA,CAAA,CAAA,CAAA,CAHA,CAIA;AACA,KAXA;AAYA,IAAA,OAAA,EAAA,mBAAA;AACA,WAAA,MAAA,GAAA,KAAA,MAAA,GAAA,CAAA;AACA,WAAA,OAAA,GAAA,KAAA,OAAA,GAAA,CAAA;AACA,WAAA,MAAA,GAAA,CAAA,IAAA,CAAA,GAAA,KAAA,cAAA,GAAA,CAAA,GAAA,KAAA,cAAA,GAAA,CAAA,KAAA,OAAA,IAAA,KAAA,MAAA,GAAA,CAAA,CAAA,EAAA,OAAA,CAAA,CAAA,CAAA,CAHA,CAIA;;AACA,WAAA,iBAAA;AACA;AAlBA,GA/BA;AAmDA,EAAA,OAnDA,qBAmDA;AAAA;;AACA,SAAA,cAAA,GAAA,IAAA,CAAA,YAAA;AACA,MAAA,KAAA,CAAA,YAAA;AACA,KAFA;AAGA,GAvDA;AAwDA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,cAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA,qBAAA,KAAA,GAAA,YAAA,CAAA,OAAA,CAAA,OAAA,CAAA;AACA,qBAAA,MAAA,GAAA,YAAA,CAAA,OAAA,CAAA,QAAA,CAAA;AACA,qBAAA,WAAA,GAAA,YAAA,CAAA,OAAA,CAAA,aAAA,CAAA;;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAQA;AACA,IAAA,YATA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA,gBAAA,IAVA,GAUA;AACA,kBAAA,WAAA,EAAA,KAAA;AADA,iBAVA;AAAA;AAAA,uBAaA,2BAAA,CAAA,IAAA,EAAA,IAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,kBAAA,MAAA,CAAA,MAAA,GAAA,GAAA,CAAA,IAAA;AACA,iBAFA,CAbA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAiBA;AACA,IAAA,SAlBA,qBAkBA,GAlBA,EAkBA,IAlBA,EAkBA;AACA,WAAA,SAAA,GAAA,GAAA;AACA,WAAA,MAAA,GAAA,IAAA,CAAA,SAAA;AACA,WAAA,OAAA,GAAA,IAAA,CAAA,QAAA,GAAA,IAAA,CAAA,SAAA,CAHA,CAGA;;AAEA,WAAA,MAAA,GAAA,IAAA,CAAA,MAAA;AACA,WAAA,WAAA,GAAA,IAAA,CAAA,QAAA;;AACA,UAAA,KAAA,OAAA,IAAA,CAAA,EAAA;AACA,aAAA,SAAA,GAAA,IAAA;AACA;AACA,KA5BA;AA8BA;AACA,IAAA,cA/BA,4BA+BA;AACA,WAAA,MAAA,GAAA,KAAA,MAAA,GAAA,CAAA;AACA,WAAA,OAAA,GAAA,KAAA,OAAA,GAAA,CAAA;;AACA,UAAA,KAAA,MAAA,IAAA,KAAA,MAAA,CAAA,YAAA,IAAA,KAAA,MAAA,IAAA,KAAA,MAAA,CAAA,YAAA,EAAA;AACA;AACA,aAAA,MAAA,GAAA,CAAA,IAAA,CAAA,GAAA,KAAA,cAAA,GAAA,CAAA,GAAA,KAAA,cAAA,GAAA,CAAA,KAAA,OAAA,IAAA,KAAA,MAAA,GAAA,CAAA,CAAA,EAAA,OAAA,CAAA,CAAA,CAAA;AACA,aAAA,QAAA,GAAA,KAAA;AACA,OAJA,MAIA;AACA,aAAA,MAAA,GAAA,CAAA;AACA,aAAA,QAAA,GAAA,IAAA;AACA;AACA,KA1CA;AA4CA;AACA,IAAA,eA7CA,6BA6CA;AACA,UAAA,KAAA,OAAA,IAAA,KAAA,MAAA,CAAA,UAAA,IAAA,KAAA,OAAA,IAAA,KAAA,MAAA,CAAA,UAAA,EAAA;AACA,aAAA,cAAA,GAAA,CAAA,KAAA,OAAA,IAAA,KAAA,MAAA,GAAA,CAAA,CAAA,EAAA,OAAA,CAAA,CAAA,CAAA,CADA,CAEA;;AACA,aAAA,iBAAA;AACA,aAAA,SAAA,GAAA,KAAA;AACA,OALA,MAKA;AACA,aAAA,OAAA,GAAA,CAAA;AACA,aAAA,cAAA,GAAA,CAAA;AACA,aAAA,SAAA,GAAA,IAAA;AACA;AACA,KAxDA;AA0DA;AACA,IAAA,iBA3DA,+BA2DA;AACA,UAAA,KAAA,OAAA,IAAA,KAAA,MAAA,CAAA,eAAA,EAAA;AACA,aAAA,cAAA,GAAA,CAAA,KAAA,OAAA,GAAA,KAAA,MAAA,CAAA,cAAA,EAAA,OAAA,CAAA,CAAA,CAAA;AACA,OAFA,MAEA;AACA,aAAA,cAAA,GAAA,KAAA,MAAA,CAAA,mBAAA;AACA;AACA,KAjEA;AAmEA;AACA,IAAA,QApEA,sBAoEA;AAAA;;AACA,UAAA,KAAA,QAAA,IAAA,IAAA,IAAA,KAAA,SAAA,IAAA,IAAA,IAAA,KAAA,MAAA,IAAA,CAAA,IAAA,KAAA,OAAA,IAAA,CAAA,EAAA;AACA,YAAA,EAAA,GAAA,IAAA;AACA,YAAA,CAAA,GAAA,EAAA,CAAA,QAAA,CAAA;AACA,UAAA,OAAA,EAAA,KAAA,EAAA,CAAA,mBAAA,CADA;AAEA,UAAA,QAAA,EAAA,IAFA;AAGA,UAAA,IAAA,EAAA,OAHA;AAIA,UAAA,MAAA,EAAA;AAJA,SAAA,CAAA;AAMA,aAAA,cAAA,GAAA,KAAA;AACA,QAAA,UAAA,CAAA;AAAA,iBAAA,CAAA,CAAA,KAAA,EAAA;AAAA,SAAA,EAAA,IAAA,CAAA;AACA;AACA,OAXA,MAWA;AACA,YAAA,KAAA,YAAA,IAAA,KAAA,EAAA;AACA,cAAA,IAAA,GAAA;AACA,YAAA,WAAA,EAAA,KAAA,WADA;AAEA,YAAA,MAAA,EAAA,KAAA,MAFA;AAGA,YAAA,WAAA,EAAA,KAAA,WAHA;AAIA,YAAA,cAAA,EAAA,KAAA,cAJA;AAKA,YAAA,SAAA,EAAA,KAAA,MALA;AAMA,YAAA,OAAA,EAAA,KAAA,OANA;AAOA,YAAA,KAAA,EAAA,KAAA;AAPA,WAAA;AASA,UAAA,kBAAA,CAAA,IAAA,EAAA,IAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,gBAAA,IAAA,CAAA,GAAA,CAAA,GAAA,CAAA,IAAA,KAAA,GAAA,EAAA;AACA,kBAAA,GAAA,GAAA,MAAA;;AACA,kBAAA,EAAA,GAAA,GAAA,CAAA,QAAA,CAAA;AACA,gBAAA,OAAA,EAAA,GAAA,CAAA,OADA;AAEA,gBAAA,QAAA,EAAA,IAFA;AAGA,gBAAA,IAAA,EAAA,OAHA;AAIA,gBAAA,MAAA,EAAA;AAJA,eAAA,CAAA;;AAMA,cAAA,UAAA,CAAA;AAAA,uBAAA,EAAA,CAAA,KAAA,EAAA;AAAA,eAAA,EAAA,IAAA,CAAA;AACA,aATA,MASA;AACA,kBAAA,IAAA,GAAA,MAAA;;AACA,kBAAA,GAAA,GAAA,IAAA,CAAA,QAAA,CAAA;AACA,gBAAA,OAAA,EAAA,GAAA,CAAA,OADA;AAEA,gBAAA,QAAA,EAAA,IAFA;AAGA,gBAAA,IAAA,EAAA,SAHA;AAIA,gBAAA,MAAA,EAAA;AAJA,eAAA,CAAA;;AAMA,cAAA,UAAA,CAAA,YAAA;AACA,gBAAA,GAAA,CAAA,KAAA;;AACA,gBAAA,MAAA,CAAA,OAAA,CAAA,IAAA,CAAA,iBAAA;AACA,eAHA,EAGA,IAHA,CAAA;AAIA;;AACA,YAAA,MAAA,CAAA,cAAA,GAAA,KAAA;AACA,WAxBA;AAyBA,eAAA,YAAA,GAAA,IAAA;AACA;AACA;AACA;AAvHA;AAxDA,CAAA","sourcesContent":["<template>\r\n  <div class=\"initiate-activities\">\r\n    <div class=\"initiate-activities-header\">\r\n      <div class=\"initiate-activities-header-wrap\">\r\n        <back class=\"back-icon img-he\"></back>\r\n        <h3>{{ $t(\"Initiateactivities\") }}</h3>\r\n        <!--发起活动-->\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"initiate-activities-content\">\r\n      <div class=\"initiate-activities-vsImg\">\r\n        <div class=\"initiate-activities-vsImg-top\">\r\n          <div class=\"initiate-activities-vsImg-box\">\r\n            <img  v-if=\"betObj.HomeTeamImg\" :src=\"betObj.HomeTeamImg\" />\r\n            <img v-else src=\"@/assets/instead_logo1.png\" alt=\"\" class=\"sport-main-collapse-img\">\r\n            <p>{{ betObj.HomeTeam }}</p>\r\n          </div>\r\n          <div class=\"initiate-activities-vs\">VS</div>\r\n          <div class=\"initiate-activities-vsImg-box\">\r\n            <img v-if=\"betObj.AwayTeamImg\" :src=\"betObj.AwayTeamImg\" />\r\n            <img v-else src=\"@/assets/instead_logo1.png\" alt=\"\" class=\"sport-main-collapse-img\">\r\n            <p>{{ betObj.AwayTeam }}</p>\r\n          </div>\r\n        </div>\r\n        <div class=\"initiate-activities-vsImg-bottom-wrap\">\r\n          <div class=\"initiate-activities-odds-btn\" :class=\"{ 'odds-btn-focus': oddsIndex == index }\" @click=\"clickOdds(index, item)\" v-for=\"(item, index) in betObj.PlayList\">\r\n            {{ item.Position }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"bet-block\">\r\n        <div class=\"bet-block-box\">\r\n          <div class=\"bet-block-box-title\">{{ $t('RecommendedOdds') }}</div><!--推荐赔率-->\r\n          <div class=\"odds-wrap\">\r\n            <div class=\"odds\" v-for=\"(item, index) in betObj.PlayList\">\r\n              <p>{{ item.Position }}</p>\r\n              <p class=\"blue\">{{ item.OddsValue }}</p>\r\n            </div>\r\n            <!-- <div class=\"odds\">\r\n              <p>{{ betObj.tieOdds }}</p>\r\n              <p class=\"blue\">{{ betObj.awayOoddNum }}</p>\r\n            </div>\r\n            <div class=\"odds\">\r\n              <p>{{ betObj.awayOdds }}</p>\r\n              <p class=\"blue\">{{ betObj.tieOddNum }}</p>\r\n            </div> -->\r\n          </div>\r\n        </div>\r\n        <div class=\"bet-block-box\">\r\n          <div class=\"bet-block-box-title\">\r\n            <p>{{ $t('InitiationOdds') }}</p><!--发起赔率-->\r\n            <div class=\"alerts\" v-if=\"isBetNum\">( {{ $t('OddsRange') }}{{betObj.MinOddsValue}}~{{betObj.MaxOddsValue}} )</div><!--賠率範圍-->\r\n          </div>\r\n          <el-input type=\"number\" v-model=\"betNum\" :placeholder='$t(\"PleaseEnterTheOdds\")'></el-input>\r\n        </div>\r\n        <div class=\"bet-block-box\">\r\n          <div class=\"bet-block-box-title\">\r\n            <p>{{ $t('CashPledge') }}</p><!--押金-->\r\n            <div class=\"alerts\" v-if=\"isDeposit\">( {{ $t('DepositRange') }}{{betObj.MinDeposit}}~{{betObj.MaxDeposit}} )</div><!--押金範圍-->\r\n          </div>\r\n          <!-- <input type=\"text\" v-model=\"deposit\" /> -->\r\n          <el-input type=\"number\" v-model=\"deposit\" @change=\"validateDeposit\" :placeholder=\"$t('EnterDeposit')\"></el-input>\r\n        </div>\r\n        <div class=\"bet-block-box\">\r\n          <div class=\"bet-block-box-title\">{{ $t(\"ExpectedProfit\") }}</div><!--预计盈利-->\r\n          <input type=\"text\" v-model=\"expectedProfit\" disabled=\"disabled\"/>\r\n        </div>\r\n        <div class=\"bet-block-box\">\r\n          <div class=\"bet-block-box-title\">{{ $t('HandlingCharge') }}</div><!--手续费-->\r\n          <input type=\"text\" v-model=\"handlingCharge\" disabled=\"disabled\"/>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"initiate-activities-btn\" @click=\"isFancyBoxOpen=true\">{{ $t(\"Confirm\") }}</div>\r\n    <transition name=\"fade\">\r\n\t\t  <model v-if=\"isFancyBoxOpen\"></model>\r\n\t  </transition>\r\n\t  <transition name=\"fade\">\r\n      <div class=\"fancy-box\" v-if=\"isFancyBoxOpen\">\r\n        <img src=\"../../assets/club/ticket-header.png\" alt=\"\">\r\n        <div class=\"fancy-box-content\">\r\n          <p>{{ $t('SureToCreateThisEvent') }}?</p>\r\n        </div>\r\n        <div class=\"fancy-box-btn\">\r\n          <div class=\"fancy-box-btn-confirm\" @click=\"initiate()\" :disabled=\"isClickTwice\">{{ $t('Confirm') }}</div>\r\n          <div class=\"fancy-box-btn-cancel\" @click=\"isFancyBoxOpen = !isFancyBoxOpen\">{{ $t('Cancel') }}</div>\r\n        </div>\r\n      </div>\r\n\t  </transition>\r\n  </div>\r\n</template>\r\n<script>\r\nimport back from \"@/components/Botton/back.vue\";\r\nimport { apiGetClubGamblingMatchInfo, apiAddClubGambling } from \"@/api/ClubGamblings.js\";\r\nimport model from \"@/components/model\";\r\nexport default {\r\n  components: {\r\n    back,\r\n    model\r\n  },\r\n  data() {\r\n    return {\r\n      betObj: [],\r\n      oddsIndex: undefined,\r\n      // 發起賠率文字\r\n      betInfo: 0,\r\n      // 賠率\r\n      betNum: \"\",\r\n      // 押金\r\n      deposit: \"\",\r\n      // 預計盈利\r\n      expectedProfit: 0,\r\n      // 手續費\r\n      handlingCharge: 0,\r\n      chargeThreshold: undefined, // 手續費判斷標準\r\n      uName: \"\",\r\n      clubId: undefined,\r\n      matchItemId: undefined,\r\n      playId: undefined,\r\n      betPosition: \"\",\r\n      isBetNum: false,\r\n      isDeposit: false,\r\n      isClickTwice: false,\r\n      isFancyBoxOpen: false\r\n    };\r\n  },\r\n    watch: {\r\n    betNum: function() {\r\n      this.betNum = this.betNum * 1 ;\r\n      this.deposit = this.deposit * 1 ;\r\n      this.validateBetNum();\r\n    },\r\n    betInfo: function() {\r\n      this.betNum = this.betNum * 1 ;\r\n      this.deposit = this.deposit * 1 ;\r\n      this.betNum - 1 <= 0 ? this.expectedProfit = 0 : this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2);\r\n      // this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2);\r\n    },\r\n    deposit: function() {\r\n      this.betNum = this.betNum * 1 ;\r\n      this.deposit = this.deposit * 1 ;\r\n      this.betNum - 1 <= 0 ? this.expectedProfit = 0 : this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2);\r\n      // this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2);\r\n      this.getHandlingCharge();\r\n    },\r\n  },\r\n  created() {\r\n    this.getMatchItemId().then(() => {\r\n      this.getMatchInfo();\r\n    })\r\n  },\r\n  methods: {\r\n    // 讀取matchItemId\r\n    async getMatchItemId() {\r\n      this.uName = localStorage.getItem(\"uname\");\r\n      this.clubId = localStorage.getItem(\"ClubId\");\r\n      this.matchItemId = localStorage.getItem(\"matchItemId\");\r\n    },\r\n\r\n    // 取得發起活動的賽事資訊\r\n    async getMatchInfo() {\r\n      let data = {\r\n        MatchItemId: this.matchItemId\r\n      };\r\n      await apiGetClubGamblingMatchInfo(data, true).then(res => {\r\n        this.betObj = res.Data;\r\n      });\r\n    },\r\n    // 選擇勝平負\r\n    clickOdds(num, item) {\r\n      this.oddsIndex = num;\r\n      this.betNum = item.OddsValue;\r\n      this.betInfo = item.Position + item.OddsValue; // 發起賠率input值\r\n      \r\n      this.playId = item.PlayId;\r\n      this.betPosition = item.Position;\r\n      if(this.deposit == 0) {\r\n        this.isDeposit = true;\r\n      }\r\n    },\r\n\r\n    // 驗證發起賠率\r\n    validateBetNum() {\r\n      this.betNum = this.betNum * 1 ;\r\n      this.deposit = this.deposit * 1 ;\r\n      if (this.betNum <= this.betObj.MaxOddsValue && this.betNum >= this.betObj.MinOddsValue) {\r\n        // this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2);\r\n        this.betNum - 1 <= 0 ? this.expectedProfit = 0 : this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2);\r\n        this.isBetNum = false;\r\n      } else {\r\n        this.betNum = 0;\r\n        this.isBetNum = true;\r\n      }\r\n    },\r\n\r\n    // 驗證押金\r\n    validateDeposit() {\r\n      if (this.deposit <= this.betObj.MaxDeposit && this.deposit >= this.betObj.MinDeposit) {\r\n        this.expectedProfit = (this.deposit / (this.betNum - 1)).toFixed(2);\r\n        // 計算手續費\r\n        this.getHandlingCharge();\r\n        this.isDeposit = false;\r\n      } else {\r\n        this.deposit = 0;\r\n        this.handlingCharge = 0;\r\n        this.isDeposit = true;\r\n      }\r\n    },\r\n\r\n    // 手續費\r\n    getHandlingCharge() {\r\n      if (this.deposit >= this.betObj.ChargeThreshold) {\r\n        this.handlingCharge = (this.deposit * this.betObj.HandlingCharge).toFixed(2);\r\n      } else {\r\n        this.handlingCharge = this.betObj.FixedHandlingCharge;\r\n      }\r\n    },\r\n\r\n    // 發起\r\n    initiate() {\r\n      if (this.isBetNum == true || this.isDeposit == true || this.betNum == 0 || this.deposit == 0) {\r\n        let vm = this;\r\n        const m = vm.$message({\r\n          message: this.$t('EnterCorrectValue'),\r\n          duration: 3000,\r\n          type: \"error\",\r\n          center: true\r\n        });\r\n        this.isFancyBoxOpen = false;\r\n        setTimeout(() => m.close(), 2000);\r\n        return;\r\n      } else {\r\n        if (this.isClickTwice == false) {\r\n          let data = {\r\n            MatchItemId: this.matchItemId,\r\n            PlayId: this.playId,\r\n            BetPosition: this.betPosition,\r\n            HandlingCharge: this.handlingCharge,\r\n            OddsValue: this.betNum,\r\n            Deposit: this.deposit,\r\n            UName: this.uName\r\n          };\r\n          apiAddClubGambling(data, true).then(res => {\r\n            if(Math.abs(res.Code) >= 600) {\r\n              let vm = this;\r\n              const m = vm.$message({\r\n                message: res.Message,\r\n                duration: 3000,\r\n                type: \"error\",\r\n                center: true\r\n              });\r\n              setTimeout(() => m.close(), 2000);\r\n            } else {\r\n              let vm = this;\r\n              const m = vm.$message({\r\n                message: res.Message,\r\n                duration: 3000,\r\n                type: \"success\",\r\n                center: true\r\n              });\r\n              setTimeout(() => {\r\n                m.close();\r\n                this.$router.push(\"/ClubActivities\");\r\n              }, 2000);\r\n            }\r\n            this.isFancyBoxOpen = false;\r\n          });\r\n          this.isClickTwice = true;\r\n        }\r\n      }\r\n    }\r\n  },\r\n};\r\n</script>\r\n"],"sourceRoot":"src/views/club"}]}