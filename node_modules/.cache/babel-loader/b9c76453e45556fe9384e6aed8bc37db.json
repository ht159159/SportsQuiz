{"remainingRequest":"C:\\work\\竞猜可换色板\\node_modules\\thread-loader\\dist\\cjs.js!C:\\work\\竞猜可换色板\\node_modules\\babel-loader\\lib\\index.js!C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\work\\竞猜可换色板\\src\\views\\Shop.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\work\\竞猜可换色板\\src\\views\\Shop.vue","mtime":1605491181309},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport inputComp from \"@/components/Index/Input.vue\";\nimport NavBottom from \"@/components/Main/NavBottom.vue\";\nimport { apiGetCategoryRecord, apiGetGoodsRecordList, apiAddCashInformation } from \"@/api/product.js\";\nimport { apiGetUserAddress, apiAddEditMemAddress } from \"@/api/User.js\";\nimport Vue from \"vue\";\nimport { Notify, Toast, Field, Image, Button } from \"vant\";\nVue.use(Notify).use(Toast).use(Field).use(Image);\nexport default {\n  //  从List组件离开时,修改keepAlive值为false，保证进入该页面时页面刷新  to===> 去哪个路由  from ==>从哪个路由来\n  // beforeRouteEnter(to, from, next) {\n  //   if (from.name !== \"shopList\") {\n  //     next(vm => {\n  //       vm._data.show = false;\n  //     });\n  //   } else {\n  //     next(vm => {\n  //       vm._data.show = true;\n  //     });\n  //   }\n  // },\n  name: \"shop\",\n  components: {\n    NavBottom: NavBottom\n  },\n  filters: {\n    wayW: function wayW(val, that) {\n      if (val == 1) {\n        return that.$t(\"Coins\");\n      } else {\n        return that.$t(\"LotteryTicket\");\n      }\n    }\n  },\n  watch: {\n    $route: function $route() {\n      var listArr = JSON.stringify(this.shopsList); // debugger\n\n      if (listArr == \"[]\") {} else {\n        // 這邊切換商城及切換其他頁面時候會瘋狂報錯，先加個判斷限制一下，原因是上面的 \"listArr\"陣列第0及第3個 值為空\n        if (this.shopsList[0] == undefined || this.shopsList[2] == undefined) {\n          return;\n        } else {\n          var aid = this.shopsList[0];\n          var oldAid = JSON.parse(localStorage.getItem(\"shops\"))[0];\n\n          if (aid != oldAid) {\n            this.shopsList = JSON.parse(localStorage.getItem(\"shops\"));\n          }\n        }\n      }\n    }\n  },\n  data: function data() {\n    return {\n      includedComponents: \"shop\",\n      num: 0,\n      priceList: [200, 500, 1000, 2000, 3000, 5000],\n      money: 0,\n      show: false,\n      Idd: \"\",\n      listShop: [],\n      listShopQ: [],\n      Num: 1,\n      value: \"\",\n      types: 1,\n      amountSum: \"\",\n      lastMoney: \"\",\n      ways: this.$t(\"Coins\"),\n      titleNm: \"\",\n      imgMsg: false,\n      shopsList: [],\n      img1: true,\n      img2: false,\n      isChange: 1,\n      that: this,\n      noAddressSet: false,\n      lang: \"\",\n      theme: \"\",\n      themeType: [\"red\", \"blue\", \"black\", \"yellow\"],\n      matchUrl: require(\"@/assets/shop/shop_header.png\"),\n      CNMatchPicUrl: {\n        red: require(\"@/assets/shop/shop_header.png\"),\n        blue: require(\"@/assets/theme-blue/shop/shop_header.png\"),\n        black: require(\"@/assets/theme-black/shop/shop_header.png\"),\n        yellow: require(\"@/assets/theme-yellow/shop/shop_header.png\")\n      },\n      EnMatchPicUrl: {\n        red: require(\"@/assets/shop/shop_header_US.png\"),\n        blue: require(\"@/assets/theme-blue/shop/shop_header_US.png\"),\n        black: require(\"@/assets/theme-black/shop/shop_header_US.png\"),\n        yellow: require(\"@/assets/theme-yellow/shop/shop_header_US.png\")\n      },\n      TWMatchPicUrl: {\n        red: require(\"@/assets/shop/shop_header_TW.png\"),\n        blue: require(\"@/assets/theme-blue/shop/shop_header_TW.png\"),\n        black: require(\"@/assets/theme-black/shop/shop_header_TW.png\"),\n        yellow: require(\"@/assets/theme-yellow/shop/shop_header_TW.png\")\n      }\n    };\n  },\n  created: function created() {\n    console.log('fsdfsdf');\n    this.lang = JSON.parse(localStorage.getItem(\"lang\")).tag;\n    this.theme = localStorage.getItem(\"theme\");\n    this.section();\n    this.changePri(3);\n    this.getAddMsg();\n  },\n  mounted: function mounted() {\n    console.log('fsdfsdf');\n    this.changePic();\n  },\n  methods: {\n    changePic: function changePic() {\n      if (this.lang == \"zh-CN\" || this.lang == \"zh-TW\") {\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n          for (var _iterator = this.themeType[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var i = _step.value;\n\n            if (i == this.theme) {\n              this.matchUrl = this.CNMatchPicUrl[i]; // this.matchPopUrl = this.CNMatchPopPicUrl[i];\n            }\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion && _iterator.return != null) {\n              _iterator.return();\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n      }\n\n      if (this.lang == \"en-US\") {\n        var _iteratorNormalCompletion2 = true;\n        var _didIteratorError2 = false;\n        var _iteratorError2 = undefined;\n\n        try {\n          for (var _iterator2 = this.themeType[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n            var _i = _step2.value;\n\n            if (_i == this.theme) {\n              this.matchUrl = this.EnMatchPicUrl[_i]; // this.matchPopUrl = this.EnMatchPopPicUrl[i];\n            }\n          }\n        } catch (err) {\n          _didIteratorError2 = true;\n          _iteratorError2 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n              _iterator2.return();\n            }\n          } finally {\n            if (_didIteratorError2) {\n              throw _iteratorError2;\n            }\n          }\n        }\n      }\n\n      if (this.lang == \"zh-TW\") {\n        var _iteratorNormalCompletion3 = true;\n        var _didIteratorError3 = false;\n        var _iteratorError3 = undefined;\n\n        try {\n          for (var _iterator3 = this.themeType[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n            var _i2 = _step3.value;\n\n            if (_i2 == this.theme) {\n              this.matchUrl = this.TWMatchPicUrl[_i2]; // this.matchPopUrl = this.EnMatchPopPicUrl[i];\n            }\n          }\n        } catch (err) {\n          _didIteratorError3 = true;\n          _iteratorError3 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n              _iterator3.return();\n            }\n          } finally {\n            if (_didIteratorError3) {\n              throw _iteratorError3;\n            }\n          }\n        }\n      }\n    },\n    downNum: function downNum() {\n      if (this.Num > 99) {\n        var m = this.$message({\n          message: this.$t(\"RedeemSingle\"),\n          type: \"warning\",\n          center: true,\n          duration: 1000\n        });\n        setTimeout(function () {\n          return m.close();\n        }, 1200);\n        this.Num = 99;\n      }\n    },\n    goAddress: function goAddress() {\n      var _this = this;\n\n      var data = {};\n      apiGetUserAddress(data, true).then(function (res) {\n        if (res.Data.length > 0) {\n          _this.$router.push(\"/shopList\");\n        } else {\n          _this.$router.push(\"/address\");\n        }\n      });\n    },\n    cancel: function cancel() {\n      this.show = false;\n    },\n    queryChange: function queryChange(name, id) {\n      this.titleNm = name;\n      this.show = true;\n      this.lastMoney = this.amountSum;\n      this.$refs.son.show = false;\n      this.getAddMsg();\n    },\n    commit: function commit() {\n      var _this2 = this;\n\n      this.$refs.son.show = false;\n      var Token = localStorage.getItem(\"token\");\n\n      if (this.shopsList[1] == undefined || this.shopsList[1] == \"\" || this.shopsList[2] == undefined || this.shopsList[2] == \"\" || this.shopsList[4] == undefined || this.shopsList[4] == \"\") {\n        Notify({\n          type: \"warning\",\n          message: this.$t(\"AllMustFilled\")\n        });\n        return;\n      }\n\n      var data = {\n        Name: this.shopsList[1],\n        Phone: this.shopsList[2],\n        Address: this.shopsList[4],\n        IdentityCard: \"\",\n        CashNum: this.Num,\n        Type: this.types,\n        Lotteries: this.amountSum,\n        Uid: \"\",\n        GoodDescription: this.titleNm,\n        Status: 0,\n        CreateTime: new Date(),\n        AuditTime: \"\",\n        AuditName: \"\"\n      };\n\n      if (data.CashNum < 0 || !/^\\d+$/.test(this.Num)) {\n        var m = this.$message({\n          message: this.$t(\"FillPositiveInteger\"),\n          type: \"warning\",\n          center: true,\n          duration: 1200\n        });\n        setTimeout(function () {\n          return m.close();\n        }, 1200);\n        this.Num = parseInt(this.Num);\n        return;\n      }\n\n      if (this.noAddressSet) {\n        console.log(\"5256555\");\n        var addressSetData = {\n          AId: '',\n          UId: '',\n          UName: this.shopsList[1],\n          UPhoneNumber: this.shopsList[2],\n          URedeemAddress: this.shopsList[4],\n          IdentityCard: '123123',\n          CreateTime: new Date(),\n          IsDefault: 0\n        };\n        apiAddEditMemAddress(addressSetData, true).then(function (res) {});\n      }\n\n      apiAddCashInformation(data, true).then(function (res) {\n        if (res.IsSuccess) {\n          _this2.Num = 1;\n          _this2.show = false;\n\n          var _m = _this2.$message({\n            message: _this2.$t(\"SuccessfulPurchase\"),\n            type: \"success\",\n            center: true,\n            duration: 1200\n          });\n\n          setTimeout(function () {\n            return _m.close();\n          }, 1200);\n        } else {\n          _this2.show = false; // this.$Alert.showError.call(this, '购买失败')\n\n          var _m2 = _this2.$message({\n            message: _this2.$t(\"FailedPurchase\"),\n            type: \"error\",\n            duration: 2000\n          });\n\n          setTimeout(function () {\n            return _m2.close();\n          }, 2000);\n        }\n      });\n    },\n    getAddMsg: function getAddMsg() {\n      var _this3 = this;\n\n      var data = {};\n      apiGetUserAddress(data, true).then(function (res) {\n        // debugger\n        if (res.Data.length > 0) {\n          _this3.noAddressSet = false;\n          var listAdd = res.Data;\n          var newObj = {};\n\n          for (var i = 0; i < listAdd.length; i++) {\n            if (listAdd[i].IsDefault == 1) {\n              newObj = listAdd[i];\n            }\n          }\n\n          var arr = [];\n\n          for (var j in newObj) {\n            arr.push(newObj[j]);\n          }\n\n          if (arr.length == 0) {\n            _this3.shopsList[1] = res.Data[0].UName;\n            _this3.shopsList[2] = res.Data[0].UPhoneNumber;\n            _this3.shopsList[4] = res.Data[0].URedeemAddress;\n          } else {\n            _this3.shopsList[1] = arr[2];\n            _this3.shopsList[2] = arr[3];\n            _this3.shopsList[4] = arr[4];\n          }\n        } else {\n          _this3.shopsList = [];\n          _this3.noAddressSet = true;\n        }\n      });\n    },\n    changeM: function changeM() {\n      this.num = 0;\n      this.types = 1; // this.imgIcon = require(\"@/assets/jinbi.png\");\n      // this.imgIcon1 = require(\"@/assets/jiang.png\");\n\n      this.isChange = 1;\n      this.getCommut();\n    },\n    changeQ: function changeQ() {\n      this.num = 1;\n      this.types = 2;\n      this.img2 = !this.img2; // this.imgIcon = require(\"@/assets/jinbi1.png\");\n      // this.imgIcon1 = require(\"@/assets/jiang1.png\");\n\n      this.isChange = 2;\n      this.getCommut();\n    },\n    moneyC: function moneyC(index) {\n      this.money = index;\n      this.$refs.son.show = false;\n    },\n    section: function section() {\n      var _this4 = this;\n\n      apiGetCategoryRecord().then(function (res) {\n        _this4.priceList = res.Data;\n      });\n    },\n    changePri: function changePri(id) {\n      this.Idd = id;\n\n      if (id == 3) {\n        this.amountSum = 200;\n      }\n\n      if (id == 4) {\n        this.amountSum = 500;\n      }\n\n      if (id == 5) {\n        this.amountSum = 1000;\n      }\n\n      if (id == 6) {\n        this.amountSum = 2000;\n      }\n\n      if (id == 7) {\n        this.amountSum = 3000;\n      }\n\n      if (id == 8) {\n        this.amountSum = 5000;\n      }\n\n      this.getCommut();\n    },\n    getCommut: function getCommut() {\n      var _this5 = this;\n\n      var data = {\n        categoryId: this.Idd,\n        index: 1,\n        count: 10,\n        type: this.types //金币兑换 2奖券兑换\n\n      };\n      apiGetGoodsRecordList(data).then(function (res) {\n        _this5.listShop = res.Data;\n\n        _this5.$forceUpdate();\n\n        if (_this5.listShop.length == 0) {\n          _this5.imgMsg = true;\n        } else {\n          _this5.imgMsg = false;\n          _this5.listShop = res.Data;\n        }\n      });\n    }\n  },\n  computed: {// amountSum() {\n    //   return\n    //     this.priceList.filter(c=>c.categoryId==this.Idd)\n    // },\n  },\n  //可以在此进行强制数据刷新。\n  activated: function activated() {// this.getAddMsg()\n  }\n};",null]}