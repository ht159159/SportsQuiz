{"remainingRequest":"C:\\work\\竞猜可换色板\\node_modules\\babel-loader\\lib\\index.js!C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\work\\竞猜可换色板\\src\\views\\Lottery.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\work\\竞猜可换色板\\src\\views\\Lottery.vue","mtime":1606294072299},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\竞猜可换色板\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { apiLuckDraw, apiGetPrizePoolSetting } from \"@/api/product.js\";\nimport { apiGetUserInfo, apiGetUserAddress } from \"@/api/User.js\";\nimport roundTurntable from \"../components/roundTurntable.vue\";\nimport model from \"../components/model\";\nimport { apiGetInvitationUrl } from \"@/api/InvitationCode.js\";\nimport Clipboard from \"clipboard\";\nimport back from \"../components/Botton/back.vue\";\nimport { lotteryMusic, lotteryWining } from \"@/utils/medias\";\nexport default {\n  components: {\n    roundTurntable: roundTurntable,\n    model: model,\n    back: back\n  },\n  created: function created() {\n    var _this = this;\n\n    this.lang = JSON.parse(localStorage.getItem(\"lang\")).tag;\n    this.getPrizePoolSetting();\n    apiGetUserInfo(\"\", true).then(function (res) {\n      _this.gold = res.UDiamond;\n      _this.num = Math.floor(res.UDiamond / 10);\n    });\n    this.geturl();\n    this.getUserAddress();\n  },\n  data: function data() {\n    return {\n      lang: \"\",\n      // 转盘上的奖品数据\n      prizeData: [],\n      // 转动的圈数\n      rotateCircle: 24,\n      // 转动需要持续的时间（s）\n      duringTime: 6.5,\n      // 转盘样式的选项\n      turntableStyleOption: {\n        // 背景色\n        prizeBgColors: [\"#AE3EFF\", \"#4D3FFF\", \"#FC262C\", \"#3A8BFF\", \"#EE7602\", \"#FE339F\"],\n        // 转盘的外边框颜色\n        borderColor: \"#199301\"\n      },\n      // 中奖的奖品的index\n      prizeIndex: -1,\n      // 用来锁定转盘，避免同时多次点击转动\n      isLocking: false,\n      // 剩余抽奖次数\n      num: 2,\n      gold: Number,\n      index: \"\",\n      showgold: false,\n      typep: \"\",\n      codeUrl: \"\",\n      Tips: [],\n      flag: true,\n      editUserAddress: false,\n      prize: 0\n    };\n  },\n  methods: {\n    geturl: function geturl() {\n      var _this2 = this;\n\n      apiGetInvitationUrl(\"\", true).then(function (res) {\n        _this2.codeUrl = res.data;\n      });\n    },\n    copy: function copy() {\n      var _this3 = this;\n\n      var clipboard = new Clipboard(\".tag-read1\");\n      clipboard.on(\"success\", function (e) {\n        // this.$toast.success({\n        //   message: \"邀请链接复制成功\",\n        //   duration: 3000\n        // });\n        var m = _this3.$message({\n          message: \"邀请链接复制成功\",\n          duration: 3000,\n          type: \"success\",\n          center: true\n        });\n\n        setTimeout(function () {\n          return m.close();\n        }, 1200); // success(\"复制成功\");//这里你如果引入了elementui的提示就可以用，没有就注释即可\n        // 释放内存\n\n        clipboard.destroy();\n      });\n      clipboard.on(\"error\", function (e) {\n        // 不支持复制\n        // 释放内存\n        clipboard.destroy();\n      });\n    },\n    wexin: function wexin() {\n      var m = this.$message({\n        type: \"warning\",\n        message: this.$t('NotYetOpen'),\n        center: true,\n        duration: 1000\n      });\n      setTimeout(function () {\n        return m.close();\n      }, 1200);\n    },\n    pyj: function pyj() {\n      var m = this.$message({\n        type: \"warning\",\n        message: this.$t('NotYetOpen'),\n        center: true,\n        duration: 1000\n      });\n      setTimeout(function () {\n        return m.close();\n      }, 1200);\n    },\n    close: function close() {\n      this.showgold = false;\n    },\n    getPrizePoolSetting: function getPrizePoolSetting() {\n      var _this4 = this;\n\n      apiGetPrizePoolSetting(\"\").then(function (res) {\n        _this4.prizeData = res.Prizes;\n        _this4.prize = res.Price;\n        _this4.Tips = res.Tips;\n      });\n    },\n    getApiLuckDraw: function getApiLuckDraw() {\n      var _this5 = this;\n\n      if (!this.flag) {\n        return;\n      }\n\n      this.flag = false;\n      apiLuckDraw(\"\", true).then(function (res) {\n        if (res.isSuccess) {\n          for (var i = 0; i < _this5.prizeData.length; i++) {\n            var element = _this5.prizeData[i].PrizeId;\n\n            if (element == res.PrizeId) {\n              _this5.index = i;\n            }\n          }\n\n          _this5.startRotation();\n        } else {\n          _this5.flag = true;\n\n          _this5.$message({\n            type: \"error\",\n            message: res.Message,\n            center: true,\n            duration: 1000,\n            typep: \"\"\n          });\n\n          if (res.Message === \"抱歉，请先设置默认收货地址！\") {\n            _this5.$router.push(\"/address\");\n          }\n        }\n      });\n    },\n    startRotation: function startRotation() {\n      // 如果还不可以转动\n      if (!this.canBeRotated()) {\n        return false;\n      } //開始轉動音效\n\n\n      lotteryMusic.play(); // 开始转动\n      // 先上锁\n\n      this.isLocking = true; // 设置在哪里停下，应该与后台交互，这里随机抽取0~5\n      // apiLuckDraw(\"\", true).then(res => {\n      // if (res.isSuccess) {\n      // let index;\n      // for (let i = 0; i < this.prizeData.length; i++) {\n      //   const element = this.prizeData[i].PrizeId;\n      //   if (element == res.PrizeId) {\n      //     index = i;\n      //   }\n      // }\n\n      var index = this.index; // 成功后次数减少一次\n\n      this.num--;\n      this.prizeIndex = index; // 告诉子组件，开始转动了\n\n      this.$refs.roundTurntable.rotate(index); // }\n      // });\n    },\n    // 已经转动完转盘触发的函数\n    endRotation: function endRotation() {\n      var _this6 = this;\n\n      // 停止轉動音效\n      lotteryMusic.stop();\n      this.showgold = true;\n      this.typep = 1; // 中獎\n\n      lotteryWining.play();\n      apiGetUserInfo(\"\", true).then(function (res) {\n        _this6.gold = res.UDiamond;\n      }); // 提示中奖\n      // alert(\n      //   `恭喜您获奖啦,您的奖品是：${this.prizeData[this.prizeIndex].PrizeName}`\n      // );\n      // this.$message({\n      //   type: \"success\",\n      //   message: this.prizeData[this.prizeIndex].PrizeName,\n      //   center: true,\n      //   duration: 3000\n      // });\n      // 解锁\n\n      this.isLocking = false;\n      this.flag = true;\n    },\n    // 判断是否可以转动\n    canBeRotated: function canBeRotated() {\n      if (this.num <= 0) {\n        this.showgold = true;\n        this.typep = 2;\n        return false;\n      }\n\n      if (this.isLocking) {\n        return false;\n      }\n\n      return true;\n    },\n    //取得地址\n    getUserAddress: function getUserAddress() {\n      var _this7 = this;\n\n      apiGetUserAddress(\"\", true).then(function (res) {\n        var found = res.Data.find(function (element) {\n          return element.IsDefault == 1;\n        });\n        found != undefined ? _this7.editUserAddress = false : _this7.editUserAddress = true;\n      });\n    }\n  }\n};",{"version":3,"sources":["Lottery.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"luck\" :class=\"[lang == 'zh-CN' ? 'luck-CN' : lang == 'en-US' ? 'luck-US' : 'luck-TW']\">\r\n    <back class=\"back-icon\"></back>\r\n    <transition name=\"fade\">\r\n      <model v-if=\"showgold\"></model>\r\n    </transition>\r\n    <transition name=\"fade\">\r\n      <div class=\"luck-dialog\" v-if=\"showgold\">\r\n        <p class=\"luck-dialog-p\" v-if=\"typep == 1\">\r\n          {{ this.prizeData[this.prizeIndex].PrizeName }}\r\n        </p>\r\n        <p v-if=\"typep == 2\" class=\"pgold\">{{ $t('NoGoldTip') }}</p>  <!-- 【 金币不足,每天分享可获得金币 】 -->\r\n        <div class=\"luck-dialog-btn\" @click=\"close\">{{ $t('Confirm') }}</div>  <!-- 【 确认 】 -->\r\n      </div>\r\n    </transition>\r\n    <div class=\"lottery\">\r\n      <div class=\"lottery-top\"></div>\r\n      <div class=\"lottery-bottom\"></div>\r\n      <div class=\"lottery-left\"></div>\r\n      <div class=\"lottery-right\"></div>\r\n      <round-turntable\r\n        ref=\"roundTurntable\"\r\n        :prizeData=\"prizeData\"\r\n        :rotateCircle=\"rotateCircle\"\r\n        :duringTime=\"duringTime\"\r\n        :turntableStyleOption=\"turntableStyleOption\"\r\n        @endRotation=\"endRotation\"\r\n        class=\"turntable\"\r\n      >\r\n        <template slot=\"item\" slot-scope=\"scope\">\r\n          <div class=\"turntable-name\">{{ scope.item.PrizeName }}</div>\r\n          <div class=\"turntable-img\">\r\n            <img :src=\"scope.item.Image\" />\r\n          </div>\r\n        </template>\r\n      </round-turntable>\r\n      <div @click=\"getApiLuckDraw\" class=\"pointer\"></div>\r\n      <div class=\"lotterytai\">\r\n        <p>{{ $t('TotalCoins') }}:{{ gold }} {{ $t('Cost') }} {{ prize }}{{ $t('Coins') }} {{ $t('OneSpin') }}</p>  <!-- 【 金币数量 】 --><!-- 【 每花1金币可抽奖一次 】 -->\r\n      </div>\r\n    </div>\r\n    <!-- <div class=\"share\">\r\n      <div\r\n        @click=\"copy\"\r\n        :data-clipboard-text=\"codeUrl\"\r\n        class=\"tag-read1 copy\"\r\n      ></div>\r\n      <div class=\"pyj\" @click=\"pyj\"></div>\r\n      <div class=\"wexin\" @click=\"wexin\"></div>\r\n    </div> -->\r\n    <div class=\"luck-rule\">\r\n      <p class=\"title\">{{ $t('Tips') }}:</p>  <!-- 【 温馨提示 】 -->\r\n      <p>{{ Tips }}</p>\r\n      <router-link v-if=\"editUserAddress\" to=\"/address\">{{ $t('EditShippingAddress') }}</router-link>\r\n      <!-- <p>1.提示提示提示提示提示提示提示提示提示提示提示提示提示提示</p>\r\n      <p>2.提示提示提示提示提示提示提示提示提示提示提示提示提示提示</p>\r\n      <p>3.提示提示提示提示提示提示提示提示提示提示提示提示提示提示</p>\r\n      <p>4.提示提示提示提示提示提示提示提示提示提示提示提示提示提示</p>\r\n      <p>5.提示提示提示提示提示提示提示提示提示提示提示提示提示提示</p> -->\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { apiLuckDraw, apiGetPrizePoolSetting } from \"@/api/product.js\";\r\n\r\nimport { apiGetUserInfo, apiGetUserAddress } from \"@/api/User.js\";\r\nimport roundTurntable from \"../components/roundTurntable.vue\";\r\nimport model from \"../components/model\";\r\nimport { apiGetInvitationUrl } from \"@/api/InvitationCode.js\";\r\nimport Clipboard from \"clipboard\";\r\nimport back from \"../components/Botton/back.vue\";\r\n\r\nimport {lotteryMusic,lotteryWining} from \"@/utils/medias\";\r\n\r\nexport default {\r\n  components: {\r\n    roundTurntable,\r\n    model,\r\n    back,\r\n  },\r\n  created() {\r\n    this.lang = JSON.parse(localStorage.getItem(\"lang\")).tag;\r\n    this.getPrizePoolSetting();\r\n    apiGetUserInfo(\"\", true).then(res => {\r\n      this.gold = res.UDiamond;\r\n      this.num = Math.floor(res.UDiamond / 10);\r\n    });\r\n    this.geturl();\r\n    this.getUserAddress();\r\n    \r\n  },\r\n  data() {\r\n    return {\r\n      lang: \"\",\r\n      // 转盘上的奖品数据\r\n      prizeData: [],\r\n      // 转动的圈数\r\n      rotateCircle: 24,\r\n      // 转动需要持续的时间（s）\r\n      duringTime: 6.5,\r\n      // 转盘样式的选项\r\n      turntableStyleOption: {\r\n        // 背景色\r\n        prizeBgColors: [\r\n          \"#AE3EFF\",\r\n          \"#4D3FFF\",\r\n          \"#FC262C\",\r\n          \"#3A8BFF\",\r\n          \"#EE7602\",\r\n          \"#FE339F\"\r\n        ],\r\n        // 转盘的外边框颜色\r\n        borderColor: \"#199301\"\r\n      },\r\n\r\n      // 中奖的奖品的index\r\n      prizeIndex: -1,\r\n      // 用来锁定转盘，避免同时多次点击转动\r\n      isLocking: false,\r\n\r\n      // 剩余抽奖次数\r\n      num: 2,\r\n      gold: Number,\r\n      index: \"\",\r\n      showgold: false,\r\n      typep: \"\",\r\n      codeUrl: \"\",\r\n      Tips: [],\r\n      flag: true,\r\n      editUserAddress: false,\r\n      prize: 0,\r\n    };\r\n  },\r\n  methods: {\r\n    geturl() {\r\n      apiGetInvitationUrl(\"\", true).then(res => {\r\n        this.codeUrl = res.data;\r\n      });\r\n    },\r\n    copy() {\r\n      var clipboard = new Clipboard(\".tag-read1\");\r\n      clipboard.on(\"success\", e => {\r\n        // this.$toast.success({\r\n        //   message: \"邀请链接复制成功\",\r\n        //   duration: 3000\r\n        // });\r\n        const m = this.$message({\r\n          message: \"邀请链接复制成功\",\r\n          duration: 3000,\r\n          type: \"success\",\r\n          center: true\r\n        });\r\n        setTimeout(() => m.close(), 1200);\r\n        // success(\"复制成功\");//这里你如果引入了elementui的提示就可以用，没有就注释即可\r\n        // 释放内存\r\n        clipboard.destroy();\r\n      });\r\n      clipboard.on(\"error\", e => {\r\n        // 不支持复制\r\n        // 释放内存\r\n        clipboard.destroy();\r\n      });\r\n    },\r\n    wexin() {\r\n      const m = this.$message({\r\n        type: \"warning\",\r\n        message: this.$t('NotYetOpen'),\r\n        center: true,\r\n        duration: 1000\r\n      });\r\n      setTimeout(() => m.close(), 1200);\r\n    },\r\n    pyj() {\r\n      const m = this.$message({\r\n        type: \"warning\",\r\n        message: this.$t('NotYetOpen'),\r\n        center: true,\r\n        duration: 1000\r\n      });\r\n      setTimeout(() => m.close(), 1200);\r\n    },\r\n    close() {\r\n      this.showgold = false;\r\n    },\r\n    getPrizePoolSetting() {\r\n      apiGetPrizePoolSetting(\"\").then(res => {\r\n        this.prizeData = res.Prizes;\r\n        this.prize = res.Price;\r\n        this.Tips = res.Tips;\r\n      });\r\n    },\r\n    getApiLuckDraw() {\r\n      if (!this.flag) {\r\n        return;\r\n      }\r\n      this.flag = false;\r\n      apiLuckDraw(\"\", true).then(res => {\r\n        if (res.isSuccess) {\r\n          for (let i = 0; i < this.prizeData.length; i++) {\r\n            const element = this.prizeData[i].PrizeId;\r\n            if (element == res.PrizeId) {\r\n              this.index = i;\r\n            }\r\n          }\r\n          this.startRotation();\r\n        } else {\r\n          this.flag = true;\r\n          this.$message({\r\n            type: \"error\",\r\n            message: res.Message,\r\n            center: true,\r\n            duration: 1000,\r\n            typep: \"\"\r\n          });\r\n          if (res.Message === \"抱歉，请先设置默认收货地址！\") {\r\n            this.$router.push(\"/address\");\r\n          }\r\n        }\r\n      });\r\n    },\r\n    startRotation() {\r\n      // 如果还不可以转动\r\n      if (!this.canBeRotated()) {\r\n        return false;\r\n      }\r\n      //開始轉動音效\r\n      lotteryMusic.play();\r\n      // 开始转动\r\n      // 先上锁\r\n      this.isLocking = true;\r\n      // 设置在哪里停下，应该与后台交互，这里随机抽取0~5\r\n      // apiLuckDraw(\"\", true).then(res => {\r\n      // if (res.isSuccess) {\r\n      // let index;\r\n      // for (let i = 0; i < this.prizeData.length; i++) {\r\n      //   const element = this.prizeData[i].PrizeId;\r\n      //   if (element == res.PrizeId) {\r\n      //     index = i;\r\n      //   }\r\n      // }\r\n      let index = this.index;\r\n      // 成功后次数减少一次\r\n      this.num--;\r\n      this.prizeIndex = index;\r\n      // 告诉子组件，开始转动了\r\n      this.$refs.roundTurntable.rotate(index);\r\n      // }\r\n      // });\r\n    },\r\n    // 已经转动完转盘触发的函数\r\n    endRotation() {\r\n    // 停止轉動音效\r\n    lotteryMusic.stop();\r\n    this.showgold = true;\r\n    this.typep = 1;\r\n    // 中獎\r\n    lotteryWining.play();\r\n      apiGetUserInfo(\"\", true).then(res => {\r\n        this.gold = res.UDiamond;\r\n      });\r\n      // 提示中奖\r\n      // alert(\r\n      //   `恭喜您获奖啦,您的奖品是：${this.prizeData[this.prizeIndex].PrizeName}`\r\n      // );\r\n      // this.$message({\r\n      //   type: \"success\",\r\n      //   message: this.prizeData[this.prizeIndex].PrizeName,\r\n      //   center: true,\r\n      //   duration: 3000\r\n      // });\r\n      // 解锁\r\n      this.isLocking = false;\r\n      this.flag = true;\r\n    },\r\n    // 判断是否可以转动\r\n    canBeRotated() {\r\n      if (this.num <= 0) {\r\n        this.showgold = true;\r\n        this.typep = 2;\r\n        return false;\r\n      }\r\n      if (this.isLocking) {\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n    //取得地址\r\n    getUserAddress () {\r\n      apiGetUserAddress(\"\", true).then(res => {\r\n        const found = res.Data.find(element => element.IsDefault == 1);\r\n        found != undefined ? this.editUserAddress = false : this.editUserAddress = true;      \r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n\r\n.ceng {\r\n  background: url(\"~@/assets/turntable_a_03.png\");\r\n  background-size: 100%;\r\n  width: 7.1rem /* 710/100 */;\r\n  height: 7.11rem /* 711/100 */;\r\n  margin: 0 auto;\r\n  padding-top: 0.22rem;\r\n  /* 14/100 */\r\n}\r\n\r\n.fade-enter,\r\n.fade-leave-to {\r\n  opacity: 0;\r\n}\r\n\r\n.fade-leave,\r\n.fade-enter-to {\r\n  opacity: 1;\r\n}\r\n\r\n.fade-enter-active,\r\n.fade-leave-active {\r\n  transition: all 0.5s;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views"}]}